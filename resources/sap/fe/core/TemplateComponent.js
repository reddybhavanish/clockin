/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2020 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/UIComponent","sap/fe/core/CommonUtils"],function(U,C){"use strict";var T=U.extend("sap.fe.core.TemplateComponent",{metadata:{properties:{entitySet:{type:"string",defaultValue:null},bindingContextPattern:{type:"string"},navigation:{type:"object"},enhanceI18n:{type:"string[]"},controlConfiguration:{type:"object"},content:{type:"object"}},events:{"pageReady":{element:{type:"sap.ui.base.ManagedObject"}}},library:"sap.fe.core"},setContainer:function(c){U.prototype.setContainer.apply(this,arguments);if(c){var t=this;c.addEventDelegate({onBeforeShow:function(){t.bShown=false;t.bIsBackNav=false;t._bIsPageReady=false;},onBeforeHide:function(){t.bShown=false;t.bIsBackNav=false;t._bIsPageReady=false;},onAfterShow:function(e){t.bShown=true;t.bIsBackNav=e.isBack||e.isBackToPage;t._checkPageReady(true);}});}},setFocusInformation:function(f){this._mLastFocusedControl=f;},_checkPageReady:function(f){var t=this;if(this.bShown&&this.bDataReceived!==false&&this.bTablesLoaded!==false){if(this.bDataReceived===true&&!f&&!this._bWaitingForRefresh){this.bDataReceived=undefined;this._bWaitingForRefresh=true;var u=function(){sap.ui.getCore().detachEvent("UIUpdated",u);t._bWaitingForRefresh=false;t.firePageReady();};sap.ui.getCore().attachEvent("UIUpdated",u);}else{window.requestAnimationFrame(function(){t.firePageReady();});}}},init:function(){U.prototype.init.apply(this,arguments);this.oAppComponent=C.getAppComponent(this);var t=this;this.getService("templatedView").then(function(o){var v=o.getView();var b=[];var r=0;var R=0;var f=function(e){e.getSource().detachDataRequested(f);r++;t.bDataReceived=false;};var a=function(e){e.getSource().detachDataReceived(a);R++;if(R===r&&r!==0){r=0;R=0;t.bDataReceived=true;t._checkPageReady(false);}};v.getParent().attachModelContextChange(function(e){t._bIsPageReady=false;b.forEach(function(E){E.detachDataRequested(f);E.detachDataReceived(a);});b=[];e.getSource().findAggregatedObjects(true,function(E){var O=E.getObjectBinding();if(O){O.attachDataRequested(f);O.attachDataReceived(a);b.push(O);}else{var B=Object.keys(E.mBindingInfos);if(B.length>0){B.forEach(function(p){var l=E.mBindingInfos[p].binding;if(l&&l.isA("sap.ui.model.odata.v4.ODataListBinding")){l.attachDataRequested(f);l.attachDataReceived(a);b.push(l);}});}}if(E.isA("sap.ui.mdc.Table")){t.bTablesLoaded=false;E.done().then(function(){if(E&&E._oTable){var i=E._oTable.getBindingInfo("items");if(i){var l=i.binding;l.attachDataRequested(f);l.attachDataReceived(a);b.push(l);}}t.bTablesLoaded=true;setTimeout(function(){t._checkPageReady(false);},0);});}});setTimeout(function(){t._checkPageReady(false);},0);});});this.attachPageReady(function(){t._bIsPageReady=true;});},onBeforeBinding:function(c,p){return true;},onAfterBinding:function(c){return true;},isPageReady:function(){return this._bIsPageReady;},onPageReady:function(l){if(this.getRootControl()&&this.getRootControl().getController()&&this.getRootControl().getController().onPageReady){this.getRootControl().getController().onPageReady(l);}},getNavigationConfiguration:function(t){var n=this.getNavigation();return n[t];},getViewData:function(){var p=this.getMetadata().getAllProperties();return Object.keys(p).reduce(function(v,P){v[P]=p[P].get(this);return v;}.bind(this),{});},getPageTitleInformation:function(){if(this.getRootControl()&&this.getRootControl().getController()&&this.getRootControl().getController().getPageTitleInformation){return this.getRootControl().getController().getPageTitleInformation();}}});return T;},true);
