/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2020 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/m/MessageToast","sap/m/MessageItem","sap/m/MessageView","sap/m/Button","sap/m/Dialog","sap/ui/core/MessageType","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/message/Message","sap/ui/core/IconPool"],function(M,a,b,B,D,c,F,d,e,I){"use strict";var t=this;function f(){var p;function i(P){return P.property?"( ${"+P.property+'} ? ("<p>'+P.property.substr(Math.max(P.property.lastIndexOf("/"),P.property.lastIndexOf("."))+1)+' : " + '+"${"+P.property+'} + "<p/>") : "" )':"";}function n(P){var H="";if(P.groupName&&P.property&&P.groupName!==p){H+="( ${"+P.property+'} ? "<br/><h3>'+P.groupName+'</h3>" : "" ) + ';p=P.groupName;}return H;}function o(){var T="technicalDetails";return[{"groupName":"","property":T+"/status"},{"groupName":"","property":T+"/statusText"},{"groupName":"Application","property":T+"/error/@SAP__common.Application/ComponentId"},{"groupName":"Application","property":T+"/error/@SAP__common.Application/ServiceId"},{"groupName":"Application","property":T+"/error/@SAP__common.Application/ServiceRepository"},{"groupName":"Application","property":T+"/error/@SAP__common.Application/ServiceVersion"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.ErrorResolution/Analysis"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.ErrorResolution/Note"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.ErrorResolution/DetailedNote"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.ExceptionCategory"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.TimeStamp"},{"groupName":"ErrorResolution","property":T+"/error/@SAP__common.TransactionId"},{"groupName":"Messages","property":T+"/error/code"},{"groupName":"Messages","property":T+"/error/message"}];}var H="Object.keys("+"${technicalDetails}"+').length > 0 ? "<h2>Technical Details</h2>" : "" ';o().forEach(function(P){H=H+n(P)+""+i(P)+" + ";});return H;}function g(){var H="(${"+'description} ? ("<h2>Description</h2>" + ${'+'description}) : "")';return H;}function G(n){var o=c.None,L=n.length,p={Error:0,Warning:0,Success:0,Information:0};for(var i=0;i<L;i++){++p[n[i].getType()];}if(p[c.Error]>0){o=c.Error;}else if(p[c.Warning]>0){o=c.Warning;}else if(p[c.Success]>0){o=c.Success;}else if(p[c.Information]>0){o=c.Information;}return o;}function s(C){var u=k(),o=sap.ui.getCore().getMessageManager(),H,i;if(u.length===0&&!C){return Promise.resolve(true);}else if(u.length===1&&u[0].getType()===c.Success&&!C){return new Promise(function(n,p){M.show(u[0].message);o.removeMessages(u);n();});}else{return new Promise(function(n,p){t.resolve=n;sap.ui.getCore().getLibraryResourceBundle("sap.fe.core",true).then(function(R){t.oMessageTemplate=t.oMessageTemplate||new a({counter:"{counter}",title:"{message}",subtitle:"{additionalText}",longtextUrl:"{descriptionUrl}",type:"{type}",description:"{= ${"+"description} || ${technicalDetails} ? "+'"<html><body>" + '+g()+" + "+f()+'"</body></html>"'+' : "" }',markupDescription:true});t.oMessageView=t.oMessageView||new b({showDetailsPageHeader:false,itemSelect:function(){t.oBackButton.setVisible(true);},items:{path:"/",filters:[new F("target",d.EQ,""),new F("code",d.NE,undefined)],template:t.oMessageTemplate}});t.oBackButton=t.oBackButton||new B({icon:I.getIconURI("nav-back"),visible:false,press:function(){t.oMessageView.navigateBack();this.setVisible(false);}});if(C&&C.length){C.map(function(q){o.addMessages(new e({message:q.text,type:q.type,target:"",persistent:true}));});}t.oMessageView.setModel(o.getMessageModel());t.oDialog=t.oDialog||new D({resizable:true,content:t.oMessageView,beginButton:new B({press:function(){t.oDialog.close();t.oBackButton.setVisible(false);r();},text:R.getText("SAPFE_CLOSE")}),customHeader:new sap.m.Bar({contentMiddle:[new sap.m.Text({text:R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE")})],contentLeft:[t.oBackButton]}),contentWidth:"37.5em",contentHeight:"21.5em",verticalScrolling:false,afterClose:function(E){t.resolve();}});H=G(t.oMessageView.getItems());i=h(H);t.oDialog.setState(H);t.oDialog.getCustomHeader().getContentMiddle()[0].setText(i);t.oMessageView.navigateBack();t.oDialog.open();});});}}function h(H){var R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");switch(H){case"Error":return R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR");case"Information":return R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO");case"Success":return R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS");case"Warning":return R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE_WARNING");default:return R.getText("SAPFE_ERROR_MESSAGES_PAGE_TITLE");}}function r(){l(false);}function j(){l(true);}function k(n,T){var o=sap.ui.getCore().getMessageManager(),p=o.getMessageModel(),q=p.getObject("/"),u=[];for(var i=0;i<q.length;i++){if((!T||q[i].persistent)&&((n&&q[i].target!=="")||q[i].target==="")&&q[i].code){u.push(q[i]);}}return u;}function l(i){var n=k(i,true);if(n.length>0){sap.ui.getCore().getMessageManager().removeMessages(n);}}var m={showUnboundMessages:s,removeUnboundTransitionMessages:r,removeBoundTransitionMessages:j};return m;});
