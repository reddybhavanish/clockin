sap.ui.define(["sap/fe/core/helpers/StableIdHelper", "../ManifestSettings", "./CommonConverter"], function (StableIdHelper, ManifestSettings, CommonConverter) {
  "use strict";

  var _exports = {};
  var getPVisualizationP13nMode = CommonConverter.getPVisualizationP13nMode;
  var getOnlyAnnotation = CommonConverter.getOnlyAnnotation;
  var getTargetEntityType = CommonConverter.getTargetEntityType;
  var getNavigationProperties = CommonConverter.getNavigationProperties;
  var ActionType = ManifestSettings.ActionType;

  var _getDeleteStatus = function (tableContext) {
    var _entitySet$annotation, _entitySet$annotation2, _entitySet$annotation3, _targetProperties$ent, _targetProperties$ent2, _targetProperties$ent3;

    var entityType = tableContext.entityType,
        entitySet = tableContext.entitySet;

    var targetProperties = _getTargetProperties(tableContext),
        navigationOrCollectionName = targetProperties.name ? targetProperties.name : entityType.name,
        restrictedProperties = (_entitySet$annotation = entitySet.annotations) === null || _entitySet$annotation === void 0 ? void 0 : (_entitySet$annotation2 = _entitySet$annotation.Capabilities) === null || _entitySet$annotation2 === void 0 ? void 0 : (_entitySet$annotation3 = _entitySet$annotation2.NavigationRestrictions) === null || _entitySet$annotation3 === void 0 ? void 0 : _entitySet$annotation3.RestrictedProperties,
        isDeletable = ((_targetProperties$ent = targetProperties.entitySet.annotations) === null || _targetProperties$ent === void 0 ? void 0 : (_targetProperties$ent2 = _targetProperties$ent.Capabilities) === null || _targetProperties$ent2 === void 0 ? void 0 : (_targetProperties$ent3 = _targetProperties$ent2.DeleteRestrictions) === null || _targetProperties$ent3 === void 0 ? void 0 : _targetProperties$ent3.Deletable) !== false;

    if (restrictedProperties) {
      var match = restrictedProperties.find(function (property) {
        return property.NavigationProperty.value === navigationOrCollectionName && property.DeleteRestrictions;
      });

      if (match && match.DeleteRestrictions) {
        return match.DeleteRestrictions.Deletable;
      }
    }

    return "{= " + (isDeletable !== false) + " && ${ui>/editMode} === 'Editable'}";
  };

  var _getRowConfigurationProperty = function (tableContext) {
    var entityType = tableContext.entityType,
        manifestSettings = tableContext.manifestSettings;

    var targetProperties = _getTargetProperties(tableContext);

    var navProperty = targetProperties.name;
    var navigationOrCollectionName = navProperty ? navProperty : entityType.name;
    var pressProperty = undefined,
        navigationTarget;

    if (manifestSettings.navigation) {
      var navigationProperty = manifestSettings.navigation[navigationOrCollectionName];

      if (navigationProperty) {
        var _navigationProperty$d, _navigationProperty$d2, _navigationProperty$d3;

        navigationTarget = (_navigationProperty$d = navigationProperty.display) === null || _navigationProperty$d === void 0 ? void 0 : _navigationProperty$d.target;

        if (navigationTarget) {
          pressProperty = ".handlers.onChevronPressNavigateOutBound( $controller ,'" + navigationTarget + "', ${$parameters>bindingContext})";
        } else if (navigationTarget = (_navigationProperty$d2 = navigationProperty.detail) === null || _navigationProperty$d2 === void 0 ? void 0 : _navigationProperty$d2.outbound) {
          pressProperty = ".handlers.onChevronPressNavigateOutBound( $controller ,'" + navigationTarget + "', ${$parameters>bindingContext})";
        } else if (navigationTarget = (_navigationProperty$d3 = navigationProperty.detail) === null || _navigationProperty$d3 === void 0 ? void 0 : _navigationProperty$d3.route) {
          var targetEntity = entityType.name === navigationOrCollectionName ? entityType : getTargetEntityType(navigationOrCollectionName, entityType);

          if (targetEntity) {
            var _targetAnnotations$Co, _targetAnnotations$Co2;

            var targetAnnotations = targetProperties.entitySet.annotations;
            pressProperty = ".routing.navigateForwardToContext(${$parameters>bindingContext}, { targetPath: '" + navigationOrCollectionName + "', editable : " + ((targetAnnotations === null || targetAnnotations === void 0 ? void 0 : (_targetAnnotations$Co = targetAnnotations.Common) === null || _targetAnnotations$Co === void 0 ? void 0 : _targetAnnotations$Co.DraftRoot) || (targetAnnotations === null || targetAnnotations === void 0 ? void 0 : (_targetAnnotations$Co2 = targetAnnotations.Common) === null || _targetAnnotations$Co2 === void 0 ? void 0 : _targetAnnotations$Co2.DraftNode) ? "!${$parameters>bindingContext}.getProperty('IsActiveEntity')" : "undefined") + "})"; //Need to access to DraftRoot and DraftNode !!!!!!!
          }
        }
      }
    }

    return {
      press: pressProperty,
      action: pressProperty ? "Navigation" : undefined
    };
  };

  var _getSelectionMode = function (tableContext) {
    var _manifestSettings$con, _manifestSettings$con2, _manifestSettings$con3, _targetEntityType$ann, _targetProperties$ent4, _targetProperties$ent5, _targetProperties$ent6;

    var entityType = tableContext.entityType,
        manifestSettings = tableContext.manifestSettings,
        visualizationPath = tableContext.visualizationPath,
        selectionMode = ((_manifestSettings$con = manifestSettings.controlConfiguration) === null || _manifestSettings$con === void 0 ? void 0 : (_manifestSettings$con2 = _manifestSettings$con[visualizationPath]) === null || _manifestSettings$con2 === void 0 ? void 0 : (_manifestSettings$con3 = _manifestSettings$con2.tableSettings) === null || _manifestSettings$con3 === void 0 ? void 0 : _manifestSettings$con3.selectionMode) || "Multi",
        targetProperties = _getTargetProperties(tableContext),
        targetEntityType = targetProperties.name ? getTargetEntityType(targetProperties.name, entityType) : entityType,
        lineItemAnnotation = (_targetEntityType$ann = targetEntityType.annotations) === null || _targetEntityType$ann === void 0 ? void 0 : _targetEntityType$ann.getAnnotation("UI")[getOnlyAnnotation(visualizationPath)],
        isDeletable = !(((_targetProperties$ent4 = targetProperties.entitySet.annotations) === null || _targetProperties$ent4 === void 0 ? void 0 : (_targetProperties$ent5 = _targetProperties$ent4.Capabilities) === null || _targetProperties$ent5 === void 0 ? void 0 : (_targetProperties$ent6 = _targetProperties$ent5.DeleteRestrictions) === null || _targetProperties$ent6 === void 0 ? void 0 : _targetProperties$ent6.Deletable) === false);

    if (lineItemAnnotation) {
      var match = lineItemAnnotation.find(function (lineItem) {
        var _lineItem$Inline;

        return (lineItem.$Type === "com.sap.vocabularies.UI.v1.DataFieldForAction" || lineItem.$Type === "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" && lineItem.RequiresContext && (lineItem.RequiresContext === true || lineItem.RequiresContext.Bool === "true")) && !(lineItem.Inline && ((_lineItem$Inline = lineItem.Inline) === null || _lineItem$Inline === void 0 ? void 0 : _lineItem$Inline.Bool) !== "true");
      });

      if (match) {
        return selectionMode;
      } else if (isDeletable) {
        if (targetProperties.name) {
          return "{= ${ui>/editMode} === 'Editable' ? '" + selectionMode + "' : 'None'}";
        } else {
          return selectionMode;
        }
      }
    }

    return "None";
  };

  var _getTableManifestSettings = function (tableContext) {
    var _manifestSettings$con4;

    var manifestSettings = tableContext.manifestSettings,
        visualizationPath = tableContext.visualizationPath;
    return manifestSettings.controlConfiguration ? (_manifestSettings$con4 = manifestSettings.controlConfiguration[visualizationPath]) === null || _manifestSettings$con4 === void 0 ? void 0 : _manifestSettings$con4.tableSettings : undefined;
  };

  var _getTargetProperties = function (tableContext) {
    var entityType = tableContext.entityType,
        entitySet = tableContext.entitySet,
        visualizationPath = tableContext.visualizationPath;
    var navigationProperty = getNavigationProperties(visualizationPath, entityType);
    var name = navigationProperty.property;
    var targetEntitySet;

    if (!name) {
      targetEntitySet = entitySet;
    } else {
      targetEntitySet = name.split("/").reduce(function (currentEntitySet, namePart) {
        return currentEntitySet.navigationPropertyBinding[namePart];
      }, entitySet);
    }

    return {
      entitySet: targetEntitySet,
      name: name
    };
  };

  var _getTableActionsFromManifest = function (manifestActions) {
    var tableActions = {};

    for (var key in manifestActions) {
      var manifestAction = manifestActions[key];
      var lastDotIndex = manifestAction.press.lastIndexOf(".");
      var tableAction = {
        controlId: !manifestAction.id ? key : manifestAction.id,
        visible: manifestAction.visible === undefined ? "true" : manifestAction.visible,
        enabled: manifestAction.enabled === undefined ? "true" : manifestAction.enabled,
        handlerModule: manifestAction.press.substring(0, lastDotIndex).replace(/\./gi, "/"),
        handlerMethod: manifestAction.press.substring(lastDotIndex + 1),
        press: manifestAction.press,
        type: ActionType.Default,
        text: manifestAction.text
      };
      tableActions[key] = tableAction;
    }

    return tableActions;
  };
  /**
   * Get Table properties coming from annotations
   * @param {VisualizationConverterContext} [tableContext] Visualization Context
   * @returns {TableAnnotationConfiguration} table properties coming from Annotation calculation
   */


  function getTableAnnotationConfiguration(tableContext) {
    var entityType = tableContext.entityType,
        manifestSettings = tableContext.manifestSettings,
        visualizationPath = tableContext.visualizationPath,
        navigationInfo = getNavigationProperties(visualizationPath, entityType),
        entityName = entityType.name,
        isEntitySet = !navigationInfo.property,
        navProperty = navigationInfo.property,
        navigationOrCollectionName = navProperty ? navProperty : entityType.name,
        p13nMode = getPVisualizationP13nMode(tableContext),
        id = StableIdHelper.generate(["fe", "table", navigationOrCollectionName, visualizationPath.replace(navigationOrCollectionName + "/", "")]);
    return {
      id: id,
      collection: "/" + entityName + (!isEntitySet ? "/" + navProperty : ""),
      navigationPath: navProperty,
      navigationOrCollectionName: navigationOrCollectionName,
      row: _getRowConfigurationProperty(tableContext),
      isEntitySet: isEntitySet,
      editMode: isEntitySet ? "Display" : "{ui>/editMode}",
      createMode: isEntitySet ? "false" : "{localUI>/createMode}",
      busy: isEntitySet ? "{ui>/busy}" : "{ui>/busyLocal/" + id + "}",
      p13nMode: p13nMode,
      show: {
        delete: isEntitySet ? undefined : _getDeleteStatus(tableContext),
        create: isEntitySet ? undefined : "{= ${ui>/editMode} === 'Editable'}"
      },
      selectionMode: _getSelectionMode(tableContext),
      autoBindOnInit: !!!isEntitySet,
      enableControlVM: manifestSettings.variantManagement === "Control" ? p13nMode : undefined,
      filterId: isEntitySet ? StableIdHelper.generate(["fe", "FilterBar", entityName]) : undefined
    };
  }
  /**
   * Get Table properties coming from manifest
   * @param {VisualizationConverterContext} [tableContext] Visualization Context
   * @returns {TableAnnotationConfiguration} table properties coming from Manifest Settings
   */


  _exports.getTableAnnotationConfiguration = getTableAnnotationConfiguration;

  function getTableManifestConfiguration(tableContext) {
    var tableManifestSettings = _getTableManifestSettings(tableContext);

    if (tableManifestSettings) {
      var _tableManifestSetting, _tableManifestSetting2, _tableManifestSetting3;

      var quickSelectionVariant = JSON.stringify(tableManifestSettings.quickVariantSelection);
      return {
        quickFilter: quickSelectionVariant,
        type: tableManifestSettings.type,
        headerVisible: quickSelectionVariant && tableManifestSettings.quickVariantSelection.hideTableTitle === true ? false : true,
        enableExport: tableManifestSettings.enableExport,
        creationMode: (_tableManifestSetting = tableManifestSettings.creationMode) === null || _tableManifestSetting === void 0 ? void 0 : _tableManifestSetting.name,
        createAtEnd: (_tableManifestSetting2 = tableManifestSettings.creationMode) === null || _tableManifestSetting2 === void 0 ? void 0 : _tableManifestSetting2.createAtEnd,
        disableAddRowButtonForEmptyData: (_tableManifestSetting3 = tableManifestSettings.creationMode) === null || _tableManifestSetting3 === void 0 ? void 0 : _tableManifestSetting3.disableAddRowButtonForEmptyData
      };
    } else {
      return undefined;
    }
  }

  _exports.getTableManifestConfiguration = getTableManifestConfiguration;

  function getTableActionsConfiguration(visualizationPath, entityType, manifestSettings) {
    var _manifestSettings$con5;

    var manifestActions = manifestSettings.controlConfiguration ? (_manifestSettings$con5 = manifestSettings.controlConfiguration[visualizationPath]) === null || _manifestSettings$con5 === void 0 ? void 0 : _manifestSettings$con5.actions : undefined;
    return _getTableActionsFromManifest(manifestActions);
  }

  _exports.getTableActionsConfiguration = getTableActionsConfiguration;
  return _exports;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRhYmxlQ29udmVydGVyLnRzIl0sIm5hbWVzIjpbIl9nZXREZWxldGVTdGF0dXMiLCJ0YWJsZUNvbnRleHQiLCJlbnRpdHlUeXBlIiwiZW50aXR5U2V0IiwidGFyZ2V0UHJvcGVydGllcyIsIl9nZXRUYXJnZXRQcm9wZXJ0aWVzIiwibmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWUiLCJuYW1lIiwicmVzdHJpY3RlZFByb3BlcnRpZXMiLCJhbm5vdGF0aW9ucyIsIkNhcGFiaWxpdGllcyIsIk5hdmlnYXRpb25SZXN0cmljdGlvbnMiLCJSZXN0cmljdGVkUHJvcGVydGllcyIsImlzRGVsZXRhYmxlIiwiRGVsZXRlUmVzdHJpY3Rpb25zIiwiRGVsZXRhYmxlIiwibWF0Y2giLCJmaW5kIiwicHJvcGVydHkiLCJOYXZpZ2F0aW9uUHJvcGVydHkiLCJ2YWx1ZSIsIl9nZXRSb3dDb25maWd1cmF0aW9uUHJvcGVydHkiLCJtYW5pZmVzdFNldHRpbmdzIiwibmF2UHJvcGVydHkiLCJwcmVzc1Byb3BlcnR5IiwidW5kZWZpbmVkIiwibmF2aWdhdGlvblRhcmdldCIsIm5hdmlnYXRpb24iLCJuYXZpZ2F0aW9uUHJvcGVydHkiLCJkaXNwbGF5IiwidGFyZ2V0IiwiZGV0YWlsIiwib3V0Ym91bmQiLCJyb3V0ZSIsInRhcmdldEVudGl0eSIsImdldFRhcmdldEVudGl0eVR5cGUiLCJ0YXJnZXRBbm5vdGF0aW9ucyIsIkNvbW1vbiIsIkRyYWZ0Um9vdCIsIkRyYWZ0Tm9kZSIsInByZXNzIiwiYWN0aW9uIiwiX2dldFNlbGVjdGlvbk1vZGUiLCJ2aXN1YWxpemF0aW9uUGF0aCIsInNlbGVjdGlvbk1vZGUiLCJjb250cm9sQ29uZmlndXJhdGlvbiIsInRhYmxlU2V0dGluZ3MiLCJ0YXJnZXRFbnRpdHlUeXBlIiwibGluZUl0ZW1Bbm5vdGF0aW9uIiwiZ2V0QW5ub3RhdGlvbiIsImdldE9ubHlBbm5vdGF0aW9uIiwibGluZUl0ZW0iLCIkVHlwZSIsIlJlcXVpcmVzQ29udGV4dCIsIkJvb2wiLCJJbmxpbmUiLCJfZ2V0VGFibGVNYW5pZmVzdFNldHRpbmdzIiwiZ2V0TmF2aWdhdGlvblByb3BlcnRpZXMiLCJ0YXJnZXRFbnRpdHlTZXQiLCJzcGxpdCIsInJlZHVjZSIsImN1cnJlbnRFbnRpdHlTZXQiLCJuYW1lUGFydCIsIm5hdmlnYXRpb25Qcm9wZXJ0eUJpbmRpbmciLCJfZ2V0VGFibGVBY3Rpb25zRnJvbU1hbmlmZXN0IiwibWFuaWZlc3RBY3Rpb25zIiwidGFibGVBY3Rpb25zIiwia2V5IiwibWFuaWZlc3RBY3Rpb24iLCJsYXN0RG90SW5kZXgiLCJsYXN0SW5kZXhPZiIsInRhYmxlQWN0aW9uIiwiY29udHJvbElkIiwiaWQiLCJ2aXNpYmxlIiwiZW5hYmxlZCIsImhhbmRsZXJNb2R1bGUiLCJzdWJzdHJpbmciLCJyZXBsYWNlIiwiaGFuZGxlck1ldGhvZCIsInR5cGUiLCJBY3Rpb25UeXBlIiwiRGVmYXVsdCIsInRleHQiLCJnZXRUYWJsZUFubm90YXRpb25Db25maWd1cmF0aW9uIiwibmF2aWdhdGlvbkluZm8iLCJlbnRpdHlOYW1lIiwiaXNFbnRpdHlTZXQiLCJwMTNuTW9kZSIsImdldFBWaXN1YWxpemF0aW9uUDEzbk1vZGUiLCJTdGFibGVJZEhlbHBlciIsImdlbmVyYXRlIiwiY29sbGVjdGlvbiIsIm5hdmlnYXRpb25QYXRoIiwicm93IiwiZWRpdE1vZGUiLCJjcmVhdGVNb2RlIiwiYnVzeSIsInNob3ciLCJkZWxldGUiLCJjcmVhdGUiLCJhdXRvQmluZE9uSW5pdCIsImVuYWJsZUNvbnRyb2xWTSIsInZhcmlhbnRNYW5hZ2VtZW50IiwiZmlsdGVySWQiLCJnZXRUYWJsZU1hbmlmZXN0Q29uZmlndXJhdGlvbiIsInRhYmxlTWFuaWZlc3RTZXR0aW5ncyIsInF1aWNrU2VsZWN0aW9uVmFyaWFudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJxdWlja1ZhcmlhbnRTZWxlY3Rpb24iLCJxdWlja0ZpbHRlciIsImhlYWRlclZpc2libGUiLCJoaWRlVGFibGVUaXRsZSIsImVuYWJsZUV4cG9ydCIsImNyZWF0aW9uTW9kZSIsImNyZWF0ZUF0RW5kIiwiZGlzYWJsZUFkZFJvd0J1dHRvbkZvckVtcHR5RGF0YSIsImdldFRhYmxlQWN0aW9uc0NvbmZpZ3VyYXRpb24iLCJhY3Rpb25zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBMEJBLE1BQU1BLGdCQUFnQixHQUFHLFVBQVNDLFlBQVQsRUFBd0U7QUFBQTs7QUFBQSxRQUN4RkMsVUFEd0YsR0FDOURELFlBRDhELENBQ3hGQyxVQUR3RjtBQUFBLFFBQzVFQyxTQUQ0RSxHQUM5REYsWUFEOEQsQ0FDNUVFLFNBRDRFOztBQUVoRyxRQUFNQyxnQkFBZ0IsR0FBR0Msb0JBQW9CLENBQUNKLFlBQUQsQ0FBN0M7QUFBQSxRQUNDSywwQkFBMEIsR0FBR0YsZ0JBQWdCLENBQUNHLElBQWpCLEdBQXdCSCxnQkFBZ0IsQ0FBQ0csSUFBekMsR0FBZ0RMLFVBQVUsQ0FBQ0ssSUFEekY7QUFBQSxRQUVDQyxvQkFBb0IsNEJBQUdMLFNBQVMsQ0FBQ00sV0FBYixvRkFBRyxzQkFBdUJDLFlBQTFCLHFGQUFHLHVCQUFxQ0Msc0JBQXhDLDJEQUFHLHVCQUE2REMsb0JBRnJGO0FBQUEsUUFHQ0MsV0FBVyxHQUFHLDBCQUFBVCxnQkFBZ0IsQ0FBQ0QsU0FBakIsQ0FBMkJNLFdBQTNCLDBHQUF3Q0MsWUFBeEMsNEdBQXNESSxrQkFBdEQsa0ZBQTBFQyxTQUExRSxNQUF3RixLQUh2Rzs7QUFJQSxRQUFJUCxvQkFBSixFQUEwQjtBQUN6QixVQUFNUSxLQUFLLEdBQUdSLG9CQUFvQixDQUFDUyxJQUFyQixDQUNiLFVBQUFDLFFBQVE7QUFBQSxlQUNOQSxRQUFRLENBQUNDLGtCQUFWLENBQXdEQyxLQUF4RCxLQUFrRWQsMEJBQWxFLElBQWdHWSxRQUFRLENBQUNKLGtCQURsRztBQUFBLE9BREssQ0FBZDs7QUFJQSxVQUFJRSxLQUFLLElBQUlBLEtBQUssQ0FBQ0Ysa0JBQW5CLEVBQXVDO0FBQ3RDLGVBQU9FLEtBQUssQ0FBQ0Ysa0JBQU4sQ0FBeUJDLFNBQWhDO0FB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Y2VSb290IjoiLiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVudGl0eVR5cGUsIExpbmVJdGVtLCBFbnRpdHlTZXQsIE5hdmlnYXRpb25Qcm9wZXJ0eVBhdGggfSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXNcIjtcbmltcG9ydCB7IFN0YWJsZUlkSGVscGVyIH0gZnJvbSBcInNhcC9mZS9jb3JlL2hlbHBlcnNcIjtcbmltcG9ydCB7XG5cdEFjdGlvblR5cGUsXG5cdEJhc2VNYW5pZmVzdFNldHRpbmdzLFxuXHRNYW5pZmVzdEFjdGlvbixcblx0RGVmYXVsdEFjdGlvbixcblx0VGFibGVBbm5vdGF0aW9uQ29uZmlndXJhdGlvbixcblx0VGFibGVDb250cm9sQ29uZmlndXJhdGlvbixcblx0VGFibGVNYW5pZmVzdFNldHRpbmdzQ29uZmlndXJhdGlvbixcblx0VmlzdWFsaXphdGlvbkNvbnZlcnRlckNvbnRleHRcbn0gZnJvbSBcIi4uL01hbmlmZXN0U2V0dGluZ3NcIjtcblxuaW1wb3J0IHtcblx0Z2V0TmF2aWdhdGlvblByb3BlcnRpZXMsXG5cdGdldFRhcmdldEVudGl0eVR5cGUsXG5cdGdldE9ubHlBbm5vdGF0aW9uLFxuXHRnZXRQVmlzdWFsaXphdGlvblAxM25Nb2RlLFxuXHROYXZpZ2F0aW9uUHJvcGVydHlcbn0gZnJvbSBcIi4vQ29tbW9uQ29udmVydGVyXCI7XG5cbnR5cGUgVGFyZ2V0UHJvcGVydHkgPSB7XG5cdGVudGl0eVNldDogUmVxdWlyZWQ8RW50aXR5U2V0Pjtcblx0bmFtZTogc3RyaW5nO1xufTtcblxuY29uc3QgX2dldERlbGV0ZVN0YXR1cyA9IGZ1bmN0aW9uKHRhYmxlQ29udGV4dDogVmlzdWFsaXphdGlvbkNvbnZlcnRlckNvbnRleHQpOiBzdHJpbmcgfCBib29sZWFuIHtcblx0Y29uc3QgeyBlbnRpdHlUeXBlLCBlbnRpdHlTZXQgfSA9IHRhYmxlQ29udGV4dDtcblx0Y29uc3QgdGFyZ2V0UHJvcGVydGllcyA9IF9nZXRUYXJnZXRQcm9wZXJ0aWVzKHRhYmxlQ29udGV4dCksXG5cdFx0bmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWUgPSB0YXJnZXRQcm9wZXJ0aWVzLm5hbWUgPyB0YXJnZXRQcm9wZXJ0aWVzLm5hbWUgOiBlbnRpdHlUeXBlLm5hbWUsXG5cdFx0cmVzdHJpY3RlZFByb3BlcnRpZXMgPSBlbnRpdHlTZXQuYW5ub3RhdGlvbnM/LkNhcGFiaWxpdGllcz8uTmF2aWdhdGlvblJlc3RyaWN0aW9ucz8uUmVzdHJpY3RlZFByb3BlcnRpZXMsXG5cdFx0aXNEZWxldGFibGUgPSB0YXJnZXRQcm9wZXJ0aWVzLmVudGl0eVNldC5hbm5vdGF0aW9ucz8uQ2FwYWJpbGl0aWVzPy5EZWxldGVSZXN0cmljdGlvbnM/LkRlbGV0YWJsZSAhPT0gZmFsc2U7XG5cdGlmIChyZXN0cmljdGVkUHJvcGVydGllcykge1xuXHRcdGNvbnN0IG1hdGNoID0gcmVzdHJpY3RlZFByb3BlcnRpZXMuZmluZChcblx0XHRcdHByb3BlcnR5ID0+XG5cdFx0XHRcdChwcm9wZXJ0eS5OYXZpZ2F0aW9uUHJvcGVydHkgYXMgTmF2aWdhdGlvblByb3BlcnR5UGF0aCkudmFsdWUgPT09IG5hdmlnYXRpb25PckNvbGxlY3Rpb25OYW1lICYmIHByb3BlcnR5LkRlbGV0ZVJlc3RyaWN0aW9uc1xuXHRcdCk7XG5cdFx0aWYgKG1hdGNoICYmIG1hdGNoLkRlbGV0ZVJlc3RyaWN0aW9ucykge1xuXHRcdFx0cmV0dXJuIG1hdGNoLkRlbGV0ZVJlc3RyaWN0aW9ucy5EZWxldGFibGUgYXMgYm9vbGVhbjtcblx0XHR9XG5cdH1cblx0cmV0dXJuIFwiez0gXCIgKyAoaXNEZWxldGFibGUgIT09IGZhbHNlKSArIFwiICYmICR7dWk+L2VkaXRNb2RlfSA9PT0gJ0VkaXRhYmxlJ31cIjtcbn07XG5cbmNvbnN0IF9nZXRSb3dDb25maWd1cmF0aW9uUHJvcGVydHkgPSBmdW5jdGlvbih0YWJsZUNvbnRleHQ6IFZpc3VhbGl6YXRpb25Db252ZXJ0ZXJDb250ZXh0KSB7XG5cdGNvbnN0IHsgZW50aXR5VHlwZSwgbWFuaWZlc3RTZXR0aW5ncyB9ID0gdGFibGVDb250ZXh0O1xuXHRjb25zdCB0YXJnZXRQcm9wZXJ0aWVzID0gX2dldFRhcmdldFByb3BlcnRpZXModGFibGVDb250ZXh0KTtcblx0Y29uc3QgbmF2UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0aWVzLm5hbWU7XG5cdGNvbnN0IG5hdmlnYXRpb25PckNvbGxlY3Rpb25OYW1lID0gbmF2UHJvcGVydHkgPyBuYXZQcm9wZXJ0eSA6IGVudGl0eVR5cGUubmFtZTtcblx0dmFyIHByZXNzUHJvcGVydHkgPSB1bmRlZmluZWQsXG5cdFx0bmF2aWdhdGlvblRhcmdldDtcblx0aWYgKG1hbmlmZXN0U2V0dGluZ3MubmF2aWdhdGlvbikge1xuXHRcdGNvbnN0IG5hdmlnYXRpb25Qcm9wZXJ0eSA9IG1hbmlmZXN0U2V0dGluZ3MubmF2aWdhdGlvbltuYXZpZ2F0aW9uT3JDb2xsZWN0aW9uTmFtZV07XG5cdFx0aWYgKG5hdmlnYXRpb25Qcm9wZXJ0eSkge1xuXHRcdFx0bmF2aWdhdGlvblRhcmdldCA9IG5hdmlnYXRpb25Qcm9wZXJ0eS5kaXNwbGF5Py50YXJnZXQ7XG5cdFx0XHRpZiAobmF2aWdhdGlvblRhcmdldCkge1xuXHRcdFx0XHRwcmVzc1Byb3BlcnR5ID1cblx0XHRcdFx0XHRcIi5oYW5kbGVycy5vbkNoZXZyb25QcmVzc05hdmlnYXRlT3V0Qm91bmQoICRjb250cm9sbGVyICwnXCIgKyBuYXZpZ2F0aW9uVGFyZ2V0ICsgXCInLCAkeyRwYXJhbWV0ZXJzPmJpbmRpbmdDb250ZXh0fSlcIjtcblx0XHRcdH0gZWxzZSBpZiAoKG5hdmlnYXRpb25UYXJnZXQgPSBuYXZpZ2F0aW9uUHJvcGVydHkuZGV0YWlsPy5vdXRib3VuZCkpIHtcblx0XHRcdFx0cHJlc3NQcm9wZXJ0eSA9XG5cdFx0XHRcdFx0XCIuaGFuZGxlcnMub25DaGV2cm9uUHJlc3NOYXZpZ2F0ZU91dEJvdW5kKCAkY29udHJvbGxlciAsJ1wiICsgbmF2aWdhdGlvblRhcmdldCArIFwiJywgJHskcGFyYW1ldGVycz5iaW5kaW5nQ29udGV4dH0pXCI7XG5cdFx0XHR9IGVsc2UgaWYgKChuYXZpZ2F0aW9uVGFyZ2V0ID0gbmF2aWdhdGlvblByb3BlcnR5LmRldGFpbD8ucm91dGUpKSB7XG5cdFx0XHRcdGNvbnN0IHRhcmdldEVudGl0eTogUmVxdWlyZWQ8RW50aXR5VHlwZT4gPVxuXHRcdFx0XHRcdGVudGl0eVR5cGUubmFtZSA9PT0gbmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWVcblx0XHRcdFx0XHRcdD8gZW50aXR5VHlwZVxuXHRcdFx0XHRcdFx0OiBnZXRUYXJnZXRFbnRpdHlUeXBlKG5hdmlnYXRpb25PckNvbGxlY3Rpb25OYW1lLCBlbnRpdHlUeXBlKTtcblx0XHRcdFx0aWYgKHRhcmdldEVudGl0eSkge1xuXHRcdFx0XHRcdGNvbnN0IHRhcmdldEFubm90YXRpb25zID0gdGFyZ2V0UHJvcGVydGllcy5lbnRpdHlTZXQuYW5ub3RhdGlvbnM7XG5cdFx0XHRcdFx0cHJlc3NQcm9wZXJ0eSA9XG5cdFx0XHRcdFx0XHRcIi5yb3V0aW5nLm5hdmlnYXRlRm9yd2FyZFRvQ29udGV4dCgkeyRwYXJhbWV0ZXJzPmJpbmRpbmdDb250ZXh0fSwgeyB0YXJnZXRQYXRoOiAnXCIgK1xuXHRcdFx0XHRcdFx0bmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWUgK1xuXHRcdFx0XHRcdFx0XCInLCBlZGl0YWJsZSA6IFwiICtcblx0XHRcdFx0XHRcdCh0YXJnZXRBbm5vdGF0aW9ucz8uQ29tbW9uPy5EcmFmdFJvb3QgfHwgdGFyZ2V0QW5ub3RhdGlvbnM/LkNvbW1vbj8uRHJhZnROb2RlXG5cdFx0XHRcdFx0XHRcdD8gXCIhJHskcGFyYW1ldGVycz5iaW5kaW5nQ29udGV4dH0uZ2V0UHJvcGVydHkoJ0lzQWN0aXZlRW50aXR5JylcIlxuXHRcdFx0XHRcdFx0XHQ6IFwidW5kZWZpbmVkXCIpICtcblx0XHRcdFx0XHRcdFwifSlcIjsgLy9OZWVkIHRvIGFjY2VzcyB0byBEcmFmdFJvb3QgYW5kIERyYWZ0Tm9kZSAhISEhISEhXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHtcblx0XHRwcmVzczogcHJlc3NQcm9wZXJ0eSxcblx0XHRhY3Rpb246IHByZXNzUHJvcGVydHkgPyBcIk5hdmlnYXRpb25cIiA6IHVuZGVmaW5lZFxuXHR9O1xufTtcblxuY29uc3QgX2dldFNlbGVjdGlvbk1vZGUgPSBmdW5jdGlvbih0YWJsZUNvbnRleHQ6IFZpc3VhbGl6YXRpb25Db252ZXJ0ZXJDb250ZXh0KTogc3RyaW5nIHtcblx0Y29uc3QgeyBlbnRpdHlUeXBlLCBtYW5pZmVzdFNldHRpbmdzLCB2aXN1YWxpemF0aW9uUGF0aCB9ID0gdGFibGVDb250ZXh0LFxuXHRcdHNlbGVjdGlvbk1vZGUgPSBtYW5pZmVzdFNldHRpbmdzLmNvbnRyb2xDb25maWd1cmF0aW9uPy5bdmlzdWFsaXphdGlvblBhdGhdPy50YWJsZVNldHRpbmdzPy5zZWxlY3Rpb25Nb2RlIHx8IFwiTXVsdGlcIixcblx0XHR0YXJnZXRQcm9wZXJ0aWVzOiBUYXJnZXRQcm9wZXJ0eSA9IF9nZXRUYXJnZXRQcm9wZXJ0aWVzKHRhYmxlQ29udGV4dCksXG5cdFx0dGFyZ2V0RW50aXR5VHlwZTogUmVxdWlyZWQ8RW50aXR5VHlwZT4gPSB0YXJnZXRQcm9wZXJ0aWVzLm5hbWVcblx0XHRcdD8gZ2V0VGFyZ2V0RW50aXR5VHlwZSh0YXJnZXRQcm9wZXJ0aWVzLm5hbWUsIGVudGl0eVR5cGUpXG5cdFx0XHQ6IGVudGl0eVR5cGUsXG5cdFx0bGluZUl0ZW1Bbm5vdGF0aW9uID0gdGFyZ2V0RW50aXR5VHlwZS5hbm5vdGF0aW9ucz8uZ2V0QW5ub3RhdGlvbihcIlVJXCIpW2dldE9ubHlBbm5vdGF0aW9uKHZpc3VhbGl6YXRpb25QYXRoKV0sXG5cdFx0aXNEZWxldGFibGUgPSAhKHRhcmdldFByb3BlcnRpZXMuZW50aXR5U2V0LmFubm90YXRpb25zPy5DYXBhYmlsaXRpZXM/LkRlbGV0ZVJlc3RyaWN0aW9ucz8uRGVsZXRhYmxlID09PSBmYWxzZSk7XG5cdGlmIChsaW5lSXRlbUFubm90YXRpb24pIHtcblx0XHRjb25zdCBtYXRjaCA9IGxpbmVJdGVtQW5ub3RhdGlvbi5maW5kKFxuXHRcdFx0KGxpbmVJdGVtOiBhbnkpID0+XG5cdFx0XHRcdChsaW5lSXRlbS4kVHlwZSA9PT0gXCJjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGRGb3JBY3Rpb25cIiB8fFxuXHRcdFx0XHRcdChsaW5lSXRlbS4kVHlwZSA9PT0gXCJjb20uc2FwLnZvY2FidWxhcmllcy5VSS52MS5EYXRhRmllbGRGb3JJbnRlbnRCYXNlZE5hdmlnYXRpb25cIiAmJlxuXHRcdFx0XHRcdFx0bGluZUl0ZW0uUmVxdWlyZXNDb250ZXh0ICYmXG5cdFx0XHRcdFx0XHQobGluZUl0ZW0uUmVxdWlyZXNDb250ZXh0ID09PSB0cnVlIHx8IGxpbmVJdGVtLlJlcXVpcmVzQ29udGV4dC5Cb29sID09PSBcInRydWVcIikpKSAmJlxuXHRcdFx0XHQhKGxpbmVJdGVtLklubGluZSAmJiBsaW5lSXRlbS5JbmxpbmU/LkJvb2wgIT09IFwidHJ1ZVwiKVxuXHRcdCk7XG5cdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRyZXR1cm4gc2VsZWN0aW9uTW9kZTtcblx0XHR9IGVsc2UgaWYgKGlzRGVsZXRhYmxlKSB7XG5cdFx0XHRpZiAodGFyZ2V0UHJvcGVydGllcy5uYW1lKSB7XG5cdFx0XHRcdHJldHVybiBcIns9ICR7dWk+L2VkaXRNb2RlfSA9PT0gJ0VkaXRhYmxlJyA/ICdcIiArIHNlbGVjdGlvbk1vZGUgKyBcIicgOiAnTm9uZSd9XCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gc2VsZWN0aW9uTW9kZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIFwiTm9uZVwiO1xufTtcblxuY29uc3QgX2dldFRhYmxlTWFuaWZlc3RTZXR0aW5ncyA9IGZ1bmN0aW9uKHRhYmxlQ29udGV4dDogVmlzdWFsaXphdGlvbkNvbnZlcnRlckNvbnRleHQpOiBUYWJsZU1hbmlmZXN0U2V0dGluZ3NDb25maWd1cmF0aW9uIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgeyBtYW5pZmVzdFNldHRpbmdzLCB2aXN1YWxpemF0aW9uUGF0aCB9ID0gdGFibGVDb250ZXh0O1xuXHRyZXR1cm4gbWFuaWZlc3RTZXR0aW5ncy5jb250cm9sQ29uZmlndXJhdGlvbiA/IG1hbmlmZXN0U2V0dGluZ3MuY29udHJvbENvbmZpZ3VyYXRpb25bdmlzdWFsaXphdGlvblBhdGhdPy50YWJsZVNldHRpbmdzIDogdW5kZWZpbmVkO1xufTtcblxuY29uc3QgX2dldFRhcmdldFByb3BlcnRpZXMgPSBmdW5jdGlvbih0YWJsZUNvbnRleHQ6IFZpc3VhbGl6YXRpb25Db252ZXJ0ZXJDb250ZXh0KTogVGFyZ2V0UHJvcGVydHkge1xuXHRjb25zdCB7IGVudGl0eVR5cGUsIGVudGl0eVNldCwgdmlzdWFsaXphdGlvblBhdGggfSA9IHRhYmxlQ29udGV4dDtcblx0Y29uc3QgbmF2aWdhdGlvblByb3BlcnR5OiBOYXZpZ2F0aW9uUHJvcGVydHkgPSBnZXROYXZpZ2F0aW9uUHJvcGVydGllcyh2aXN1YWxpemF0aW9uUGF0aCwgZW50aXR5VHlwZSk7XG5cdGNvbnN0IG5hbWUgPSBuYXZpZ2F0aW9uUHJvcGVydHkucHJvcGVydHk7XG5cdHZhciB0YXJnZXRFbnRpdHlTZXQ7XG5cdGlmICghbmFtZSkge1xuXHRcdHRhcmdldEVudGl0eVNldCA9IGVudGl0eVNldDtcblx0fSBlbHNlIHtcblx0XHR0YXJnZXRFbnRpdHlTZXQgPSBuYW1lLnNwbGl0KFwiL1wiKS5yZWR1Y2UoKGN1cnJlbnRFbnRpdHlTZXQsIG5hbWVQYXJ0KSA9PiB7XG5cdFx0XHRyZXR1cm4gY3VycmVudEVudGl0eVNldC5uYXZpZ2F0aW9uUHJvcGVydHlCaW5kaW5nW25hbWVQYXJ0XSBhcyBSZXF1aXJlZDxFbnRpdHlTZXQ+O1xuXHRcdH0sIGVudGl0eVNldCk7XG5cdH1cblx0cmV0dXJuIHsgZW50aXR5U2V0OiB0YXJnZXRFbnRpdHlTZXQsIG5hbWUgfTtcbn07XG5cbmNvbnN0IF9nZXRUYWJsZUFjdGlvbnNGcm9tTWFuaWZlc3QgPSBmdW5jdGlvbihtYW5pZmVzdEFjdGlvbnM6IFJlY29yZDxzdHJpbmcsIE1hbmlmZXN0QWN0aW9uPiB8IHVuZGVmaW5lZCk6IFJlY29yZDxzdHJpbmcsIERlZmF1bHRBY3Rpb24+IHtcblx0bGV0IHRhYmxlQWN0aW9uczogUmVjb3JkPHN0cmluZywgRGVmYXVsdEFjdGlvbj4gPSB7fTtcblx0Zm9yIChsZXQga2V5IGluIG1hbmlmZXN0QWN0aW9ucykge1xuXHRcdGxldCBtYW5pZmVzdEFjdGlvbjogTWFuaWZlc3RBY3Rpb24gPSBtYW5pZmVzdEFjdGlvbnNba2V5XTtcblx0XHRsZXQgbGFzdERvdEluZGV4ID0gbWFuaWZlc3RBY3Rpb24ucHJlc3MubGFzdEluZGV4T2YoXCIuXCIpO1xuXHRcdGxldCB0YWJsZUFjdGlvbjogRGVmYXVsdEFjdGlvbiA9IHtcblx0XHRcdGNvbnRyb2xJZDogIW1hbmlmZXN0QWN0aW9uLmlkID8ga2V5IDogbWFuaWZlc3RBY3Rpb24uaWQsXG5cdFx0XHR2aXNpYmxlOiBtYW5pZmVzdEFjdGlvbi52aXNpYmxlID09PSB1bmRlZmluZWQgPyBcInRydWVcIiA6IG1hbmlmZXN0QWN0aW9uLnZpc2libGUsXG5cdFx0XHRlbmFibGVkOiBtYW5pZmVzdEFjdGlvbi5lbmFibGVkID09PSB1bmRlZmluZWQgPyBcInRydWVcIiA6IG1hbmlmZXN0QWN0aW9uLmVuYWJsZWQsXG5cdFx0XHRoYW5kbGVyTW9kdWxlOiBtYW5pZmVzdEFjdGlvbi5wcmVzcy5zdWJzdHJpbmcoMCwgbGFzdERvdEluZGV4KS5yZXBsYWNlKC9cXC4vZ2ksIFwiL1wiKSxcblx0XHRcdGhhbmRsZXJNZXRob2Q6IG1hbmlmZXN0QWN0aW9uLnByZXNzLnN1YnN0cmluZyhsYXN0RG90SW5kZXggKyAxKSxcblx0XHRcdHByZXNzOiBtYW5pZmVzdEFjdGlvbi5wcmVzcyxcblx0XHRcdHR5cGU6IEFjdGlvblR5cGUuRGVmYXVsdCxcblx0XHRcdHRleHQ6IG1hbmlmZXN0QWN0aW9uLnRleHRcblx0XHR9O1xuXG5cdFx0dGFibGVBY3Rpb25zW2tleV0gPSB0YWJsZUFjdGlvbjtcblx0fVxuXG5cdHJldHVybiB0YWJsZUFjdGlvbnM7XG59O1xuXG4vKipcbiAqIEdldCBUYWJsZSBwcm9wZXJ0aWVzIGNvbWluZyBmcm9tIGFubm90YXRpb25zXG4gKiBAcGFyYW0ge1Zpc3VhbGl6YXRpb25Db252ZXJ0ZXJDb250ZXh0fSBbdGFibGVDb250ZXh0XSBWaXN1YWxpemF0aW9uIENvbnRleHRcbiAqIEByZXR1cm5zIHtUYWJsZUFubm90YXRpb25Db25maWd1cmF0aW9ufSB0YWJsZSBwcm9wZXJ0aWVzIGNvbWluZyBmcm9tIEFubm90YXRpb24gY2FsY3VsYXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRhYmxlQW5ub3RhdGlvbkNvbmZpZ3VyYXRpb24odGFibGVDb250ZXh0OiBWaXN1YWxpemF0aW9uQ29udmVydGVyQ29udGV4dCk6IFRhYmxlQW5ub3RhdGlvbkNvbmZpZ3VyYXRpb24ge1xuXHRjb25zdCB7IGVudGl0eVR5cGUsIG1hbmlmZXN0U2V0dGluZ3MsIHZpc3VhbGl6YXRpb25QYXRoIH0gPSB0YWJsZUNvbnRleHQsXG5cdFx0bmF2aWdhdGlvbkluZm8gPSBnZXROYXZpZ2F0aW9uUHJvcGVydGllcyh2aXN1YWxpemF0aW9uUGF0aCwgZW50aXR5VHlwZSksXG5cdFx0ZW50aXR5TmFtZTogc3RyaW5nID0gZW50aXR5VHlwZS5uYW1lLFxuXHRcdGlzRW50aXR5U2V0OiBib29sZWFuID0gIW5hdmlnYXRpb25JbmZvLnByb3BlcnR5LFxuXHRcdG5hdlByb3BlcnR5OiBzdHJpbmcgPSBuYXZpZ2F0aW9uSW5mby5wcm9wZXJ0eSxcblx0XHRuYXZpZ2F0aW9uT3JDb2xsZWN0aW9uTmFtZSA9IG5hdlByb3BlcnR5ID8gbmF2UHJvcGVydHkgOiBlbnRpdHlUeXBlLm5hbWUsXG5cdFx0cDEzbk1vZGU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGdldFBWaXN1YWxpemF0aW9uUDEzbk1vZGUodGFibGVDb250ZXh0KSxcblx0XHRpZDogc3RyaW5nID0gU3RhYmxlSWRIZWxwZXIuZ2VuZXJhdGUoW1xuXHRcdFx0XCJmZVwiLFxuXHRcdFx0XCJ0YWJsZVwiLFxuXHRcdFx0bmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWUsXG5cdFx0XHR2aXN1YWxpemF0aW9uUGF0aC5yZXBsYWNlKG5hdmlnYXRpb25PckNvbGxlY3Rpb25OYW1lICsgXCIvXCIsIFwiXCIpXG5cdFx0XSk7XG5cblx0cmV0dXJuIHtcblx0XHRpZDogaWQsXG5cdFx0Y29sbGVjdGlvbjogXCIvXCIgKyBlbnRpdHlOYW1lICsgKCFpc0VudGl0eVNldCA/IFwiL1wiICsgbmF2UHJvcGVydHkgOiBcIlwiKSxcblx0XHRuYXZpZ2F0aW9uUGF0aDogbmF2UHJvcGVydHksXG5cdFx0bmF2aWdhdGlvbk9yQ29sbGVjdGlvbk5hbWU6IG5hdmlnYXRpb25PckNvbGxlY3Rpb25OYW1lLFxuXHRcdHJvdzogX2dldFJvd0NvbmZpZ3VyYXRpb25Qcm9wZXJ0eSh0YWJsZUNvbnRleHQpLFxuXHRcdGlzRW50aXR5U2V0OiBpc0VudGl0eVNldCxcblx0XHRlZGl0TW9kZTogaXNFbnRpdHlTZXQgPyBcIkRpc3BsYXlcIiA6IFwie3VpPi9lZGl0TW9kZX1cIixcblx0XHRjcmVhdGVNb2RlOiBpc0VudGl0eVNldCA/IFwiZmFsc2VcIiA6IFwie2xvY2FsVUk+L2NyZWF0ZU1vZGV9XCIsXG5cdFx0YnVzeTogaXNFbnRpdHlTZXQgPyBcInt1aT4vYnVzeX1cIiA6IFwie3VpPi9idXN5TG9jYWwvXCIgKyBpZCArIFwifVwiLFxuXHRcdHAxM25Nb2RlOiBwMTNuTW9kZSxcblx0XHRzaG93OiB7XG5cdFx0XHRkZWxldGU6IGlzRW50aXR5U2V0ID8gdW5kZWZpbmVkIDogX2dldERlbGV0ZVN0YXR1cyh0YWJsZUNvbnRleHQpLFxuXHRcdFx0Y3JlYXRlOiBpc0VudGl0eVNldCA/IHVuZGVmaW5lZCA6IFwiez0gJHt1aT4vZWRpdE1vZGV9ID09PSAnRWRpdGFibGUnfVwiXG5cdFx0fSxcblx0XHRzZWxlY3Rpb25Nb2RlOiBfZ2V0U2VsZWN0aW9uTW9kZSh0YWJsZUNvbnRleHQpLFxuXHRcdGF1dG9CaW5kT25Jbml0OiAhISFpc0VudGl0eVNldCxcblx0XHRlbmFibGVDb250cm9sVk06IG1hbmlmZXN0U2V0dGluZ3MudmFyaWFudE1hbmFnZW1lbnQgPT09IFwiQ29udHJvbFwiID8gcDEzbk1vZGUgOiB1bmRlZmluZWQsXG5cdFx0ZmlsdGVySWQ6IGlzRW50aXR5U2V0ID8gU3RhYmxlSWRIZWxwZXIuZ2VuZXJhdGUoW1wiZmVcIiwgXCJGaWx0ZXJCYXJcIiwgZW50aXR5TmFtZV0pIDogdW5kZWZpbmVkXG5cdH07XG59XG5cbi8qKlxuICogR2V0IFRhYmxlIHByb3BlcnRpZXMgY29taW5nIGZyb20gbWFuaWZlc3RcbiAqIEBwYXJhbSB7VmlzdWFsaXphdGlvbkNvbnZlcnRlckNvbnRleHR9IFt0YWJsZUNvbnRleHRdIFZpc3VhbGl6YXRpb24gQ29udGV4dFxuICogQHJldHVybnMge1RhYmxlQW5ub3RhdGlvbkNvbmZpZ3VyYXRpb259IHRhYmxlIHByb3BlcnRpZXMgY29taW5nIGZyb20gTWFuaWZlc3QgU2V0dGluZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRhYmxlTWFuaWZlc3RDb25maWd1cmF0aW9uKHRhYmxlQ29udGV4dDogVmlzdWFsaXphdGlvbkNvbnZlcnRlckNvbnRleHQpOiBUYWJsZUNvbnRyb2xDb25maWd1cmF0aW9uIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgdGFibGVNYW5pZmVzdFNldHRpbmdzID0gX2dldFRhYmxlTWFuaWZlc3RTZXR0aW5ncyh0YWJsZUNvbnRleHQpO1xuXHRpZiAodGFibGVNYW5pZmVzdFNldHRpbmdzKSB7XG5cdFx0Y29uc3QgcXVpY2tTZWxlY3Rpb25WYXJpYW50OiBzdHJpbmcgPSBKU09OLnN0cmluZ2lmeSh0YWJsZU1hbmlmZXN0U2V0dGluZ3MucXVpY2tWYXJpYW50U2VsZWN0aW9uKTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0cXVpY2tGaWx0ZXI6IHF1aWNrU2VsZWN0aW9uVmFyaWFudCxcblx0XHRcdHR5cGU6IHRhYmxlTWFuaWZlc3RTZXR0aW5ncy50eXBlLFxuXHRcdFx0aGVhZGVyVmlzaWJsZTogcXVpY2tTZWxlY3Rpb25WYXJpYW50ICYmIHRhYmxlTWFuaWZlc3RTZXR0aW5ncy5xdWlja1ZhcmlhbnRTZWxlY3Rpb24uaGlkZVRhYmxlVGl0bGUgPT09IHRydWUgPyBmYWxzZSA6IHRydWUsXG5cdFx0XHRlbmFibGVFeHBvcnQ6IHRhYmxlTWFuaWZlc3RTZXR0aW5ncy5lbmFibGVFeHBvcnQsXG5cdFx0XHRjcmVhdGlvbk1vZGU6IHRhYmxlTWFuaWZlc3RTZXR0aW5ncy5jcmVhdGlvbk1vZGU/Lm5hbWUsXG5cdFx0XHRjcmVhdGVBdEVuZDogdGFibGVNYW5pZmVzdFNldHRpbmdzLmNyZWF0aW9uTW9kZT8uY3JlYXRlQXRFbmQsXG5cdFx0XHRkaXNhYmxlQWRkUm93QnV0dG9uRm9yRW1wdHlEYXRhOiB0YWJsZU1hbmlmZXN0U2V0dGluZ3MuY3JlYXRpb25Nb2RlPy5kaXNhYmxlQWRkUm93QnV0dG9uRm9yRW1wdHlEYXRhXG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWJsZUFjdGlvbnNDb25maWd1cmF0aW9uKFxuXHR2aXN1YWxpemF0aW9uUGF0aDogc3RyaW5nLFxuXHRlbnRpdHlUeXBlOiBSZXF1aXJlZDxFbnRpdHlUeXBlPixcblx0bWFuaWZlc3RTZXR0aW5nczogQmFzZU1hbmlmZXN0U2V0dGluZ3Ncbik6IFJlY29yZDxzdHJpbmcsIERlZmF1bHRBY3Rpb24+IHtcblx0bGV0IG1hbmlmZXN0QWN0aW9ucyA9IG1hbmlmZXN0U2V0dGluZ3MuY29udHJvbENvbmZpZ3VyYXRpb25cblx0XHQ/IG1hbmlmZXN0U2V0dGluZ3MuY29udHJvbENvbmZpZ3VyYXRpb25bdmlzdWFsaXphdGlvblBhdGhdPy5hY3Rpb25zXG5cdFx0OiB1bmRlZmluZWQ7XG5cdHJldHVybiBfZ2V0VGFibGVBY3Rpb25zRnJvbU1hbmlmZXN0KG1hbmlmZXN0QWN0aW9ucyk7XG59XG4iXX0=