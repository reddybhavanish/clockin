sap.ui.define(["sap/fe/core/helpers/StableIdHelper","../ManifestSettings","./CommonConverter"],function(S,M,C){"use strict";var _={};var g=C.getPVisualizationP13nMode;var a=C.getOnlyAnnotation;var b=C.getTargetEntityType;var c=C.getNavigationProperties;var A=M.ActionType;var d=function(t){var n,o,p,q,r,s;var u=t.entityType,v=t.entitySet;var w=i(t),x=w.name?w.name:u.name,y=(n=v.annotations)===null||n===void 0?void 0:(o=n.Capabilities)===null||o===void 0?void 0:(p=o.NavigationRestrictions)===null||p===void 0?void 0:p.RestrictedProperties,z=((q=w.entitySet.annotations)===null||q===void 0?void 0:(r=q.Capabilities)===null||r===void 0?void 0:(s=r.DeleteRestrictions)===null||s===void 0?void 0:s.Deletable)!==false;if(y){var B=y.find(function(D){return D.NavigationProperty.value===x&&D.DeleteRestrictions;});if(B&&B.DeleteRestrictions){return B.DeleteRestrictions.Deletable;}}return"{= "+(z!==false)+" && ${ui>/editMode} === 'Editable'}";};var e=function(t){var n=t.entityType,o=t.manifestSettings;var p=i(t);var q=p.name;var r=q?q:n.name;var s=undefined,u;if(o.navigation){var v=o.navigation[r];if(v){var w,x,y;u=(w=v.display)===null||w===void 0?void 0:w.target;if(u){s=".handlers.onChevronPressNavigateOutBound( $controller ,'"+u+"', ${$parameters>bindingContext})";}else if(u=(x=v.detail)===null||x===void 0?void 0:x.outbound){s=".handlers.onChevronPressNavigateOutBound( $controller ,'"+u+"', ${$parameters>bindingContext})";}else if(u=(y=v.detail)===null||y===void 0?void 0:y.route){var z=n.name===r?n:b(r,n);if(z){var B,D;var E=p.entitySet.annotations;s=".routing.navigateForwardToContext(${$parameters>bindingContext}, { targetPath: '"+r+"', editable : "+((E===null||E===void 0?void 0:(B=E.Common)===null||B===void 0?void 0:B.DraftRoot)||(E===null||E===void 0?void 0:(D=E.Common)===null||D===void 0?void 0:D.DraftNode)?"!${$parameters>bindingContext}.getProperty('IsActiveEntity')":"undefined")+"})";}}}}return{press:s,action:s?"Navigation":undefined};};var f=function(t){var n,o,p,q,r,s,u;var v=t.entityType,w=t.manifestSettings,x=t.visualizationPath,y=((n=w.controlConfiguration)===null||n===void 0?void 0:(o=n[x])===null||o===void 0?void 0:(p=o.tableSettings)===null||p===void 0?void 0:p.selectionMode)||"Multi",z=i(t),B=z.name?b(z.name,v):v,D=(q=B.annotations)===null||q===void 0?void 0:q.getAnnotation("UI")[a(x)],E=!(((r=z.entitySet.annotations)===null||r===void 0?void 0:(s=r.Capabilities)===null||s===void 0?void 0:(u=s.DeleteRestrictions)===null||u===void 0?void 0:u.Deletable)===false);if(D){var F=D.find(function(G){var H;return(G.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||G.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&G.RequiresContext&&(G.RequiresContext===true||G.RequiresContext.Bool==="true"))&&!(G.Inline&&((H=G.Inline)===null||H===void 0?void 0:H.Bool)!=="true");});if(F){return y;}else if(E){if(z.name){return"{= ${ui>/editMode} === 'Editable' ? '"+y+"' : 'None'}";}else{return y;}}}return"None";};var h=function(t){var n;var o=t.manifestSettings,v=t.visualizationPath;return o.controlConfiguration?(n=o.controlConfiguration[v])===null||n===void 0?void 0:n.tableSettings:undefined;};var i=function(t){var n=t.entityType,o=t.entitySet,v=t.visualizationPath;var p=c(v,n);var q=p.property;var r;if(!q){r=o;}else{r=q.split("/").reduce(function(s,u){return s.navigationPropertyBinding[u];},o);}return{entitySet:r,name:q};};var j=function(n){var t={};for(var o in n){var p=n[o];var q=p.press.lastIndexOf(".");var r={controlId:!p.id?o:p.id,visible:p.visible===undefined?"true":p.visible,enabled:p.enabled===undefined?"true":p.enabled,handlerModule:p.press.substring(0,q).replace(/\./gi,"/"),handlerMethod:p.press.substring(q+1),press:p.press,type:A.Default,text:p.text};t[o]=r;}return t;};function k(t){var n=t.entityType,o=t.manifestSettings,v=t.visualizationPath,p=c(v,n),q=n.name,r=!p.property,s=p.property,u=s?s:n.name,w=g(t),x=S.generate(["fe","table",u,v.replace(u+"/","")]);return{id:x,collection:"/"+q+(!r?"/"+s:""),navigationPath:s,navigationOrCollectionName:u,row:e(t),isEntitySet:r,editMode:r?"Display":"{ui>/editMode}",createMode:r?"false":"{localUI>/createMode}",busy:r?"{ui>/busy}":"{ui>/busyLocal/"+x+"}",p13nMode:w,show:{delete:r?undefined:d(t),create:r?undefined:"{= ${ui>/editMode} === 'Editable'}"},selectionMode:f(t),autoBindOnInit:!!!r,enableControlVM:o.variantManagement==="Control"?w:undefined,filterId:r?S.generate(["fe","FilterBar",q]):undefined};}_.getTableAnnotationConfiguration=k;function l(t){var n=h(t);if(n){var o,p,q;var r=JSON.stringify(n.quickVariantSelection);return{quickFilter:r,type:n.type,headerVisible:r&&n.quickVariantSelection.hideTableTitle===true?false:true,enableExport:n.enableExport,creationMode:(o=n.creationMode)===null||o===void 0?void 0:o.name,createAtEnd:(p=n.creationMode)===null||p===void 0?void 0:p.createAtEnd,disableAddRowButtonForEmptyData:(q=n.creationMode)===null||q===void 0?void 0:q.disableAddRowButtonForEmptyData};}else{return undefined;}}_.getTableManifestConfiguration=l;function m(v,n,o){var p;var q=o.controlConfiguration?(p=o.controlConfiguration[v])===null||p===void 0?void 0:p.actions:undefined;return j(q);}_.getTableActionsConfiguration=m;return _;});
