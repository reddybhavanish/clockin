/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/fe/macros/ResourceModel","sap/ui/model/odata/v4/AnnotationHelper","sap/base/Log","sap/fe/core/CommonUtils","sap/fe/navigation/NavigationHelper","sap/fe/navigation/SelectionVariant"],function(R,O,L,C,N,S){"use strict";var H={isVisible:function(t,i){var m=i.context.getModel(),p=i.context.getPath(),a=m.getObject(p+"@"),h=a["@com.sap.vocabularies.UI.v1.Hidden"];return typeof h==="object"?"{= !${"+h.$Path+"} }":!h;},fireButtonPress:function(b){return C.fireButtonPress(b);},getParameterEditMode:function(t,i){var m=i.context.getModel(),p=i.context.getPath(),a=m.getObject(p+"@"),f=a["@com.sap.vocabularies.Common.v1.FieldControl"],b=a["@Org.OData.Core.V1.Immutable"],c=a["@Org.OData.Core.V1.Computed"];if(f&&f.$Path){if(f.$Path==="ReadOnly"){return sap.ui.mdc.EditMode.ReadOnly;}else{return("{= %{"+f.$Path+"} ? "+"'"+sap.ui.mdc.EditMode.ReadOnly+"'"+" : "+"'"+sap.ui.mdc.EditMode.Editable+"'"+" }");}}if(f&&f.$EnumMember){if(f.$EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"){return sap.ui.mdc.EditMode.ReadOnly;}}if(b||c){return sap.ui.mdc.EditMode.ReadOnly;}return sap.ui.mdc.EditMode.Editable;},getMetaPath:function(t,i){return(i&&i.context&&i.context.getPath())||undefined;},getTargetCollection:function(c,n){var p=c.getPath(),P,e,a;if(c.getMetadata().getName()==="sap.ui.model.Context"&&c.getObject("$kind")==="EntitySet"){return p;}if(c.getModel){p=(c.getModel().getMetaPath&&c.getModel().getMetaPath(p))||c.getModel().getMetaModel().getMetaPath(p);}P=p.split("/").filter(function(s){return s&&s!="$Type";});e="/"+P[0];if(P.length===1){return e;}a=n===undefined?P.slice(1).join("/$NavigationPropertyBinding/"):n;return e+"/$NavigationPropertyBinding/"+a;},isPropertyFilterable:function(p,i,d){var m=i.context.getModel(),P=i.context.getPath(),e=H._getEntitySetPath(m,P);if(d&&(d.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||d.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")){return false;}return C.isPropertyFilterable(m,e,p,P);},formatDraftLockText:function(I,a,b){if(!I){return R.getText("draft.DRAFT_OBJECT");}else if(a){if(b){return R.getText("draft.LOCKED_OBJECT");}else{return R.getText("draft.UNSAVED_CHANGES");}}else{return"";}},_getEntitySetPath:function(m,p){var l;var e=p.slice(0,p.indexOf("/",1));if(m.getObject(e+"/$kind")==="EntityContainer"){l=e.length+1;e=p.slice(l,p.indexOf("/",l));}return e;},_resolveValueHelpField:function(c){var v=c.getModel();var V=v.getObject("/");return V.$model.getMetaModel().createBindingContext("/"+V.CollectionPath+"/"+c.getObject());},getBoolAnnotationValue:function(a){var v=a||false;v=v===true||(v&&v["Bool"]!=="false");return v;},gotoTargetEntitySet:function(c){var p=H.getTargetCollection.call(H,c);return p+"/$";},gotoActionParameter:function(c){var p=c.getPath(),P=c.getObject(p+"/$Name");var s;if(p.indexOf("@$ui5.overload")>-1){s=p.split("@$ui5.overload")[0];}else{var a=p.split("/0/")[0].split(".");s="/"+a[a.length-1]+"/";}return s+P;},showNavigateErrorMessage:function(e){sap.m.MessageBox.show(R.getText("navigation.ERROR_MESSAGE"),{title:R.getText("navigation.ERROR_TITLE")});},getLabel:function(m,p){p=p||"";return(m.getProperty(p+"@@sap.ui.model.odata.v4.AnnotationHelper.label")||m.getProperty(p+"@com.sap.vocabularies.Common.v1.Label")||m.getProperty(p+"/@com.sap.vocabularies.Common.v1.Label")||m.getProperty(p+"@sapui.name"));},getIdentifyingName:function(m,i){return((i?this._getEntitySetPath(m.getModel(),m.getPath())+"/":"")+(m.getProperty("Value/$Path")||m.getProperty("Target/$AnnotationPath")||m.getProperty("@sapui.name")||(m.getProperty("SemanticObject")?"DataFieldForIntentBasedNavigation::"+m.getProperty("SemanticObject")+"::"+m.getProperty("Action"):"DataFieldForAction::"+m.getProperty("Action"))));},getEntitySetName:function(m,e){var E=m.getObject("/");for(var k in E){if(typeof E[k]==="object"&&E[k].$Type===e){return k;}}},getActionPath:function(a,r,A,c){A=!A?a.getObject(a.getPath()):A;var e=a.getPath().split("/@")[0];e=a.getObject(e).$Type;e=this.getEntitySetName(a.getModel(),e);if(c){return a.getObject("/"+e+"/"+A+"@Org.OData.Core.V1.OperationAvailable");}if(r){return"/"+e+"/"+A;}else{return{sEntityName:e,sProperty:a.getObject("/"+e+"/"+A+"@Org.OData.Core.V1.OperationAvailable/$Path"),sBindingParameter:a.getObject("/"+e+"/"+A+"/@$ui5.overload/0/$Parameter/0/$Name")};}},getEditMode:function(a,d,f,D,e,c,p,r,s,u){if(s){return false;}if(e==="Display"||e==="ReadOnly"||e==="Disabled"){return e;}var b,i,g,E,h,j,F,k,l,I,m;if(d==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||(a&&a["@com.sap.vocabularies.Common.v1.SemanticObject"]&&!(a["@com.sap.vocabularies.Common.v1.ValueListReferences"]||a["@com.sap.vocabularies.Common.v1.ValueListMapping"]||a["@com.sap.vocabularies.Common.v1.ValueList"]||a["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]))){return"Display";}if(a&&a["@Org.OData.Core.V1.Computed"]){b=a["@Org.OData.Core.V1.Computed"].Bool?a["@Org.OData.Core.V1.Computed"].Bool=="true":true;}if(a&&a["@Org.OData.Core.V1.Immutable"]){i=a["@Org.OData.Core.V1.Immutable"].Bool?a["@Org.OData.Core.V1.Immutable"].Bool=="true":true;}h=b||i;if(c&&c.indexOf("{")===0){c="$"+c;}l=typeof b==="undefined"?typeof i==="undefined"||i:!b;if(f){if(f.indexOf("{")===0){I="$"+f+" === '1'";m="$"+f+" === '0'";}else{h=h||f=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly";}}var n;var o;var q;var t;if(I){t=e==="Editable"?"'ReadOnly'":"$"+e+" === 'Editable' ? 'ReadOnly'  : 'Display'";if(l){o=e==="Editable"?c+" ? 'Editable' : 'ReadOnly'":"$"+e+" === 'Editable' ? "+c+"? 'Editable' : 'ReadOnly'  : 'Display'";q=e==="Editable"?"'Disabled'":"$"+e+" === 'Editable' ? 'Disabled' : 'Display'";}else{o=e==="Editable"?"'ReadOnly'":"$"+e+" === 'Editable' ? 'ReadOnly' : 'Display'";q=e==="Editable"?"'Disabled'":"$"+e+" === 'Editable' ? 'Disabled' : 'Display'";}}else{o="'Display'";q="'Display'";t="'Display'";}j=e&&e.indexOf("{")===0?"$"+e:"'"+e+"'";if(h){if(!l){if(e&&e.indexOf("{")===0){return r?false:"{= "+o+"}";}o=o.split("'")&&o.split("'")[1];return r?false:o;}else{if(I){if(c&&c.indexOf("$")===0){return("{= "+c+" ? ("+m+"? "+(r?false:"'Disabled'")+" : "+I+"? "+(r?false:"'ReadOnly'")+" : "+(r?"${ui>/editMode} === 'Editable'":j)+") : "+(r?false:o)+"}");}else if(c=="true"){return("{= "+m+"? "+(r?false:"'Disabled'")+" : "+I+"? "+(r?false:"'ReadOnly'")+" : "+(r?"${ui>/editMode} === 'Editable'":j)+"}");}else{return r?false:"{= "+o+"}";}}else if(f=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"){j="'ReadOnly'";}if(c&&c.indexOf("$")===0){return("{= "+c+" ?"+(r?"${ui>/editMode} === 'Editable'":j)+" : "+(r?false:o)+"}");}else if(c=="true"){return"{= "+(r?"${ui>/editMode} === 'Editable'":j)+"}";}else{return r?false:"{= "+o+"}";}}}if(I){if(u){j="$"+u+" === '1' ? 'EditableReadOnly' : "+j;}g=m+" ? "+(r?false:q)+" :"+I+" ? "+(r?false:t)+" :"+(r?"${ui>/editMode} === 'Editable'":j);n="{= "+g+"}";}else if(u){F="$"+u+" === '1'";k=e==="Editable"?"'EditableReadOnly'":"$"+e+" === 'Editable' ? 'EditableReadOnly' : 'Display'";g=F+" ? "+k+" :"+j;n="{= "+g+"}";}else{g=j;n=r?"{= ${ui>/editMode} === 'Editable'}":e;}var v;if(c&&c.indexOf("$")===0){v="{= "+c+" ? "+(r?false:o)+" : "+g+"}";}else if(c=="true"){v=r?false:"{= "+o+"}";}else{v="{= "+g+"}";}E=l?n:v;return E;},getNavigationContext:function(c){return O.getNavigationPath(c.getPath());},getHiddenPathExpression:function(d,D){var c=D.context,h,p=c.getPath(),e=O.getNavigationPath(p),s,P;if(c.getObject(p+"@com.sap.vocabularies.UI.v1.Hidden")){s=c.getObject(p+"@com.sap.vocabularies.UI.v1.Hidden");}else{if(p.lastIndexOf("/")===p.length-1){P="Value/$Path@com.sap.vocabularies.UI.v1.Hidden";}else{P="/Value/$Path@com.sap.vocabularies.UI.v1.Hidden";}s=c.getObject(p+P);}if(s){if(s.$Path){if(s.$Path.indexOf("/")>0){var n=s.$Path.split("/")[0];if(c.getObject(e+"/"+n)&&!c.getObject(e+"/"+n).$isCollection){h="%{"+s.$Path+"}";}else{return true;}}else{h="%{"+s.$Path+"}";}return"{= "+h+"=== true ? false : true }";}else{return"{= "+s+"=== true ? false : true }";}}return true;},getActionContext:function(a){return H.getActionPath(a,true);},getPathToBoundActionOverload:function(a){var p=H.getActionPath(a,true);return p+"/@$ui5.overload/0";}};H.isPropertyFilterable.requiresIContext=true;return H;},true);
