sap.ui.define(["sap/ui/test/OpaBuilder","sap/ui/test/Opa5","sap/ui/core/util/ShortcutHelper","sap/fe/test/Utils","sap/fe/test/builder/FEBuilder","sap/fe/test/builder/FieldBuilder","sap/fe/test/builder/TableBuilder","sap/fe/test/api/TableAssertions","sap/fe/test/api/TableActions","sap/fe/test/builder/FilterBarBuilder","sap/fe/test/api/FilterBarAssertions","sap/fe/test/api/FilterBarActions","sap/base/util/deepEqual","sap/ushell/resources"],function(O,a,S,U,F,b,T,c,d,e,f,g,h,r){"use strict";function _(s,G){return O.Matchers.aggregationMatcher("cells",function(C){var k=false;if(C.getItems){var l=C.getItems();if(l&&l.length===2){k=l[0].getProperty("text")===s;if(G!==undefined){if(!Array.isArray(G)){G=[G];}G=G.join(" > ");k=k&&l[1].getProperty("text")===G;}}}return k;});}function i(o,t){var k=T.create(o);if(U.isOfType(t,String)){k.hasProperties({header:t});}else{k.hasId(t.id);}return k;}function j(o,v){return e.create(o).hasId(v.id);}return{create:function(v,E){var R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.templates"),o=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");return{viewId:v,actions:{_onTable:function(t){return new d(i(this,t),t);},_onFilterBar:function(k){return new g(j(this,k),k);},iCloseMessageErrorDialog:function(){return O.create(this).isDialogElement().hasType("sap.m.Bar").hasAggregation("contentMiddle",O.Matchers.properties({text:"Error"})).do(O.create(this).isDialogElement().hasType("sap.m.Dialog").doOnAggregation("beginButton",O.Matchers.resourceBundle("text","sap.fe.core","SAPFE_CLOSE"),O.Actions.press())).description("Closing message error dialog").execute();},iOpenVHOnActionDialog:function(s){var k="APD_::"+s+"-inner-vhi";return O.create(this).hasId(k).isDialogElement().doPress().description("Opening value help for '"+s+"'").execute();},_iPressKeyboardShortcut:function(I,s,p,t){return O.create(this).hasId(I).hasProperties(p?p:{}).hasType(t).do(function(k){var n=S.parseShortcut(s);n.type="keydown";k.$().trigger(n);}).description("Execute keyboard shortcut "+s).execute();},iCancelActionDialog:function(){return O.create(this).hasType("sap.m.Button").isDialogElement().hasProperties({text:o.getText("SAPFE_ACTION_PARAMETER_DIALOG_CANCEL")}).doPress().description("Cancelling Action dialog").execute();},iConfirmCustomAction:function(t){return O.create(this).hasType("sap.m.Button").hasProperties({text:t}).doPress().description("Custom Action in Table ToolBar").execute();},iConfirmDialog:function(){return O.create(this).hasType("sap.m.Button").isDialogElement().hasProperties({text:o.getText("SAPFE_OK")}).doPress().description("Confirming Action dialog via Ok button").execute();},iConfirmDelete:function(){return O.create(this).hasType("sap.m.Button").isDialogElement().hasProperties({text:R.getText("OBJECT_PAGE_DELETE")}).doPress().description("Delete dialog confirmed").execute();},iConfirmActionVHDialog:function(s,A,k){return O.create(this).hasId(s+"."+A+"::"+k+"-ok").isDialogElement().doPress().description("Confirming value help dialog for action "+A).execute();},iCancelActionVHDialog:function(s,A,k){return O.create(this).hasId(s+"."+A+"::"+k+"-cancel").isDialogElement().doPress().description("Cancelling value help dialog for action "+A).execute();},iCollapseExpandPageHeader:function(C){var k=O.Matchers.resourceBundle("tooltip","sap.f","COLLAPSE_HEADER_BUTTON_TOOLTIP"),l=O.Matchers.resourceBundle("tooltip","sap.f","EXPAND_HEADER_BUTTON_TOOLTIP");return O.create(this).hasType("sap.m.Button").has(O.Matchers.some(k,l)).doConditional(C?k:l,O.Actions.press()).description("Resizing of the Page Header").execute();},_iOpenTableSortSettings:function(t){return T.create(this).hasId(t).doPress("sort").description("Opening sort settings for table "+t).execute();},_iAddColumnInTableSettings:function(s,G){return this._iModifyFilterInTableSettings(s,G,false,"Adding column");},_iSortTableByColumn:function(t,C){return this._iOpenTableSortSettings(t).and._iAddColumnInTableSettings(C);},_iModifyFilterInTableSettings:function(s,G,I,D){return O.create(this).hasType("sap.m.ColumnListItem").isDialogElement().hasProperties({selected:I}).has(_(s,G)).doOnChildren(O.create(this).hasType("sap.m.CheckBox").doPress()).description(D+" '"+s+"'").execute();}},assertions:{_onTable:function(t){return new c(i(this,t),t);},_onFilterBar:function(k){return new f(j(this,k),k);},iSeeThisPage:function(){return O.create(this).hasId(v).viewId(null).viewName(null).description(U.formatMessage("Seeing the page '{0}'",v)).execute();},iSeeFilterDefinedOnActionDialogValueHelp:function(A,V,s,k){return O.create(this).hasId(A+"::"+V+"::FilterBar::FilterField::"+s+"-inner").isDialogElement().hasAggregationProperties("tokens",{text:k}).description("Seeing filter for '"+s+"' set to '"+k+"'").execute();},_iSeeTheMessageToast:function(t){return F.createMessageToastBuilder(t).execute(this);},iSeeMessageErrorDialog:function(){return O.create(this).isDialogElement().hasType("sap.m.Bar").hasAggregation("contentMiddle",O.Matchers.properties({"text":"Error"})).description("Seeing message error dialog").execute();},_iSeeButtonWithText:function(t,B){return F.create(this).hasType("sap.m.Button").hasProperties({text:t}).hasState(B).checkNumberOfMatches(1).description(U.formatMessage("Seeing Button with text '{0}'"+(B?" with state: '{1}'":""),t,B)).execute();},_iSeeElement:function(I,k){return F.create(this).hasId(I).hasState(k).description(U.formatMessage("Seeing Element '{0}'"+(k?" with state: '{1}'":""),I,k)).execute();},iSeeActionParameterDialog:function(D){return O.create(this).hasType("sap.m.Dialog").hasProperties({title:D}).isDialogElement().description("Seeing Action Parameter Dialog with title '"+D+"'").execute();},iSeeActionCustomDialog:function(D){return O.create(this).hasType("sap.m.Text").hasProperties({text:D}).isDialogElement().description("Seeing Action Custom Dialog '"+D+"'").execute();},iSeeActionDefaultDialog:function(){return(O.create(this).hasType("sap.m.Text").has(O.Matchers.resourceBundle("text","sap.fe.core","SAPFE_ACTION_CONFIRM")).isDialogElement().description("Seeing Action Default Dialog ").execute());},iSeeActionParameterContent:function(s,C){var k="APD_::"+s+"-inner";return O.create(this).hasId(k).isDialogElement().hasProperties({value:C}).description("Seeing Action parameter '"+s+"' with content '"+C+"'").execute();},iSeeActionVHDialog:function(s,A,k){return O.create(this).hasId(s+"."+A+"::"+k+"-dialog").isDialogElement().description("Seeing Action Value Help dialog for field "+k).execute();},iSeeActionVHDialogFilterBar:function(s,A,k){return O.create(this).hasId(s+"."+A+"::"+k+"::FilterBar").isDialogElement().description("Seeing Action Value Help FilterBar for field "+k).execute();},iSeeActionVHDialogTable:function(s,A,k){return O.create(this).hasId(s+"."+A+"::"+k+"::Table").isDialogElement().description("Seeing Action Value Help Table for field "+k).execute();},iSeePageHeaderButton:function(C){return O.create(this).hasType("sap.m.Button").has(O.Matchers.resourceBundle("tooltip","sap.f",C?"COLLAPSE_HEADER_BUTTON_TOOLTIP":"EXPAND_HEADER_BUTTON_TOOLTIP")).description("Seeing the "+(C?"Collapse":"Expand")+" Page Header Button").execute();},iSeeTileCreationMessage:function(){return this._iSeeTheMessageToast(r.i18n.getText("tile_created_msg"));},_iSeeSortedColumn:function(t,C,p,D){var k={};k[p]=D?"Descending":"Ascending";return O.create(this).hasId(t+"::C::"+C+"-innerColumn").hasProperties(k).description(U.formatMessage("Seeing column '{0}' sorted by '{1}' {2}",C,p,k[p])).execute();}}};}};});
