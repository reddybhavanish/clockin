sap.ui.define(["./FEBuilder","sap/ui/test/OpaBuilder","sap/ui/mdc/library","sap/fe/test/Utils"],function(F,O,m,U){"use strict";var a=m.FieldDisplay;function _(e,v){e=(e&&[].concat(e))||[];v=(v&&[].concat(v))||[];return e.every(function(V,i){return i<v.length&&(V||"")==(v[i]||"");});}function b(D,e,E,A,v){switch(D){case a.Value:return _(e,A);case a.Description:return E===undefined?_(e,v):_(E,v);case a.ValueDescription:case a.DescriptionValue:return(_(e,A)&&(E===undefined||_(E,v)));default:throw new Error(U.formatMessage("unsupported field display '{0}'",D));}}function c(v){var r={};if(U.isOfType(v,Array)){r.value=v.length>0?v[0]:null;r.description=v.length>1?v[1]:undefined;}else if(U.isOfType(v,Object)){r.value=v.value;r.description=v.description;}else{r.value=v;r.description=undefined;}return r;}var d=function(){return F.apply(this,arguments);};d.create=function(o){return new d(o);};d.prototype=Object.create(F.prototype);d.prototype.constructor=d;d.prototype.hasValue=function(v){if(v===undefined){return this;}return this.has(d.Matchers.value(v));};d.prototype.hasConditionValues=function(v,o){if(v===undefined){return this;}return this.has(d.Matchers.conditionsValue(v,o));};d.prototype.doChangeValue=function(v){if(v===undefined){return this;}return this.doEnterText(v);};d.prototype.getStatesMatcher=function(s){return d.Matchers.states(s);};d.Matchers={value:function(e){var E=c(e);return function(f){if(!f.isA("sap.ui.mdc.Field")){throw new Error("Expected sap.ui.mdc.Field but got "+f.getMetadata().getName());}var v=f.getValue(),D=f.getAdditionalValue();return b(f.getDisplay(),E.value,E.description,v,D);};},conditionsValue:function(e,o){if(!U.isOfType(e,Array)){e=[e];}var E=e.map(function(v){return c(v);});return function(f){var C=f.getConditions().map(function(h){return{conditionOperator:h.operator,conditionValue:c(h.values)};}),g=function(v){return function(h){if(o&&h.conditionOperator!==o){return false;}return b(f.getDisplay(),v.value,v.description,h.conditionValue.value,h.conditionValue.description);};};return(C&&E.every(function(v){return C.some(g(v));}));};},state:function(n,v){switch(n){case"content":return function(f){var C=f.getContentDisplay(),o=f.getContentEdit(),e=f.getContent(),g=(f.getAggregation("_content")||[]).concat(e||[],C||[],o||[]),M=F.Matchers.states(v);return g.some(M);};case"contentEdit":case"contentDisplay":return function(f){return F.Matchers.states(v)(f.getAggregation(n));};default:return F.Matchers.state(n,v);}},states:function(s){if(!U.isOfType(s,Object)){return O.Matchers.TRUE;}return F.Matchers.match(Object.keys(s).map(function(p){return d.Matchers.state(p,s[p]);}));}};d.Actions={};return d;});
