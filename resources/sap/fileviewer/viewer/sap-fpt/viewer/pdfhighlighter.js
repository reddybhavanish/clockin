(function(){'use strict';var p=window.sap.es.pdf2text;var e=window.sap.es;var I=function(){this.init.apply(this,arguments);};I.prototype={init:function(d){this.div=d;this.sections=[];},highlight:function(f,t,c){this.sections.push([f,t,c]);},createTextNode:function(t){if(t.length===0){return;}this.div.appendChild(document.createTextNode(t));},createHighlightedTextNode:function(t,c){if(t.length===0){return;}var s=document.createElement('span');for(var i=0;i<c.length;++i){var a=c[i];s.classList.add(a);}var b=document.createTextNode(t);s.appendChild(b);this.div.appendChild(s);},render:function(){var t=this.div.innerText;this.div.innerHTML='';var l=0;for(var i=0;i<this.sections.length;++i){var s=this.sections[i];var f=s[0];var a=s[1];var c=s[2];this.createTextNode(t.slice(l,f));this.createHighlightedTextNode(t.slice(f,a+1),c);l=a+1;}if(l<t.length){this.createTextNode(t.slice(l,t.length));}}};e.PdfHighlighter=function(){this.init.apply(this,arguments);};e.PdfHighlighter.prototype={init:function(h,t,a,b){this.highlights=h;this.textDivs=t;this.textContent=a;this.pageNumber=b;this.entity2CssClassMapSingleton=window.sap.es.suv.Entity2CssClassMapSingleton.getInstance();},highlight:function(){var t=this;t.itemRenderer=null;if(this.highlights&&Array.isArray(this.highlights)){this.highlights.sort(function(a,b){return a.from<b.from?-1:1;});}else{return;}var c=[];for(var i=0;i<this.highlights.length;++i){var h=this.highlights[i];if(h.pdfFrom.page<t.pageNumber){continue;}if(h.pdfFrom.page>t.pageNumber){break;}if(!t.correctUndefinedItems(h)){continue;}c=[];for(var d in h.typeMap){c.push(d);var o=h.typeMap[d];for(var f in o){c.push(this.entity2CssClassMapSingleton.mapEntityToCssClass(f));}}t.doHighlight(h,c);}if(t.itemRenderer){t.itemRenderer.render();}},correctUndefinedItems:function(h){if(h.pdfFrom.item!==undefined&&h.pdfTo.item!==undefined){return true;}if(h.pdfFrom.item===undefined&&h.pdfTo.item===undefined){return false;}if(h.pdfTo.item===undefined){h.pdfTo.item=h.pdfTo.prevItem;h.pdfTo.offset=this.textContent.items[h.pdfTo.prevItem].str.length-1;return true;}if(h.pdfFrom.item===undefined){h.pdfFrom.item=h.pdfFrom.prevItem+1;h.pdfFrom.offset=0;return true;}return false;},getItemRenderer:function(d){if(!this.itemRenderer||this.itemRenderer.div!==d){if(this.itemRenderer){this.itemRenderer.render();}this.itemRenderer=new I(d);}return this.itemRenderer;},doHighlight:function(h,c){for(var i=h.pdfFrom.item;i<=h.pdfTo.item;++i){var d=this.textDivs[i];var a=this.textContent.items[i];var b=this.getItemRenderer(d);if(h.pdfTo.page===this.pageNumber){if(h.pdfFrom.item===i&&h.pdfTo.item===i){b.highlight(h.pdfFrom.offset,h.pdfTo.offset,c);}if(h.pdfFrom.item<i&&h.pdfTo.item>i){b.highlight(0,a.str.length-1,c);}if(h.pdfFrom.item<i&&h.pdfTo.item===i){b.highlight(0,h.pdfTo.offset,c);}if(h.pdfFrom.item===i&&h.pdfTo.item>i){b.highlight(h.pdfFrom.offset,a.str.length-1,c);}}else{if(h.pdfFrom.item<i){b.highlight(0,a.str.length-1,c);}if(h.pdfFrom.item===i){b.highlight(h.pdfFrom.offset,a.str.length-1,c);}}}}};})();
