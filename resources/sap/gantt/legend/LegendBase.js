/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Control","sap/base/util/ObjectPath","../misc/Utility","../misc/Format","../shape/cal/Calendar","../misc/AxisTime"],function(C,O,U,F,a,A){"use strict";var L=C.extend("sap.gantt.legend.LegendBase",{metadata:{"abstract":true,properties:{svgDefs:{type:"sap.gantt.def.SvgDefs",defaultValue:null},legendWidth:{type:"float",defaultValue:32},legendHeight:{type:"float",defaultValue:32},fontSize:{type:"int",defaultValue:16}}}});L.prototype.TIME_RANGE=["20160101000000","20160103000000"];L.prototype.TIME="20160102000000";L.prototype.init=function(){this._aTimeRange=[F.getTimeStampFormatter().parse(this.TIME_RANGE[0]),F.getTimeStampFormatter().parse(this.TIME_RANGE[1])];};L.prototype.getAxisTime=function(){return this._oAxisTime;};L.prototype.onBeforeRendering=function(){this._sUiSizeMode=U.findSapUiSizeClass();this._aViewRange=[0,this.getScaledLegendWidth()];this._oAxisTime=new A(this._aTimeRange,this._aViewRange);};L.prototype.getScaledLegendWidth=function(){var m=this.getSapUiSizeClass();return U.scaleBySapUiSize(m,this.getLegendWidth());};L.prototype.getScaledLegendHeight=function(){var m=this.getSapUiSizeClass();return U.scaleBySapUiSize(m,this.getLegendHeight());};L.prototype._instantShapeSync=function(s){var r=[];for(var i=0;i<s.length;i++){if(s[i].getShapeClassName()){var S=this._instantiateCustomerClassSync(s[i].getShapeClassName(),i,s[i]);if(s[i].getClippathAggregation()&&s[i].getClippathAggregation()instanceof Array){var p=this._instantShapeSync(s[i].getClippathAggregation());for(var j=0;j<p.length;j++){S.addPath(p[j]);}}else if(s[i].getGroupAggregation()&&s[i].getGroupAggregation()instanceof Array){var b=this._instantShapeSync(s[i].getGroupAggregation());for(var k=0;k<b.length;k++){S.addShape(b[k]);}}if(this._isProperShape(S)){r.push(S);}}}return r;};L.prototype._instantShapeAsync=function(s){var t=this,p=[];function c(I){return t._instantiateCustomerClassAsync(s[I].getShapeClassName(),I,s[I]).then(function(S){if(s[I].getClippathAggregation()&&s[I].getClippathAggregation()instanceof Array){return t._instantShapeAsync(s[I].getClippathAggregation()).then(function(P){for(var j=0;j<P.length;j++){S.addPath(P[j]);}return S;});}else if(s[I].getGroupAggregation()&&s[I].getGroupAggregation()instanceof Array){return t._instantShapeAsync(s[I].getGroupAggregation()).then(function(b){for(var k=0;k<b.length;k++){S.addShape(b[k]);}return S;});}else{return S;}});}for(var i=0;i<s.length;i++){if(s[i].getShapeClassName()){p.push(c(i));}}return Promise.all(p).then(function(S){var r=[];S.forEach(function(o){if(t._isProperShape(o)){r.push(o);}});return r;});};L.prototype._isProperShape=function(s){if(s instanceof a){jQuery.sap.log.warning("Calendar is not proper shape","key '"+s.mShapeConfig.getKey()+"'","ListLegend");return false;}else if(s.getTag()=="clippath"){return false;}else{return true;}};L.prototype._instantiateCustomerClassSync=function(c,s,S){var b=O.get(c);if(!b){throw new Error("Class "+c+" not preloaded. Please add it to require of your"+" controller to ensure that it's initialized before this point or use Gantt 2.0.");}var o=new b();o.mShapeConfig=S;o.mChartInstance=this;return o;};L.prototype._instantiateCustomerClassAsync=function(c,s,S){var t=this;return new Promise(function(r){sap.ui.require([c.replace(/\./g,"/")],function(b){var o=new b();o.mShapeConfig=S;o.mChartInstance=t;r(o);});});};L.prototype.getSapUiSizeClass=function(){return this._sUiSizeMode;};return L;},true);
