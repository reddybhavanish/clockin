/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Core","sap/gantt/misc/Utility","sap/ui/core/format/DateFormat","sap/ui/core/Locale"],function(q,C,U,D,L){"use strict";var c={};var G={SHAPE_ID_DATASET_KEY:"data-sap-gantt-shape-id",ROW_ID_DATASET_KEY:"data-sap-gantt-row-id",CONNECTABLE_DATASET_KEY:"data-sap-gantt-connectable",SELECT_FOR_DATASET_KEY:"sap-gantt-select-for",SHAPE_CONNECT_FOR_DATASET_KEY:"sap-gantt-shape-connect-for",SHAPE_CONNECT_INDICATOR_WIDTH:10,shapeElementById:function(s,g){var o=q.sap.domById(g),S=o.querySelector("g.sapGanttChartShapes");var n=S.querySelectorAll("["+G.SHAPE_ID_DATASET_KEY+"='"+s+"']");var e=n[0];if(e){return q(e).control(0);}return null;},getValueX:function(s){var n;var p=s.getMetadata().getProperty("x");if(p){n=s.getProperty(p.name);if(n!==null&&n!==undefined){return n;}}var r=C.getConfiguration().getRTL(),t=r?(s.getEndTime()||s.getTime()):s.getTime();if(t){n=s.getXByTime(t);}if(!q.isNumeric(n)){q.sap.log.warning("couldn't convert timestamp to x with value: "+t);}return n;},getRowInstance:function(e,t){var r=q(e.target).closest("rect.sapGanttBackgroundSVGRow").data("sapUiIndex");if(r!=null){return t.getRows()[r];}},_get2dContext:function(f,F){if(!c.context){c.context=document.createElement('canvas').getContext("2d");}if(c.fontSize!==f||c.fontFamily!==F){c.context.font=f+"px "+F;c.fontSize=f;c.fontFamily=F;}return c.context;},getShapeTextWidth:function(t,f,F){return this._get2dContext(f,F).measureText(t).width;},getSelectedTableRowSettings:function(t,s){var a=t.getRows(),f=t.getFirstVisibleRow();if(a.length===0){return null;}var F=a[0].getIndex();var i=s-f;if(F!==f){i+=Math.abs(F-f);}return a[i].getAggregation("_settings");},updateGanttRows:function(d,r,i){var g=d.getParent().getParent();var $=q.sap.byId(g.getId()+"-svg"),a=$.find("rect.sapGanttBackgroundSVGRow");a.eq(i).toggleClass("sapGanttBackgroundSVGRowSelected",!!r[i].selected);a.eq(i).toggleClass("sapGanttBackgroundSVGRowHovered",!!r[i].hovered);},getShapesWithUid:function(s,S){var e=function(a){var p=U.parseUid(a),b=p.shapeId;var d=["[id='",s,"']"," ["+G.SHAPE_ID_DATASET_KEY+"='",b,"']"].join("");return q(d).control().filter(function(E){return E.getShapeUid()===a;})[0];};return S.map(e);},getTimeFormaterBySmallInterval:function(g){var a=g.getAxisTimeStrategy(),s=a.getTimeLineOption().smallInterval,u=s.unit;var o=a.getCalendarType(),b=a.getLocale()?a.getLocale():new L(C.getConfiguration().getLanguage().toLowerCase());var f="yyyyMMMddhhms";if(!(u===sap.gantt.config.TimeUnit.minute||u===sap.gantt.config.TimeUnit.hour)){f="yyyyMMMdd";}return D.getDateTimeInstance({format:f,style:s.style,calendarType:o},s.locale?new L(s.locale):b);}};return G;},true);
