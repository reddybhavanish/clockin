/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/dnd/DragInfo','sap/ui/core/dnd/DropInfo',"sap/ui/events/KeyCodes",'sap/ui/core/dnd/DropPosition'],function(D,a,K,b){"use strict";var I="Before",c="insertBefore",d="insertAfter",i,e="IconTabReorder";var f={_insertControl:function(i,$,g){if(i===d){$.insertAfter(g);}else{$.insertBefore(g);}},handleDrop:function(g,s,o,h,j){var B=g.indexOfItem(o),k=g.indexOfItem(h),$=o.$(),l=h.$(),A=0,r=sap.ui.getCore().getConfiguration().getRTL(),m=s===I;if(o._isParentOf(h)){return;}if(r&&!j){if(m){A=B<k?k:k+1;i=d;}else{A=B<k?k-1:k;i=c;}}else{if(m){A=B<k?k-1:k;i=c;}else{A=B<k?k:k+1;i=d;}}if(g.isA("sap.m.IconTabFilter")||!o.getParent().isA("sap.m.IconTabHeader")){if(m){A=k;}else{A=k+1;}}f._insertControl(i,$,l);if(s===b.On){if(h===o){return;}A=g.getAggregation("items").length;}f._handleConfigurationAfterDragAndDrop.call(g,o,A);},_updateAccessibilityInfo:function(){var o=this.getItems(),A=1,g;o.forEach(function(h){g=h.getDomRef();if(g&&g.getAttribute("aria-posinset")!==null){g.setAttribute("aria-posinset",A++);}});},_handleConfigurationAfterDragAndDrop:function(o,g){this.removeAggregation('items',o,true);this.insertAggregation('items',o,g,true);f._updateAccessibilityInfo.call(this);},_decreaseDropIndex:function(B,g){var p=B-1;while(p>=0&&(!g[p].getVisible()||g[p].$().hasClass("sapMITBFilterHidden"))){p--;}if(p<0){i=d;return B;}i=c;return p;},_increaseDropIndex:function(B,g,m){var n=B+1;while(n<g.length&&!g[n].getVisible()){n++;}if(n>m){i=c;return B;}i=d;return n;},moveItem:function(o,k,m){var $=o.$(),g=this.getItems(),B=this.indexOfItem(o),r=sap.ui.getCore().getConfiguration().getRTL(),n,h;switch(k){case K.HOME:n=0;i=c;break;case K.END:n=g.length-1;i=d;break;case K.ARROW_LEFT:if(r){n=f._increaseDropIndex(B,g,m);}else{n=f._decreaseDropIndex(B,g);}break;case K.ARROW_RIGHT:if(r){n=f._decreaseDropIndex(B,g);}else{n=f._increaseDropIndex(B,g,m);}break;case K.ARROW_DOWN:n=f._increaseDropIndex(B,g,m);break;case K.ARROW_UP:n=f._decreaseDropIndex(B,g);break;default:return false;}h=g[n].$();f._insertControl(i,$,h);f._handleConfigurationAfterDragAndDrop.call(this,o,n);return true;},getDraggedDroppedItemsFromList:function(g,o,h){var j,k,s,l=o.getId(),m=h.getId();if(!g&&!o&&!h){return null;}g.forEach(function(n){s=n.getId();if(!s){return;}if(s===m){j=n;}if(s===l){k=n;}});return{oDraggedControlFromList:k,oDroppedControlFromList:j};},setDragDropAggregations:function(g,s,o){var h=g._oIconTabHeader?g._oIconTabHeader:g;var j=h.getId();g.addDragDropConfig(new D({sourceAggregation:"items",groupName:e+j}));g.addDragDropConfig(new a({targetAggregation:"items",dropPosition:o,dropLayout:s,drop:g._handleDragAndDrop.bind(g),groupName:e+j}));}};return f;});
