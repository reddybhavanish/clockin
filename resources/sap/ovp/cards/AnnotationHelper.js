sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/Log","sap/base/util/isPlainObject","sap/base/util/each","sap/ovp/cards/MetadataAnalyser","sap/base/security/encodeURL"],function(q,N,D,C,O,F,a,o,S,b,f,L,c,e,M,d){"use strict";var g={count:0};var h={};var l={};var m={};var n={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function p(i,j){var k=i.getSetting('ovpCardProperties');var k3=k.getProperty('/showLabelText');if(k3==="true"){var l3=j.Address[0];if(typeof l3.country!=="undefined"){return"{path:'"+l3.country.Path+"'}";}else if(typeof l3.locality!=="undefined"){return"{path:'"+l3.locality.Path+"'}";}else if(typeof l3.street!=="undefined"){return"{path:'"+l3.street.Path+"'}";}else if(typeof l3.code!=="undefined"){return"{path:'"+l3.code.Path+"'}";}}else{return null;}}p.requiresIContext=true;function r(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var k3=k&&k.getProperty("/metaModel");var l3=k&&k.getProperty("/entityType");if(!k3||!l3){return"";}var m3;if(j.Value){m3=j.Value.Path;}if(j.Target){var n3=K(l3.$path,j);var o3=n3&&k3.getProperty(n3);m3=o3&&o3.Value.Path;}if(!m3||!m3.length>0||m3===" "){return"";}var p3=k3.getODataProperty(l3,m3);if(!p3){return"";}var q3=p3["sap:label"]||(p3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return q3;}r.requiresIContext=true;function s(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function t(i,k,j){if(i.getSetting){var k3=i.getSetting("_ovpCache");if(k3){k3[k]=j;}}}function u(i,j){if(!g[j]){g[j]=0;}g[j]++;var k=j+g[j];g[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function v(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var k3=i.EnumMember;if(x(k3,'Negative')){k=j.Negative;}else if(x(k3,'Critical')){k=j.Critical;}else if(x(k3,'Positive')){k=j.Positive;}}}return k;}function w(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function x(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function y(i,j,k,k3,l3,m3,n3){var o3={};o3.EnumMember="None";var p3=Number.NEGATIVE_INFINITY;var q3=Number.POSITIVE_INFINITY;if((!l3&&l3!==0)&&(k||k===0)){l3=k;}if((!m3&&m3!==0)&&(k3||k3===0)){m3=k3;}if(!k&&k!==0){k=p3;}if(!k3&&k3!==0){k3=q3;}if(i!==undefined){i=Number(i);if(x(j,"Minimize")||x(j,"Minimizing")){if((m3||m3===0)&&(k3||k3===0)){if(i<=parseFloat(m3)){o3.EnumMember="Positive";}else if(i>parseFloat(k3)){o3.EnumMember="Negative";}else{o3.EnumMember="Critical";}}}else if(x(j,"Maximize")||x(j,"Maximizing")){if((l3||l3===0)&&(k||k===0)){if(i>=parseFloat(l3)){o3.EnumMember="Positive";}else if(i<parseFloat(k)){o3.EnumMember="Negative";}else{o3.EnumMember="Critical";}}}else if(x(j,"Target")){if((m3||m3===0)&&(k3||k3===0)&&(l3||l3===0)&&(k||k===0)){if(i>=parseFloat(l3)&&i<=parseFloat(m3)){o3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(k3)){o3.EnumMember="Negative";}else{o3.EnumMember="Critical";}}}}return v(o3,n3);}function z(i,j,k,k3){if(!i||!j){return;}i=Number(i);if(!k3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&k3&&(i-j>=k3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function B(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var k3=s(i,k);if(!k3){var l3=E(i,j);var m3=l3.map(function(n3){return n3.Value.Path;});m3=m3.filter(function(n3){return!!n3;});k3=j.filter(function(n3){if(n3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&m3.indexOf(n3.Value.Path)===-1){return true;}return false;});k3=Q(k3);t(i,k,k3);}return k3;}B.requiresIContext=true;function E(j,k,k3){var l3=j.getPath(0)+"-DataPoints-Sorted";var m3=s(j,l3);if(!m3){if(k3){m3=k.filter(H);}else{m3=k.filter(G);}m3=Q(m3);var n3;for(var i=0;i<m3.length;i++){n3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);m3[i]=j.getModel(0).getProperty(K(n3,m3[i]));n3="";}t(j,l3,m3);}return m3;}E.requiresIContext=true;function G(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function H(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function J(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function K(i,j){if(i&&!x(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function P(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function Q(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var k3=i.slice(j,i.length);return R(Q(k),Q(k3));}function R(i,j){var k=[];while(i.length&&j.length){var k3=P(i[0]),l3=P(j[0]);if(k3<=l3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function U(i,j,k){var k3=B(i,j)[k];if(k3){return a1(i,k3);}return"";}function V(i,j,k){var k3=B(i,j)[k];return r(i,k3);}function W(i,j,k){var k3=E(i,j)[k];if(k3&&k3.Title){return k3.Title.String;}return"";}function X(i,j,k){var k3=j.filter(G);k3=Q(k3);if(!k3||!k3.length||!k3.length>0){return"";}return r(i,k3[0]);}function Y(i,j,k,k3){var l3=E(i,j)[k];if(!l3){return"";}var m3=i.getSetting('ovpCardProperties');var n3=m3.getProperty("/entityType");var o3=m3.getProperty("/metaModel");return _(i,l3,n3,o3,k3);}function Z(i,j,k){var k3=E(i,j)[k];if(k3&&k3.Criticality){return true;}}function $(i,j,k){var k3=E(i,j)[k];var l3=k3.Criticality.Path;return"{path:'"+l3+"'}";}function _(i,j,k,k3,l3){if(!j||!j.Value){return"";}var m3=i.getSetting('ovpCardProperties');var n3=false;if(m3){var o3=m3.getProperty("/ignoreSapText");n3=o3==undefined?n3:o3;}var p3=k3.getODataProperty(k,j.Value.Path);var q3=false;if(n3==true){if(p3&&(p3["com.sap.vocabularies.Analytics.v1.Measure"]||p3["sap:aggregation-role"]=="measure")){q3=true;}}if(!q3&&p3){var r3;if(p3["com.sap.vocabularies.Common.v1.Text"]){r3=p3["com.sap.vocabularies.Common.v1.Text"].String?p3["com.sap.vocabularies.Common.v1.Text"].String:p3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(p3["sap:text"]){r3=p3["sap:text"];}if(r3){p3=k3.getODataProperty(k,r3);j={Value:{Path:p3.name}};}}return a1(i,j,l3);}function a1(i,j,k,k3){if(j.Value.Apply){return O.format(i,j.Value);}var l3=i.getSetting('ovpCardProperties');var m3=l3.getProperty("/entityType");var n3=l3.getProperty("/metaModel");return c1(i,j,m3,n3,k,k3);}a1.requiresIContext=true;function b1(i,j,k,k3){if((!k)||(typeof k3!=='string')){return k3;}var l3=k[A.TEXT];if(!l3){return k3;}var m3,n3;m3=k[A.TEXT_ARRANGEMENT];n3=m3&&m3.EnumMember;if(!n3){m3=l3&&l3[A.TEXT_ARRANGEMENT];n3=m3&&m3.EnumMember;}if(!n3){m3=j&&j[A.TEXT_ARRANGEMENT];n3=m3&&m3.EnumMember;}if(!n3){return k3;}var o3=O.format(i,l3);if(!o3||o3===" "){return k3;}var p3;switch(n3){case T.TEXT_FIRST:p3=o3+" ("+k3+")";break;case T.TEXT_LAST:p3=k3+" ("+o3+")";break;case T.TEXT_ONLY:p3=o3;break;case T.TEXT_SEPARATE:p3=k3+" ("+o3+")";break;default:p3=k3;break;}return p3;}function c1(j,k,k3,l3,m3,n3,o3){if(k.Value.Apply){return O.format(j,k.Value);}var p3=k.Value.Path?k.Value.Path:k.Value.String;var q3=l3.getODataProperty(k3,p3),r3="",s3;var t3=j.getSetting("ovpCardProperties");var u3=t3&&t3.getProperty("/contentFragment");if(!n3){if(k.Value.Path&&k.Value.Path.split("/").length>1){q3=j1(l3,k3,k.Value.Path);}if(!q3){return"";}if(q3["type"]==='Edm.DateTime'||q3["type"]==='Edm.DateTimeOffset'){var v3=t3&&t3.getProperty("/showDateInRelativeFormat");s3=g1("dateFormatFunction",v3,q3["type"]==='Edm.DateTime'?true:false);r3=d1([k.Value.Path?k.Value.Path:q3.name],s3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||q3["scale"]){var w3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,x3;var y3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(q3["Org.OData.Measures.V1.ISOCurrency"]){x3=q3["Org.OData.Measures.V1.ISOCurrency"].Path?q3["Org.OData.Measures.V1.ISOCurrency"].Path:q3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(q3["Org.OData.Measures.V1.Unit"]){x3=q3["Org.OData.Measures.V1.Unit"].Path?q3["Org.OData.Measures.V1.Unit"].Path:q3["Org.OData.Measures.V1.Unit"].String;}else if(q3["sap:unit"]){x3=q3["sap:unit"];}var z3=x3?l3.getODataProperty(k3,x3):null,A3=[k.Value.Path?k.Value.Path:q3.name];if(w3>2){w3=2;}if(q3["Org.OData.Measures.V1.ISOCurrency"]){var B3=q3["Org.OData.Measures.V1.ISOCurrency"];if(B3.Path){s3=h1(w3,y3);A3.push(B3.Path);}else if(B3.String){s3=h1(w3,y3,B3.String);}}else if(z3&&(z3["Org.OData.Measures.V1.ISOCurrency"]||z3["sap:semantics"]==="currency-code")){s3=h1(w3,y3);A3.push(x3);}else{s3=e1(w3,y3);}r3=d1(A3,s3);}else{if(o3){r3=O.simplePath(j,k.Value);}else{var C3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var D3=C3.split(",");var E3=[];if(D3.length>1){for(var i=0;i<D3.length;i++){if(D3[i].indexOf("path:")>=0||D3[i].indexOf("type:")>=0){E3.push(D3[i]);}}if(E3.length>0){r3=r3+E3.join(',');if(r3.substring(r3.length-1)!=="}"){r3=r3+"}";}}}else{r3=C3;}}}if(u3){r3=b1(j,k3,q3,r3);}if(q3["Org.OData.Measures.V1.Unit"]){var F3=q3["Org.OData.Measures.V1.Unit"];if(F3.Path){r3+=(" "+d1([F3.Path]));}else if(F3.String){if(F3.String!=="%"){r3+=" ";}r3+=F3.String;}}}if(!m3){if(q3["Org.OData.Measures.V1.ISOCurrency"]){var B3=q3["Org.OData.Measures.V1.ISOCurrency"];if(B3.Path){r3+=(" "+d1([B3.Path]));}else if(B3.String){r3+=(" "+B3.String);}}}if(r3[0]===" "){r3=r3.substring(1);}return r3;}function d1(j,k){var k3="",l3=j.length;if(l3>1){k3="{parts:[";for(var i=0;i<l3;i++){k3+=("{path: '"+j[i]+"'}"+((i===l3-1)?"]":", "));}}else{k3="{path: '"+j[0]+"'";}k3+=(k?(", formatter: '"+k+"'"):"")+"}";return k3;}function e1(i,j){var k="formatNumberCalculation_"+(j?i+"_"+j:i);if(!h[k]){h[k]=f1(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function f1(i,j){return function(k){var k3=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return k3.format(Number(k));};}function g1(i,j,k){var k3={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){k3={'style':'medium'};}if(!l[i]){l[i]=function(l3){var m3=D.getInstance(k3);if(!l3){l3="";return l3;}return m3.format(new Date(l3),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function h1(i,j,k){var k3=j?i+"_"+j:i;var l3="formatCurrencyCalculation_"+(k?k+"_"+k3:k3);if(!m[l3]){m[l3]=i1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+l3;}function i1(i,j,k){return function(k3,l3){var m3="";var n3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});if(l3){m3=n3.format(k3,l3);}else{m3=k?n3.format(k3,k):n3.format(k3);}return m3;};}function j1(j,k,k3){var l3=k3.split("/");if(l3.length>1){for(var i=0;i<(l3.length-1);i++){var m3=j.getODataAssociationEnd(k,l3[i]);if(m3){k=j.getODataEntityType(m3.type);}}return j.getODataProperty(k,l3[l3.length-1]);}}function k1(i,j,k){var k3=E(i,j);var l3=n.StateValues;var m3=k3[k];if(!m3){return l3.None;}if(m3.Criticality){return o1(i,m3,l3);}return q1(i,m3,l3);}function l1(i,j,k){var k3=E(i,j);if(k3&&k3.length){var l3=k3[0];if(l3&&(l3.Criticality||l3.CriticalityCalculation)){return true;}}return false;}function m1(i,j,k){if(l1(i,j,k)){return'';}return'#5cbae6';}m1.requiresIContext=true;function n1(i,j,k){var k3=E(i,j),l3=n.ColorValues;var m3=l3.None;if(k3.length>k){var n3=k3[k];if(n3&&n3.Criticality){m3=o1(i,n3,l3);}else{m3=q1(i,n3,l3);}}return m3;}function o1(i,j,k){var k3=k.None;var l3;var m3=j.Criticality;if(m3){l3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(m3.Path){var n3='$'+O.simplePath(i,m3);k3=f(l3,n3);}else if(m3.EnumMember){var o3="'"+m3.EnumMember+"'";k3=f(l3,o3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return k3;}function p1(i,j,k){var k3=E(i,j);var l3="None";if(k3.length>k){var m3=k3[k];if(m3&&m3.Criticality&&m3.Criticality.Path){l3=$(i,j,k);}else{l3=q1(i,m3,n.StateValues);l3=w(l3);}}return l3;}function q1(i,j,k){var k3=k.None;if(j.Criticality){k3=v(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){k3=r1(i,j,k);}return k3;}function r1(i,j,k){var k3=I1(j.Value);var l3=j.CriticalityCalculation.ImprovementDirection.EnumMember;var m3=I1(j.CriticalityCalculation.DeviationRangeLowValue);var n3=I1(j.CriticalityCalculation.DeviationRangeHighValue);var o3=I1(j.CriticalityCalculation.ToleranceRangeLowValue);var p3=I1(j.CriticalityCalculation.ToleranceRangeHighValue);var q3=s1(m3);var r3=s1(n3);var s3=s1(o3);var t3=s1(p3);var u3="parts: ["+k3;u3+=q3?","+m3:"";u3+=r3?","+n3:"";u3+=s3?","+o3:"";u3+=t3?","+p3:"";u3+="]";var v3=function(){var x3=1;return y(arguments[0],l3,q3?arguments[x3++]:m3,r3?arguments[x3++]:n3,s3?arguments[x3++]:o3,t3?arguments[x3++]:p3,k);};var w3=u(v3,"formatCriticalityCalculation");return"{"+u3+", formatter: '"+w3+"'}";}function s1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function t1(j,k,k3){var l3="";var m3=k3.split("/");if(m3.length>1){for(var i=0;i<(m3.length-1);i++){var n3=j.getODataAssociationEnd(k,m3[i]);if(n3){k=j.getODataEntityType(n3.type);if(l3){l3=l3+"/";}l3=l3+m3[i];}else{return l3;}}}return l3;}function u1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var k3=0;var l3=k.selectedKey;if(l3&&k.tabs.length>=l3){k3=l3-1;}j=k.tabs[k3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function v1(j,k){var k3=j.getSetting('ovpCardProperties');var l3=k3.getProperty("/addODataSelect");var m3=k3.getProperty("/metaModel");var n3=m3.getODataEntityType(k.entityType);var o3=n3[k3.getProperty('/selectionAnnotationPath')];var p3=n3[k3.getProperty('/presentationAnnotationPath')];var q3="/"+k.name;var r3=Array.prototype.slice.call(arguments,2);var s3=j.getSetting('ovpCardProperties'),t3=s3.getProperty('/parameters');if(o3||!!t3){if((o3&&o3.Parameters&&o3.Parameters.length>0)||!!t3){q3=F2(j.getSetting('dataModel'),k,o3,t3);}}if(k3.getProperty("/cardLayout")&&k3.getProperty("/cardLayout/noOfItems")){var u3="{path: '"+q3+"', length: "+ +(k3.getProperty("/cardLayout/noOfItems"));}else{var u3="{path: '"+q3+"', length: "+J1(k3);}var v3=[];if(l3){v3=x1(j,m3,n3,r3);var w3=k3.getProperty("/template");if(w3!="sap.ovp.cards.charts.analytical"&&w3!="sap.ovp.cards.charts.smart.chart"){var x3=A1(p3);for(var i=0;i<x3.length;i++){if(v3.indexOf(x3[i])===-1){v3.push(x3[i]);}}}}var y3=w1(m3,n3,r3);var z3=u1(k3);if(z3||v3.length>0||y3.length>0){u3=u3+", parameters: {";}if(v3.length>0||y3.length>0){if(v3.length>0){u3=u3+"select: '"+v3.join(',')+"'";}if(y3.length>0){if(v3.length>0){u3=u3+", ";}u3=u3+"expand: '"+y3.join(',')+"'";}if(z3){u3=u3+", ";}}if(z3){u3=u3+"custom: {cardId: '"+k3.getProperty("/cardId")+"'}";}if(z3||v3.length>0||y3.length>0){u3=u3+"}";}var A3=z1(k3,p3);if(A3.length>0){u3=u3+", sorter:"+JSON.stringify(A3);}var B3=E1(k3,o3);if(B3.length>0){u3=u3+", filters:"+JSON.stringify(B3);}u3=u3+"}";return u3;}v1.requiresIContext=true;function w1(k,k3,l3){var m3=[];var n3,o3,p3,q3;for(var i=0;i<l3.length;i++){if(!l3[i]){continue;}n3=k3.$path+"/"+l3[i];o3=k.createBindingContext(n3);p3=o3.getObject();p3=p3?p3:[];for(var j=0;j<p3.length;j++){if(p3[j].Value&&p3[j].Value.Path){q3=t1(k,k3,p3[j].Value.Path);if(q3&&m3.indexOf(q3)===-1){m3.push(q3);}}}}return m3;}function x1(k3,l3,m3,n3){var o3=[];var p3,q3,r3;for(var i=0;i<n3.length;i++){if(!n3[i]){continue;}p3=m3.$path+"/"+n3[i];q3=l3.createBindingContext(p3);var s3={};if(k3&&k3.bDummyContext){q.extend(s3,k3,q3,true);}else{s3=k3;}r3=q3.getObject();if(!r3){r3=[];}else if(c(r3)){if(r3.Data){r3=r3.Data;}else{r3=[];}}var t3;var u3;var v3;var w3;for(var j=0;j<r3.length;j++){u3=[];t3=r3[j];v3="";w3=t3.RecordType;if(w3==="com.sap.vocabularies.UI.v1.DataField"){v3=c1(s3,t3,m3,l3,undefined,undefined,true);}else if(w3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var x3=K(m3.$path,t3);v3=_(s3,l3.getProperty(x3),m3,l3);var y3=J(l3.getProperty(x3));if(y3&&y3.length>0){v3+=y3;}}else if(w3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&t3.Url){var z3;if(!t3.Url.UrlRef){z3=O.format(s3,t3.Url);}if(z3&&z3.substring(0,2)==="{="){v3=z3;}}if(v3){var A3=O.simplePath(s3,t3.Value);if(v3.indexOf("(")<0&&v3!==A3){v3=[].concat(A3,v3).join(" ");}u3=y1(v3);}if(u3&&u3.length>0){var B3;for(var k=0;k<u3.length;k++){B3=u3[k];if(!o3[B3]){o3[B3]=true;var C3=C.getUnitColumn(B3,m3);if(C3&&C3!==B3){o3[C3]=true;}var D3=e3(l3,m3,B3);if(D3&&D3!==B3){o3[D3]=true;}}}}}}return Object.keys(o3);}function y1(j){var i,k=0,k3=j.length,l3="",m3;for(i=0;i<k3;i++){m3=j.charAt(i);if(!m3){return;}switch(m3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}l3+=m3;}j=l3;var n3=/\${([a-zA-Z0-9\_|\/]*)/g;var o3=/[^[{]*[a-zA-Z0-9\_]/g;var p3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var q3,r3,s3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){q3=n3;r3=1;}else if(j.indexOf("path")!==-1){var t3=o3.exec(j);while(t3){if(t3[0].indexOf("path")===-1&&t3[0].indexOf("@i18n")!==0){s3.push(t3[0]);}t3=o3.exec(j);}q3=p3;r3=1;}else{q3=o3;r3=0;}var u3=q3.exec(j);while(u3){if(u3[r3]&&u3[r3].indexOf("@i18n")!==0){s3.push(u3[r3]);}u3=q3.exec(j);}return s3;}function z1(j,k){var k3=[];var l3,m3;var n3=j.getProperty("/sortBy");if(n3){var o3=j.getProperty('/sortOrder');if(o3&&o3.toLowerCase()!=='descending'){m3=false;}else{m3=true;}l3={path:n3,descending:m3};k3.push(l3);}var p3=k&&k.SortOrder||undefined;var q3,n3;if(p3){for(var i=0;i<p3.length;i++){q3=p3[i];n3=q3.Property.PropertyPath;m3=F1(q3.Descending,true);l3={path:n3,descending:m3};k3.push(l3);}}return k3;}function A1(j){var k=[];var k3=j&&j.RequestAtLeast||undefined;if(k3){for(var i=0;i<k3.length;i++){if(k3[i].PropertyPath){k.push(k3[i].PropertyPath);}}}return k;}function B1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:E1(i,k),parameters:D1(k)};}function C1(j){if(!j){return;}var k=j.getProperty('/entityType');var k3=k[j.getProperty('/presentationAnnotationPath')];var l3=z1(j,k3);var m3=[];var i,n3=l3.length;for(i=0;i<n3;i++){if(!l3[i].path){continue;}m3.push({Property:l3[i].path,Descending:l3[i].descending});}if(m3.length>0){return{SortOrder:m3};}}function D1(j){var k,k3=[];if(!j||!j.Parameters){return k3;}var l3=j.Parameters.length;for(var i=0;i<l3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}k3[k3.length]={path:k.PropertyName.PropertyPath,value:H1(k.PropertyValue)};}return k3;}function E1(k,k3){var l3=[];var m3;var n3=k.getProperty("/filters");if(n3){l3=l3.concat(n3);}if(k3&&k3.SelectOptions){m3=k3.SelectOptions;}else{m3=k3;}var o3,p3,q3;if(m3){for(var i=0;i<m3.length;i++){o3=m3[i];p3=o3.PropertyName.PropertyPath;for(var j=0;j<o3.Ranges.length;j++){q3=o3.Ranges[j];if(q3.Sign.EnumMember){var r3={path:p3,operator:q3.Option.EnumMember.split("/")[1],value1:H1(q3.Low),value2:H1(q3.High),sign:q3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(r3.sign==="E"&&r3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(r3.sign==="E"&&r3.operator===F.EQ){r3.operator=F.NE;r3.sign="I";}if(r3.operator==="CP"&&r3.sign==="I"){var s3=F.Contains;var t3=r3.value1;if(t3){var u3=t3.indexOf('*');var v3=t3.lastIndexOf('*');if(u3>-1){if((u3===0)&&(v3!==(t3.length-1))){s3=F.EndsWith;t3=t3.substring(1,t3.length);}else if((u3!==0)&&(v3===(t3.length-1))){s3=F.StartsWith;t3=t3.substring(0,t3.length-1);}else{t3=t3.substring(1,t3.length-1);}}}r3.operator=s3;r3.value1=t3;}l3.push(r3);}}}}return l3;}function F1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function G1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function H1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=F1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=G1(i);}}return j;}function I1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return H1(i);}}else{return"";}}function J1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var k3=i.getProperty('/listFlavor');var l3;var m3="desktop";if(a.system.phone){m3="phone";}else if(a.system.tablet){m3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(k3=="bar"){l3=I["List_extended_bar"];}else{l3=I["List_extended"];}}else if(k3=="bar"){l3=I["List_condensed_bar"];}else{l3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){l3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){l3=I["Stack_complex"];}else{l3=I["Stack_simple"];}}if(l3){return l3[m3];}return 5;}function K1(i){var j=i.getObject();var k=E(i,j,true);var k3=k.map(function(l3){if(l3&&l3.Value&&l3.Value.Path){return l3.Value.Path;}else if(l3&&l3.fn&&l3.fn.Path){return l3.fn.Path;}});j.filter(function(l3,m3){if(l3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&k3.indexOf(l3.Value.Path)>-1){j.splice(m3,1);}});}K1.requiresIContext=true;function L1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}L1.requiresIContext=true;function M1(i,j){var k=E(i,j);return k.length;}M1.requiresIContext=true;function N1(i,j){return P1(i,j,0);}N1.requiresIContext=true;function O1(i,j){return P1(i,j,1);}O1.requiresIContext=true;function P1(i,j,k){var k3=E(i,j),l3=k3[k];if(l3&&l3.Value&&l3.Value.Path){return l3.Value.Path;}return"";}function Q1(i,j){return V(i,j,0);}Q1.requiresIContext=true;function R1(i,j){return V(i,j,1);}R1.requiresIContext=true;function S1(i,j){return V(i,j,2);}S1.requiresIContext=true;function T1(i,j){return V(i,j,3);}T1.requiresIContext=true;function U1(i,j){return V(i,j,4);}U1.requiresIContext=true;function V1(i,j,k){return U(i,j,k);}V1.requiresIContext=true;function W1(i,j,k){return Y(i,j,k);}W1.requiresIContext=true;function X1(i,j,k,k3){var l3=M1(i,j);if(l3>0){return W1(i,j,k);}else{return V1(i,j,k3);}}X1.requiresIContext=true;function Y1(i,j,k){return r2(i,j,k);}Y1.requiresIContext=true;function Z1(i,j){return W(i,j,0);}Z1.requiresIContext=true;function $1(i,j){return W(i,j,1);}$1.requiresIContext=true;function _1(i,j){return W(i,j,2);}_1.requiresIContext=true;function a2(i,j){return X(i,j,0);}a2.requiresIContext=true;function b2(j,k){for(var i=0;i<k.length;i++){var k3=k[i];if(k3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(k3.IconUrl&&k3.IconUrl.String){return k3.IconUrl.String;}if(k3.IconUrl&&k3.IconUrl.Path){return O.simplePath(j,k3.IconUrl);}}}}b2.requiresIContext=true;function c2(i,j,k){var k3="";var l3;if(Array.isArray(j)){l3=E(i,j)[k];}else{var m3=q.extend({},j);var n3=q.extend({},i);l3=p2(n3,m3);}if(!l3||!l3.Value){return k3;}var o3=i.getSetting('ovpCardProperties');var p3=o3&&o3.getProperty("/entityType");var q3=o3&&o3.getProperty("/metaModel");var r3=q3&&q3.getODataProperty(p3,l3.Value.Path);var s3=r3&&r3["Org.OData.Measures.V1.ISOCurrency"];if(s3&&s3.Path){k3+=(" "+d1([s3.Path]));}else if(s3&&s3.String){k3+=(" "+s3.String);}return k3;}c2.requiresIContext=true;function d2(i,j,k,k3){return Y(i,j,k,k3);}d2.requiresIContext=true;function e2(i,j){return k1(i,j,0);}e2.requiresIContext=true;function f2(i,j){return n1(i,j,0);}f2.requiresIContext=true;function g2(i,j){return k1(i,j,1);}g2.requiresIContext=true;function h2(i,j){return k1(i,j,2);}h2.requiresIContext=true;function i2(i,j){return p1(i,j,0);}i2.requiresIContext=true;function j2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return v(j,n.ColorValues);}function k2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return q1(i,j,n.ColorValues);}}k2.requiresIContext=true;function l2(i,j){return Z(i,j,0);}l2.requiresIContext=true;function m2(i,j){var k=E(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}m2.requiresIContext=true;function n2(i,j){return Z(i,j,1);}n2.requiresIContext=true;function o2(i,j){return Z(i,j,2);}o2.requiresIContext=true;function p2(i,j){var k=i.getPath(0);var k3=k.slice(0,k.lastIndexOf("/"));k3=k3.slice(0,k3.lastIndexOf("/"));var l3=K(k3,j);j=i.getModel(0).getProperty(l3);return j;}function q2(i,j){if(!j){return"";}return a1(i,j);}q2.requiresIContext=true;function r2(j,k,k3,l3){var m3;var n3=l3==undefined?k3:B(j,k3)[l3];var o3=j.getSetting('ovpCardProperties');var p3=o3.getProperty("/metaModel");var q3=p3.getODataEntityType(k.entityType);var r3=q3.property;if(r3){for(var i=0;i<r3.length;i++){if(n3.Value.Path===r3[i].name){m3=r3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(m3){return O.format(j,m3);}else{return"";}}}}}function s2(i,j,k){var k3=k===undefined?j.Value.Path:j[k].Value.Path;var l3=(k3.indexOf("/")!=-1)?k3.split('/')[0]:"";return l3;}s2.requiresIContext=true;function t2(i,j){var k=i.getSetting('ovpCardProperties');var k3=k.getProperty("/metaModel");var l3=k3.getODataEntityType(j.entityType);if(l3["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}t2.requiresIContext=true;function u2(i,j,k){if(!j){return"";}var k3=i.getSetting('ovpCardProperties');var l3=k3.getProperty("/entityType");var m3=k3.getProperty("/metaModel");var n3=q.extend({},j);var o3=q.extend({},i);j=p2(o3,n3);return _(i,j,l3,m3,k);}u2.requiresIContext=true;function v2(i,j){var k=q.extend({},j);var k3=q.extend({},i);var l3="None",m3=n.StateValues;j=p2(k3,k);if(j&&j.Criticality){l3=o1(i,j,m3);}else{l3=q1(i,j,m3);}return l3;}v2.requiresIContext=true;function w2(i,j){var k=q.extend({},j);var k3=q.extend({},i);j=p2(k3,k);if(j&&j.Criticality){return true;}}w2.requiresIContext=true;function x2(i,j){var k=q.extend({},j);var k3=q.extend({},i);var l3=i.getSetting('ovpCardProperties');var m3=l3.getProperty("/entityType");var n3=l3.getProperty("/metaModel");j=p2(k3,k);if(!j){return;}var o3=n3.getODataProperty(m3,j.Value.Path);if(j&&o3&&o3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(o3&&((o3.type=="Edm.DateTime")||(o3.type=="Edm.DateTimeOffset"))){return'Right';}}x2.requiresIContext=true;function y2(i,j){var k=q.extend({},j);var k3=q.extend({},i);j=p2(k3,k);var l3="None";if(j&&j.Criticality&&j.Criticality.Path){l3="{path:'"+j.Criticality.Path+"'}";}else{l3=q1(i,j,n.StateValues);l3=w(l3);}return l3;}y2.requiresIContext=true;function z2(j,k){var k3;for(var i=0;i<k.length;i++){k3=k[i];if(k3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||k3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||k3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}z2.requiresIContext=true;function A2(i,j){var k=E(i,j)[0];if(k&&k.Value&&k.Value.Path){var k3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var l3=i.getModel(0);var m3=l3.getProperty(k3);var n3=l3.getODataProperty(m3,k.Value.Path);if(n3&&n3["Org.OData.Measures.V1.Unit"]){return n3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}A2.requiresIContext=true;function B2(i){var j=i.getObject();var k=i.getModel();var k3=k.getProperty("/metaModel");var l3=k3.getODataEntitySet(k.getProperty("/entitySet"));var m3=k3.getODataEntityType(l3.entityType);j=m3.$path+"/"+j;return k3.createBindingContext(j);}function C2(i,j){if(i==='Edm.String'){var k=j.PropertyValue.String;return k;}return j.PropertyValue.String;}function D2(i,j,k,k3){var l3="";var m3=[];if(k3&&k3.Parameters){i.parameters.forEach(function(o3){k3.Parameters.forEach(function(p3){var q3=p3.PropertyName.PropertyPath.split("/");q3=q3[q3.length-1];if(q3===o3){var r3=C2(i['parameterType'][o3],p3);r3=d(j.formatValue(r3,i['parameterType'][o3]));m3.push(q3+'='+r3);}});});}else{l3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return l3;}try{l3='/'+i.entitySetName+'('+m3.join(',')+')/'+i.navPropertyName;}catch(n3){l3="/"+k.name;L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+n3||n3.message);}return l3;}function E2(j,k,k3,l3,m3){var n3="";var o3=new o.Model(o.Model.ReferenceByModel(j));var p3=o3.findQueryResultByName(k.name);var q3=new o.QueryResultRequest(p3);var r3=p3.getParameterization();if(!r3){n3="/"+k.name;return n3;}if(m3){var s3=m3.getAnalyticalParameters();}if(r3){var t3;q3.setParameterizationRequest(new o.ParameterizationRequest(r3));if(k3&&k3.Parameters){e(k3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){t3=this.PropertyNameFrom.PropertyPath.split("/");q3.getParameterizationRequest().setParameterValue(t3[t3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{t3=this.PropertyName.PropertyPath.split("/");q3.getParameterizationRequest().setParameterValue(t3[t3.length-1],this.PropertyValue.String);}});}else if(l3){e(l3,function(){q3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(s3&&s3.length>0){var u3=m3&&m3.getUiState({allFilters:false});var v3=u3?JSON.stringify(u3.getSelectionVariant()):"{}";var k3=new S(v3);for(var w3 in r3.getAllParameters()){for(var i=0;i<s3.length;i++){if(s3[i]&&(s3[i].name==w3)){var x3=s3[i].name;var y3=k3.getParameter(x3);if(!y3){var z3=k3.getSelectOption(x3);y3=z3&&z3[0]&&z3[0].Low;}q3.getParameterizationRequest().setParameterValue(w3,y3);}}}}else{n3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return n3;}}try{n3=q3.getURIToQueryResultEntitySet();}catch(A3){p3=q3.getQueryResult();n3="/"+p3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+A3||A3.message);}return n3;}function F2(i,j,k,k3,l3){var m3="";if(M.checkAnalyticalParameterisedEntitySet(i,j.name)){m3=E2(i,j,k,k3,l3);}else{var n3=M.getParametersByEntitySet(i,j.name);var o3=M.getPropertyOfEntitySet(i,j.name);var p3={};if(n3){n3['parameters'].forEach(function(q3){o3.forEach(function(r3){if(r3['name']==q3){p3[q3]=r3['type'];}});});n3['parameterType']=p3;m3=D2(n3,i,j,k);}else{m3="/"+j.name;}}return m3;}function G2(j,k,ns){var k3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<k3.length;i++){if(ns+"."+k3[i].name===k){return k3[i];}}}function H2(i,j){var k=i.filter(function(l3){if(l3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var k3=Q(k);if(k3){return k3[j];}return;}function I2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=H2(k,0);return r2(i,j,k);}I2.requiresIContext=true;function J2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=H2(k,1);return r2(i,j,k);}J2.requiresIContext=true;function K2(i,j){var k=i.filter(function(l3){if(l3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&l3.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var k3=Q(k);if(k3){return k3[j];}return;}function L2(i){if(!i||!i.length||i.length===0){return false;}var j=K2(i,0);if(j){return true;}return false;}function M2(i,j,k,k3){var l3,m3,n3;if(k&&k.Value&&k.Value.Path){l3=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){l3=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){m3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){n3=k.Title.Path;}var o3="";var p3=k3&&k3.Parameters;var q3="";var r3=i.getSetting('ovpCardProperties'),s3=r3.getProperty('/parameters');p3=p3||!!s3;if(p3){var t3=i.getSetting("dataModel");var u3=F2(t3,j,k3,s3);o3+="{path: '"+u3+"'";}else{o3+="{path: '/"+j.name+"'";}o3+=", length: 1";var v3=i.getSetting('ovpCardProperties');var w3=v3.getProperty("/entityType");var x3=C.getUnitColumn(l3,w3);var y3=E1(v3,k3);if(y3.length>0){q3+=", filters: "+JSON.stringify(y3);}var z3=[];z3.push(l3);if(m3){z3.push(m3);}else if(n3){z3.push(n3);}if(k&&k.Criticality&&k.Criticality.Path){z3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){z3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){z3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){z3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){z3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(x3){z3.push(x3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){z3.push(k.TrendCalculation.ReferenceValue.Path);}var A3=u1(r3);var B3=A3?", custom: {cardId: '"+r3.getProperty("/cardId")+"'}":"";return o3+", parameters:{select:'"+z3.join(",")+"'"+B3+"}"+q3+"}";}M2.requiresIContext=true;function N2(k){if(isNaN(k)){return k;}var i,j,k3=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){k3=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var l3=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(k3){return l3.format(Number(k))+" %";}else{return l3.format(Number(k));}}}function O2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var k3=j.getProperty("/metaModel");var l3=k3.getODataProperty(k,i.Value.Path);if(l3["Org.OData.Measures.V1.Unit"]){var m3=l3["Org.OData.Measures.V1.Unit"];if(m3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function P2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=I1(j.Value);var k3=I1(j.TrendCalculation.ReferenceValue);var l3=I1(j.TrendCalculation.DownDifference);var m3=I1(j.TrendCalculation.UpDifference);var n3=s1(k3);var o3=s1(l3);var p3=s1(m3);var q3="parts: ["+k;q3+=n3?","+k3:"";q3+=o3?","+l3:"";q3+=p3?","+m3:"";q3+="]";var r3=function(){var t3=1;return z(arguments[0],n3?arguments[t3++]:k3,o3?arguments[t3++]:l3,p3?arguments[t3++]:m3);};var s3=u(r3,"formatTrendDirection");return"{"+q3+", formatter: '"+s3+"'}";}P2.requiresIContext=true;function Q2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function R2(k,i){var j,k3,l3,m3,n3=false;if(isNaN(+k)){return"";}if(k==0){m3=i;}else{m3=k;}k3=this.getModel('ovpCardProperties');if(k3.getProperty("/iNumberOfFractionalDigits")){l3=+(k3.getProperty("/iNumberOfFractionalDigits"));}if(k3.getProperty("/bPercentageAvailableForTarget")){n3=true;}if(i){j=i;}else{if(k3.getProperty("/sManifestTargetValue")){j=k3.getProperty("/sManifestTargetValue");}}if(!l3||l3<0){l3=0;}else if(l3>2){l3=2;}if(j){var o3=N.getFloatInstance({minFractionDigits:l3,maxFractionDigits:l3,style:"short",showScale:true,shortRefNumber:m3});if(n3){return o3.format(+(j))+" %";}else{return o3.format(+(j));}}}function S2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var k3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var l3=k3.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(l3["Org.OData.Measures.V1.Unit"]){var m3=l3["Org.OData.Measures.V1.Unit"];if(m3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function T2(k,i){var j,k3,l3;if(isNaN(+k)){return"";}k=+(k);l3=this.getModel('ovpCardProperties');if(l3.getProperty("/iNumberOfFractionalDigits")){j=+(l3.getProperty("/iNumberOfFractionalDigits"));}if(i){k3=+(i);}else{if(l3.getProperty("/sManifestTargetValue")){k3=+(l3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(k3){var m3=((k-k3)/k3);var n3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return n3.format(m3);}}function U2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function V2(j,k){var k3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){k3=j[i];break;}}return k3?k3.name:null;}function W2(i,k){return V2(i,k);}function X2(i,k){var j=V2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function Y2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var k3=this.getModel('ovpCardProperties').getProperty("/metaModel");var l3=this.getModel('ovpCardProperties').getProperty("/entityType");var m3;if(i.GroupBy.constructor===Array){m3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{m3=i.GroupBy.Collection;}var n3;e(m3,function(){n3=d3(k3,l3,this.PropertyPath);if(!n3){return;}j+=n3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function Z2(i,j,k){var k3=true;var l3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][l3].PropertyName.PropertyPath){k3=false;}j=[j];var m3=i.getSetting('ovpCardProperties');var n3=m3.getProperty("/entityType");var o3=m3.getProperty("/metaModel");var p3=E1(m3,j);if(p3.length==0){return"";}var q3;var r3;q3=p3[0].path;r3=e3(o3,n3,q3);if(r3!==q3){return"";}var s3=o3.getODataProperty(n3,j[0].PropertyName.PropertyPath)["type"];var t3=b3(p3,s3);if(k3===true){return t3+", ";}return t3;}Z2.requiresIContext=true;function $2(i,j,k){var k3=!(j.index===(k.length-1));var l3=i.getSetting('ovpCardProperties');var m3=l3.getProperty("/metaModel");var n3=l3.getProperty("/entityType");var o3=m3.getODataProperty(n3,k[j.index].path)["type"];var p3=b3([k[j.index]],o3);if(k3===true){return p3+", ";}return p3;}$2.requiresIContext=true;function _2(i){return i.id;}function a3(i){return i.id;}function b3(j,k){var k3=[];for(var i=0;i<j.length;i++){k3.push(c3(j[i],k));}return k3.join(', ');}function c3(i,j){var k=false;var k3,l3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){k3=l3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){k3=l3.format(new Date(i.value1),true);}else{k3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){k3+=" - "+l3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){k3+=" - "+l3.format(new Date(i.value1),true);}else{k3+=" - "+i.value1;}}if(k){k3=b.getText("kpiHeader_Filter_NotOperator",[k3]);}return k3;}function d3(i,j,k){return f3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function e3(i,j,k){return f3(i,j,k,"sap:text");}function f3(i,j,k,k3){var l3=i.getODataProperty(j,k);if(!l3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var m3=l3[k3];if(m3){if(k3==="com.sap.vocabularies.Common.v1.Label"){return m3.String;}return m3;}return l3.name;}function g3(i){if(!i||!i.Value||!i.Value.Path){return"";}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function h3(i,j){if(j.hasOwnProperty(i)){return true;}return false;}function i3(i,j){if(j[i].customDateRangeImplementation){return j[i].customDateRangeImplementation;}else{var k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:[{path:'key',contains:j[i].selectedValues,exclude:j[i].exclude}]}};return JSON.stringify(k);}}function j3(i){if(i){return undefined;}return"_BASIC";}return{getGroupID:j3,getConditionTypeForDateProperties:i3,isDateRangeType:h3,NumberFormatFunctions:h,DateFormatFunctions:l,CurrencyFormatFunctions:m,formatFunctions:g,criticalityConstants:n,TextArrangementType:T,getLabelForDataItem:r,colorPaletteForComparisonMicroChart:m1,formatField:a1,checkFilterPreference:u1,formatItems:v1,getCardSelections:B1,getCardSorters:C1,getFilters:E1,getPrimitiveValue:H1,getAnnotationLabel:W2,getApplicationName:X2,removeDuplicateDataField:K1,formatUrl:L1,getDataPointsCount:M1,getFirstDataPointValue:N1,getFirstDataFieldName:Q1,getSecondDataFieldName:R1,getRequestFields:A1,getThirdDataFieldName:S1,formatDataFieldValueOnIndex:V1,formatDataPointValueOnIndex:W1,formatDataPointOrField:X1,formatsemanticObjectOfDataFieldGeneric:Y1,getLabelForFirstDataPoint:a2,formatImageUrl:b2,formatUnit:c2,formatObjectNumber:d2,formatFirstDataPointState:e2,formatFirstDataPointColor:f2,formatSecondDataPointState:g2,formatThirdDataPointState:h2,formatFirstDataPointStateForSmartField:i2,formatKPIHeaderState:k2,isFirstDataPointCriticality:l2,isFirstDataPointCriticalityForTableStatus:m2,getSortedDataFields:B,getSortedDataPoints:E,formatDataFieldValueGeneric:q2,formatDataPointValue:u2,formatDataPointStateGeneric:v2,checkCriticalityGeneric:w2,checkCriticalityGenericForTableStatus:x2,formatDataPointStateForSmartFieldGeneric:y2,hasActions:z2,isFirstDataPointPercentageUnit:A2,resolveEntityTypePath:B2,resolveParameterizedEntitySet:F2,getAssociationObject:G2,semanticObjectOfFirstDataField:I2,semanticObjectOfSecondDataField:J2,isFirstContactAnnotation:L2,getAggregateNumber:M2,KpiValueFormatter:N2,kpiValueCriticality:j2,formThePathForAggregateNumber:O2,formThePathForTrendIcon:P2,formPathForPercentageChange:Q2,TargetValueFormatter:R2,formPathForTargetValue:S2,returnPercentageChange:T2,isPresentationVarientPresent:U2,listGroupBy:Y2,formTheFilterByString:Z2,formTheFilterByStringNotFromSelVar:$2,formTheIdForFilter:_2,formTheIdForFilterNotFromSelVar:a3,_criticality2state:v,_calculateCriticalityState:y,_calculateTrendDirection:z,_getPropertiesFromBindingString:y1,sortCollectionByImportance:Q,checkNavTargetForContactAnno:s2,checkForContactAnnotation:t2,getKPIHeaderAggregateNumber:g3};},true);
