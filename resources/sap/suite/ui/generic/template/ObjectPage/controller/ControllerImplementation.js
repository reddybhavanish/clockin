sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/SideContentHandler","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/suite/ui/generic/template/js/AnnotationHelper","sap/m/Table","sap/ui/layout/DynamicSideContent","sap/suite/ui/generic/template/lib/ShareUtils","sap/ui/dom/jquery/Selectors","sap/base/Log","sap/suite/ui/generic/template/ObjectPage/controller/MultipleViewsHandler","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/events/KeyCodes","sap/base/util/merge","sap/ui/model/FilterProcessor","sap/suite/ui/generic/template/js/StableIdHelper","sap/ui/core/Element","sap/uxap/ObjectPageSubSection","sap/ui/core/MessageType","sap/base/util/extend","sap/base/util/UriParameters","sap/base/util/isEmptyObject","sap/ui/dom/getFirstEditableInput","sap/ui/dom/jquery/Focusable"],function(C,M,F,S,a,t,d,b,E,A,R,D,c,f,L,g,h,K,m,l,n,o,O,p,q,U,r,s,u){"use strict";var v=25;var w=10;var y={};function z(e){e.setSelectedSection(null);}function I(e){return e.data("inlineCreate")==="true";}function B(e,j){if(e.getBindings){var k=e.getBindings();for(var i=0;i<k.length;i++){B(k[i],j);}}else{var T=e.getType();e.setType(T,j);}}var G=/[A-Za-z].*[A-Za-z]/;var H={getMethods:function(V,T,J){var N=d.getControllerBase(V,T,J);V.oController=J;var P;var Q=new b(J,T,N.stateChanged);var W;var X;var Y;var Z;var $=null;var _=[];var a1=[];var b1=null;var c1=null;var d1=null;var e1=null;var f1;function g1(e){var i=e.getParameter("bindingParams");i.parameters=i.parameters||{};i.parameters.usePreliminaryContext=true;i.parameters.batchGroupId="facets";i.parameters.transitionMessagesOnly=true;return i;}function h1(){L.info("Activate object","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");var e=N.state.CRUDActionHandler;var i=T.oServices.oCRUDManager.activateDraftEntity(e);i.then(function(k){v1();h.showSuccessMessageIfRequired(T.oCommonUtils.getText("OBJECT_SAVED"),T.oServices);var x=J.getOwnerComponent();T.oServices.oViewDependencyHelper.setAllPagesDirty([x.getId()]);T.oServices.oViewDependencyHelper.unbindChildren(x);T.oServices.oApplication.invalidatePaginatorInfo();var H2=x.getNavToListOnSave();T.oServices.oApplication.navigateAfterActivation(!H2&&k.context);},Function.prototype);var j={activationPromise:i};T.oComponentUtils.fire(J,"AfterActivate",j);}function i1(e){var i=J.getView();var j=i.getModel();var k=j.hasPendingChanges();var x=j.getPendingChanges();var H2=Object.create(null);if(x){for(var I2 in x){if(x.hasOwnProperty(I2)){var J2=j.getContext("/"+I2);H2[I2]={context:J2,change:x[I2]};}}}T.oCommonEventHandlers.submitChangesForSmartMultiInput();var K2=T.oServices.oCRUDManager.saveEntity();K2.then(function(M2){if(!e){var N2=T.oComponentUtils.getTemplatePrivateModel();N2.setProperty("/objectPage/displayMode",1);V.setEditable(false);}j1(M2,i,k,H2,e);});var L2={saveEntityPromise:K2};T.oComponentUtils.fire(J,"AfterSave",L2);}function j1(e,i,j,k,x){var H2=P.getModel("ui");var I2=H2.getProperty("/createMode");var J2=J.getOwnerComponent();T.oServices.oViewDependencyHelper.setRootPageToDirty();T.oServices.oViewDependencyHelper.unbindChildren(J2);var K2=J2.getNavToListOnSave();var L2=!K2||x;var M2;if(I2){if(L2){T.oComponentUtils.adaptUrlAfterNonDraftCreateSaved(i.getBindingContext(),x);l2(P);}else{V.navigateUp();}M2="OBJECT_CREATED";}else{M2=j?"OBJECT_SAVED":"OBJECT_NOT_MODIFIED";if(L2){l2(P);}else{V.navigateUp();}}h.showSuccessMessageIfRequired(T.oCommonUtils.getText(M2),T.oServices);for(var N2 in k){var O2=k[N2];var P2=O2.context;var Q2=O2.change;var R2=Object.keys(Q2)||[];var S2=R2.indexOf("__metadata");if(S2>-1){R2.splice(S2,1);}T.oServices.oApplicationController.executeSideEffects(P2,R2);}}function k1(e){var i=e.getSource().getId();l1("SaveAndContEdit",i);}function l1(e,i){var j;var k;var x;if(T.oComponentUtils.isDraftEnabled()){j=1;k=h1;x="activate";}else{j=3;if(e==="SaveAndContEdit"){k=i1.bind(null,true);x=i;}else{k=i1.bind(null,false);x="save";}}T.oCommonUtils.executeIfControlReady(N.state.CRUDActionHandler.handleCRUDScenario.bind(null,j,k),x);}function m1(e){if(I(e.getSource())){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var j=l.groupFilters(i.filters);i.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),j],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[j,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}var k=i.sorter[0]&&i.sorter[0].getGroupFunction();var x=k&&function(H2){var I2=H2.getObject();if(I2.IsActiveEntity||I2.HasActiveEntity){var J2=q({},k(H2));J2.key=J2.key.charAt(0)==="ยง"?"ยง"+J2.key:J2.key;return J2;}return{key:"ยง",text:T.oCommonUtils.getText("NEW_ENTRY_GROUP")};};if(e.getSource().data("disableInlineCreateSort")==="false"){i.sorter.unshift(new S("HasActiveEntity",false,x));}}}function n1(){return P.getHeaderTitle();}function o1(e){var i=T.oComponentUtils.getTemplatePrivateModel();var j={shareEmailPressed:function(){var k=i.getProperty("/objectPage/headerInfo/objectTitle");var x=i.getProperty("/objectPage/headerInfo/objectSubtitle");if(x){k=k+" - "+x;}var H2=document.URL.replace(/\(/g,'%28').replace(/\)/g,'%29');sap.m.URLHelper.triggerEmail(null,k,H2);},shareJamPressed:function(){c.openJamShareDialog(i.getProperty("/objectPage/headerInfo/objectTitle")+" "+i.getProperty("/objectPage/headerInfo/objectSubtitle"));},getModelData:function(){return{title:i.getProperty("/objectPage/headerInfo/objectTitle"),subtitle:i.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:c.getCustomUrl()};}};c.openSharePopup(T.oCommonUtils,e,j);}function p1(){return T.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(e){var i=e.getSource();var j=i.getBindingContext("buttons");var k=j.getProperty("link");var x=j.getProperty("param");var H2=k.intent;var I2=H2.split("#")[1].split("-")[0];var J2=H2.split("-")[1].split("?")[0].split("~")[0];var K2={semanticObject:I2,action:J2,parameters:x};T.oServices.oDataLossHandler.performIfNoDataLoss(function(){var L2=J.getView().getBindingContext();T.oCommonEventHandlers.onRelatedAppNavigation(K2,L2);},Function.prototype);}},"buttons");}var q1;function r1(){q1=function(e){var i=e.getSource().getParent();var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=N.state.CRUDActionHandler;var x=J.getOwnerComponent();var H2=x.getModel("_templPrivGlobal");var I2={objectPage:{currentEntitySet:x.getProperty("entitySet")}};H2.setProperty("/generic/multipleViews",I2);var J2=T.oServices.oCRUDManager.deleteEntity(null,null,k);var K2=x.getBindingContext().getPath();var L2=Object.create(null);L2[K2]=J2;T.oServices.oApplication.prepareDeletion(L2);var M2={deleteEntityPromise:J2};T.oComponentUtils.fire(J,"AfterDelete",M2);i.close();};return T.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){var i=e.getSource().getParent();i.close();},onDelete:function(e){q1(e);}},"delete");}function s1(){var e=T.oServices.oApplication.getBusyHelper();if(e.isBusy()){return;}var i=T.oCommonUtils;var j=T.oComponentUtils.getTemplatePrivateModel();var k=(j.getProperty("/objectPage/headerInfo/objectTitle")||"").trim();var x=j.getProperty("/objectPage/headerInfo/objectSubtitle");var H2;var I2={};I2.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");if(k){if(x){H2=[" ",k,x];I2.text=i.getText("DELETE_WITH_OBJECTINFO",H2);}else{H2=[k];I2.text=i.getText("DELETE_WITH_OBJECTTITLE",H2);}}else{I2.text=i.getText("ST_GENERIC_DELETE_SELECTED");}var J2=Promise.resolve(J.beforeDeleteExtension());J2.then(function(K2){q(I2,K2);r1().then(function(L2){var M2=L2.getModel("delete");M2.setData(I2);L2.open();});},Function.prototype);}function t1(e){var i=e.getParameter("columnInfos");var j=i&&i.length-1;while(j>=0){if(i[j].ignore){i.splice(j,1);}j-=1;}var k=i.reduce(function(H2,I2){if(!I2.type&&!I2.customParseFunction){H2.push(I2);}return H2;},[]);if(k.length>0){var x=T.oCommonUtils.getText("DATA_PASTE_UNSUPPORTED_FORMAT_MESSAGE");M.show(x,{icon:M.Icon.ERROR,title:T.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE]});}}function u1(e){var j;var D1=e.getSource();var k=D1.getId();var x=k.split("::Table")[0]+"::addEntry";var H2=J.byId(x);if(!H2){return;}var I2=e.getParameter("result");if(I2){if(I2.errors){var J2=I2.errors.map(function(S2){return S2.message;});var K2=T.oCommonUtils.getText("DATA_PASTE_ERROR_MESSAGE",[J2.length]);var L2=T.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_MESSAGE");var M2=T.oCommonUtils.getText("DATA_PASTE_ERROR_CORRECTION_NOTE");J2.unshift("");J2.unshift(M2);J2.unshift(L2);M.show(K2,{icon:M.Icon.ERROR,title:T.oCommonUtils.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],details:J2.join("<br />")});}else if(I2.parsedData){j=I2.parsedData;if(j&&j.length){var N2=j.length;var O2;var P2,Q2=[];var R2=sap.m.DraftIndicatorState.Saved;for(var i=0;i<N2;i++){O2=i<N2-1;P2=T.oCommonEventHandlers.addEntry(H2,true,undefined,j[i],O2);Q2.push(P2);}Promise.all(Q2).then(function(){var S2=J.getOwnerComponent();var T2=S2.getAppComponent();var U2=T2.getModel("_templPrivGlobal");U2.setProperty("/generic/draftIndicatorState",R2);});}}}}function v1(){var e=T.oComponentUtils.getTemplatePrivateModel();var i=e.getProperty("/objectPage/aPasteAttachedTables");var j=i.length;var k;var x;while(j>=0){k=i[j];x=J.byId(k+"::Table");if(x&&x.isA("sap.ui.comp.smarttable.SmartTable")&&x.hasListeners("paste")){x.detachBeforePaste(t1);x.detachPaste(u1);i.splice(j,1);}j-=1;}}function w1(e){T.oCommonUtils.executeIfControlReady(s1,"delete");}function x1(e,i){var j,k;if(e){k=e.context||e;if(T.oServices.oDraftController.getDraftContext().hasDraft(k)){T.oServices.oViewDependencyHelper.setRootPageToDirty();j=k.context||k;}}if(j){T.oServices.oApplication.invalidatePaginatorInfo();T.oServices.oApplication.switchToDraft(j);}else{var x=T.oComponentUtils.getTemplatePrivateModel();x.setProperty("/objectPage/displayMode",2);l2(P);}V.setEditable(true);}var y1;function z1(e){e=!!e&&typeof e==="boolean";T.oServices.oCRUDManager.editEntity(e).then(function(i){if(i.draftAdministrativeData){y1(i.draftAdministrativeData.CreatedByUserDescription||i.draftAdministrativeData.CreatedByUser);}else{x1(i.context,false);}});}y1=function(e){var i;T.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();z1(true);},onCancel:function(){i.close();}},"Dialog").then(function(j){i=j;var k=i.getModel("Dialog");var x=T.oCommonUtils.getText("DRAFT_LOCK_EXPIRED",[e]);k.setProperty("/unsavedChangesQuestion",x);i.open();});};function A1(){var j="{\"SelectionVariantID\":\"\"}";var k=J.getOwnerComponent();var H2=k.getEntitySet();var I2=k.getModel();var J2=I2.getMetaModel();var K2=J2.getODataEntitySet(H2);var L2=J2.getODataEntityType(K2.entityType);var M2=L2.property;var N2=[];for(var x in M2){var O2=M2[x]["com.sap.vocabularies.Common.v1.FieldControl"]&&M2[x]["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(O2&&N2.indexOf(O2)<0){N2.push(O2);}}var P2=J.getView().getBindingContext();var Q2=P2.getObject();var R2=new a();for(var i in M2){var S2=M2[i].type;var T2=M2[i].name;var U2=Q2[M2[i].name];if(N2.indexOf(T2)>-1){continue;}if(T2&&(U2||S2==="Edm.Boolean")){if(S2==="Edm.Time"&&U2.ms!==undefined){U2=U2.ms;}if(typeof U2!=="string"){try{U2=U2.toString();}catch(e){U2=U2+"";}}R2.addParameter(T2,U2);}}j=R2.toJSONString();return j;}function B1(e,D1){var i=true;var j=D1.getModel();D1=D1 instanceof R?D1.getParent():D1;var k=T.oCommonUtils.getDeleteRestrictions(D1);var x=k&&k.Deletable&&k.Deletable.Path;if(x){i=j.getProperty(x,e);}return i;}var C1;var D1;function E1(e,j){C1=e;D1=j instanceof R?j.getParent():j;var k=[];q1=function(x){var H2=T.oServices.oApplication.getBusyHelper();var I2=x.getSource().getParent();var J2=T.oCommonUtils.getSelectedContexts(D1);k=[];var K2;var L2;var M2=J.getView().getModel().getObject(J2[0].getPath());for(var i=0;i<J2.length;i++){if(B1(J2[i],D1)){k.push(J2[i].getPath());}}var N2=T.oServices.oCRUDManager.deleteEntities(k);H2.setBusy(N2);T.oServices.oApplicationController.executeSideEffects(D1.getBindingContext(),[],[D1.getTableBindingPath()]);var O2=C1.getParent().getParent().getId();N2.then(function(Q2){T.oCommonUtils.refreshSmartTable(D1);if(M2.IsActiveEntity===false){L2=0;}else{L2=Q2.length;}K2=k.length-L2;var R2="";if(K2>0){if(T.oCommonUtils.isUiTable(D1.getTable())){var S2=D1.getTable().getPlugin("sap.ui.table.plugins.SelectionPlugin");if(S2){S2.clearSelection();}}if(K2>1){R2=T.oCommonUtils.getContextText("DELETE_SUCCESS_PLURAL_WITH_COUNT",D1.getId(),null,[K2]);}else{if(L2>0){R2=T.oCommonUtils.getContextText("DELETE_SUCCESS_WITH_COUNT",D1.getId(),null,[K2]);}else{R2=T.oCommonUtils.getContextText("ITEM_DELETED",D1.getId());}}}if(L2>0){if(L2>1){R2+=R2&&R2+"\n";R2+=T.oCommonUtils.getContextText("DELETE_ERROR_PLURAL_WITH_COUNT",D1.getId(),null,[L2]);}else{if(K2>0){R2+="\n";R2+=T.oCommonUtils.getContextText("DELETE_ERROR_WITH_COUNT",D1.getId(),null,[L2]);}else{R2+=T.oCommonUtils.getContextText("DELETE_ERROR",D1.getId());}}}if(R2){if(L2>0){M.error(R2);}else{h.showSuccessMessageIfRequired(R2,T.oServices);}}});var P2={deleteEntitiesPromise:N2,sUiElementId:O2,aContexts:J2};T.oComponentUtils.fire(J,"AfterLineItemDelete",P2);I2.close();};return T.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(i){var x=i.getSource().getParent();x.close();},onDelete:function(i){q1(i);}},"delete");}function F1(e){var D1=T.oCommonUtils.getOwnerControl(e);if(!T.oCommonUtils.isSmartTable(D1)){D1=D1.getParent();}var j=T.oCommonUtils.getSelectedContexts(D1);if(j.length===0){M.error(T.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:T.oCommonUtils.getContentDensityClass()});return;}var k=[];var x=[];for(var i=0;i<j.length;i++){if(B1(j[i],D1)){k.push(j[i].getPath());}else{x.push(j[i]);}}var H2={};if(j.length>1){H2.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[j.length]);H2.text=T.oCommonUtils.getContextText("DELETE_SELECTED_ITEMS",D1.getId());}else{H2.title=T.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");H2.text=T.oCommonEventHandlers.getSelectedItemContextForDeleteMessage(D1,j[0],true);}if(x.length>0){H2.undeletableText=T.oCommonUtils.getContextText("DELETE_UNDELETABLE_ITEMS",D1.getId(),null,[x.length,j.length]);}var I2={sUiElementId:e.getParent().getParent().getId(),aContexts:j};var J2=Promise.resolve(J.beforeLineItemDeleteExtension(I2));J2.then(function(K2){q(H2,K2);E1(e,D1).then(function(L2){if(!x.length){H2.undeletableText=undefined;}var M2=L2.getModel("delete");M2.setData(H2);L2.open();});},Function.prototype);}function G1(e){var i=n.getStableId({type:"ObjectPageAction",subType:"Delete",sFacet:e});T.oCommonUtils.executeIfControlReady(F1,i);}function H1(){var i=J.byId("imageDialog");var e=i?Promise.resolve(i):T.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");e.then(function(j){i=j;});return e;}function I1(){var e=T.oComponentUtils.getTemplatePrivateModel();e.setProperty("/objectPage/isHeaderExpanded",true);var i=J.getView().byId("template::ObjectPage::ObjectPageHeader");i.attachStateChange(function(j){var k=j.getParameter("isExpanded");e.setProperty("/objectPage/isHeaderExpanded",k);});}function J1(){var e;var j=T.oComponentUtils.getTemplatePrivateModel();var k=function(i){return function(x){var H2=x.getSource();var I2=H2.getExternalValue();j.setProperty("/objectPage/headerInfo/"+i,I2);if(i==="objectTitle"){T.oComponentUtils.setText(I2);if(!I2){var J2=T.oComponentUtils.getHeaderDataAvailablePromise();J2.then(function(K2){I2=H2.getExternalValue();if(I2){return;}var L2=J.getView();var M2=K2.getObject();var N2=L2.getModel("ui");var O2=N2.getProperty("/createMode");if(O2&&M2&&(M2.IsActiveEntity===undefined||M2.IsActiveEntity===false||M2.HasActiveEntity===false)){e=e||T.oCommonUtils.getText("NEW_OBJECT");j.setProperty("/objectPage/headerInfo/objectTitle",e);T.oComponentUtils.setText(e);}});}}};};P.getCustomData().forEach(function(x){var H2=x.getKey();if(H2==="objectTitle"||H2==="objectSubtitle"){var I2=x.getBinding("value");var J2=!I2&&x.getBindingInfo("value");if(!I2&&!J2){j.setProperty("/objectPage/headerInfo/"+H2,x.getValue());return;}var K2=k(H2);if(I2){I2.attachChange(K2);B(I2,"string");}else{J2.events={change:K2};for(var i=0;i<J2.parts.length;i++){J2.parts[i].targetType="string";}}}});}function K1(e){e.preventDefault();var i=T.oCommonUtils.getControlInformation(e,null,true);if(i){T.oServices.oDataLossHandler.performIfNoDataLoss(i.navigate,Function.prototype);}}function L1(e){return!!(e&&T.oCommonUtils.getPositionableControlId(e));}function M1(e){var j="";for(var i=0;i<e.length;i++){if(L1([e[i]])){var k=o.registry.get(e[i]);return N1(k);}}if(J&&J.getOwnerComponent()&&J.getOwnerComponent().getModel("i18n")){j=J.getOwnerComponent().getModel("i18n").getResourceBundle().getText("GENERIC_MESSAGE_GROUP_NAME");}return j;}function N1(e){if(!e){return"";}if(e instanceof sap.uxap.ObjectPageSection){return e.getTitle();}else{return N1(e.getParent());}}function O1(e){var j=P.getSections();for(var i=0;i<j.length;i++){if(j[i].getTitle()===e){return i+1;}}return 9999999;}var P1=new sap.ui.model.Sorter("msg>");function Q1(e){switch(e){case p.Error:return 1;case p.Warning:return 2;case p.Success:return 3;case p.Information:return 4;case p.None:return 5;default:return 6;}}P1.fnCompare=function(e,i){var j=O1(M1(e.controlIds))*w+Q1(e.type);var k=O1(M1(i.controlIds))*w+Q1(i.type);if(j<k){return-1;}if(j>k){return 1;}return 0;};function R1(e,i){L.info("Set binding context to "+e,"Subsection: "+i.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");i.setBindingContext(e);}function S1(e,i,j,k){if(i){if(k.fnLazyLoadResolve&&(f1||!e)){k.fnLazyLoadResolve();delete k.fnLazyLoadResolve;}return;}var x=[e1];if(!k.bInitiallyVisible){x.push(new Promise(function(H2){k.fnLazyLoadResolve=H2;}));}if(k.bWaitForStateApplied){x.push(c1);}R1(null,j);Promise.all(x).then(function(){R1(undefined,j);var H2=j.getId();L.info("Start refreshing of Subsection: "+H2,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");k.refresh(null,true,true);L.info("End refreshing of Subsection: "+H2,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");});}var T1={lazyLoading:S1.bind(null,false),lazyLoadingAfterHeader:S1.bind(null,true),reuseComponent:function(i,e){if(f1||!i){var j=e.getBlocks()[0];T.oComponentUtils.onVisibilityChangeOfReuseComponent(i,j);}}};function U1(e,i,j,k){if(k instanceof D){k=k.getMainContent()[0];}else if(!k.getContent){return;}k.getContent().forEach(function(x){if(T.oCommonUtils.isSmartTable(x)){if(i||e[x.getEntitySet()]){if(x.isInitialised()){T.oCommonUtils.refreshSmartTable(x,null,j);}else{x.attachInitialise(T.oCommonUtils.refreshSmartTable.bind(null,x,null,j));}if(!i){T.oServices.oApplicationController.executeSideEffects(J.getOwnerComponent().getBindingContext(),[],[x.getTableBindingPath()]);}}}});}function V1(e){return T.oCommonUtils.getControlInformation(e);}function W1(e){_.push(e);T.oCommonUtils.getControlInformation(e,function(i,j){var k=e.getBlocks();Q.initSideContentInfoObject(k[0]);var x=k.concat(e.getMoreBlocks());i.refresh=function(J2,K2,L2){var M2=U1.bind(null,J2,K2,L2);x.forEach(M2);};var H2=T.oCommonUtils.getElementCustomData(e).strategyForVisibilityChange;var I2=T1[H2];i.strategyForVisibilityChange=I2||Function.prototype;if(I2){j.push("subSectionListeningToVisibilityChange");}});}function X1(e){var i,j;i=e?e.getParameter("section"):undefined;j=i?i.getId():P.getSelectedSection();if(j!==$){L.info("Selected Section: "+j,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");}if(!i&&j){P.getSections().some(function(k){if(k.getId()===$){i=k;return true;}return false;});}return{sectionId:j,section:i};}function Y1(e){var j=0,k;$=e.sectionId;k=e.section;if(k){var x=k.getSelectedSubSection();if(x!==b1){L.info("Selected Subsection: "+b1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");b1=x;_.some(function(L2,M2){if(L2.getId()===b1){j=M2;return true;}return false;});a1=[];}}if(a1.length===0){var H2=0;var I2=2;var J2=P.getUseIconTabBar();if(J2&&k){var K2=k.getSubSections();I2=K2.length>I2?I2:K2.length;}for(var i=j;H2<I2&&i<_.length;i++){var L2=_[i];if(L2.getVisible()){H2++;a1.push(L2.getId());}}}_.forEach(function(M2){V1(M2).bInitiallyVisible=a1.some(function(N2){return N2===M2.getId();});});}function Z1(i,e,j){e=e||V1(j);e.strategyForVisibilityChange(i,j,e);}function $1(i){T.oCommonUtils.executeForAllInformationObjects("subSectionListeningToVisibilityChange",Z1.bind(null,i));}function _1(e){var j=[];for(var i=0;i<e.length;i++){if(e[i].getVisible()){j.push(e[i]);}}return j;}function a2(e){var i=e?e.getSubSections():P.getSections();var j=_1(i);return j.length===1&&!!(e||a2(j[0]));}function b2(D1,e){var i=D1.getParent();var j="sapSmartTemplatesObjectPageSubSectionGridExpand",k="sapUxAPObjectPageSubSectionFitContainer";while(i){if(i.isA("sap.ui.layout.Grid")){e?i.addStyleClass(j):i.removeStyleClass(j);}else if(i.isA("sap.uxap.ObjectPageSubSection")){e?i.addStyleClass(k):i.removeStyleClass(k);D1.setFitContainer(e);return null;}else{L.warning("Unexpected parent "+i.toString()+" in fnHandleUiTableExpand method","ControllerImplementation");}i=i.getParent();}}function c2(e,i){var j="sapUiSizeCompact",k="sapUiSizeCondensed",x;x=document.body;if(!e.bCondensedTableLayout||!(e.bSetFitContainer||i.hasStyleClass("sapUiSizeCondensed"))){return null;}else if(e.bSetFitContainer&&x.classList.contains(j)){i.addStyleClass(k);}else{i.removeStyleClass(k);}}function d2(D1,e,i){if(e.isA("sap.m.Table")){e.setGrowingThreshold(i.growingThreshold);e.setGrowingScrollToLoad(i.bGrowingScrollOnLoad);}else if(e.isA("sap.ui.table.Table")){b2(D1,i.bSetFitContainer);c2(i,e);}}function e2(D1,e,i){var j={growingThreshold:10,bSetFitContainer:false,bGrowingScrollOnLoad:false};var k=J.getOwnerComponent().mProperties;j.bCondensedTableLayout=k.condensedTableLayout;if(k&&k.sections){var x=k.sections[i];if(x&&x.hasOwnProperty("condensedTableLayout")){j.bCondensedTableLayout=x.condensedTableLayout;}}var H2;if(P.getUseIconTabBar()){H2=e.getParent();while(H2&&H2.sParentAggregationName!=="sections"){H2=H2.getParent();}}if(a2(H2)){j.growingThreshold=v;j.bGrowingScrollOnLoad=true;j.bSetFitContainer=true;}d2(D1,e,j);}function f2(e){var j=P.getSections().filter(function(K2){return(K2.getTitle()==="Header"||!K2._bInternalVisible)?false:true;});var k;for(var i=0;i<j.length;i++){var x=j[i];var H2=x.getId();var I2=P.getSelectedSection();if(H2===I2){k=(e)?j[(i+1===j.length)?0:i+1]:j[(i===0)?j.length-1:i-1];var $=k.getId();P.setSelectedSection($);var J2={section:J.byId($),sectionId:$};g2(J2);break;}}}function g2(e){Y1(e);N.stateChanged();}function h2(e){var i=X1(e);g2(i);}function i2(e,i,j,k,x){var H2=A.createP13NColumnKey(x);var I2=A.getBindingForHiddenPath(x);if(I2==="{= !${} }"){e.push(H2);return false;}if(typeof(I2)==="string"){var J2=I2.match(G)&&I2.match(G)[0];if(J2&&J2.indexOf("/")>0&&k.navigationProperty){var K2=J.getOwnerComponent().getEntitySet();var L2=J2.split("/",1)[0];if(j.getODataAssociationSetEnd(k,L2).entitySet===K2){i[H2]=J2.split("/").slice(1).join("/");return true;}}}else if(!I2){e.push(H2);}return false;}function j2(P){var e=P.getModel("ui");var i=T.oComponentUtils.getTemplatePrivateModel();var j=i.getProperty("/objectPage/displayMode");var k=e.getProperty("/createMode")||j===4;var x=e.getProperty("/editable")||j===2;var H2;if(k){H2="Create";}else if(x){H2="Edit";}else{H2="Display";}return H2;}function k2(P,e){if(e==="Display"){var j=P.getHeaderTitle();var k=j.getActions();if(k&&k.length){for(var i=0;i<k.length;i++){if(k[i].getVisible&&k[i].getVisible()&&k[i].getEnabled&&k[i].getEnabled()){return k[i];}}}}else{var x=P.getSelectedSection();if(X===true){P.setSelectedSection(null);return s(P.getDomRef());}var H2;var I2=function(L2){var M2=L2.getDomRef();P.setSelectedSection(L2);H2=s(M2);if(H2&&H2.type!=="checkbox"){return H2;}return u(M2).firstFocusableDomRef();};var J2=P.getSections();var K2;for(var i=0;i<J2.length;i++){if(J2[i].getVisible()&&((J2[i].getId()===x)||K2)){K2=J2[i+1]?J2[i+1].getId():undefined;H2=I2(J2[i]);if(H2){break;}}}return H2;}}function l2(P){var e=J.getOwnerComponent().getModel("_templPrivGlobal");var Z=e.getProperty("/generic/FCL/FCLActionButton");if(!Z){var i=j2(P);if(document.readyState=='complete'){setTimeout(function(){var j=k2(P,i);if(j){j.focus();}},0);}}}function m2(D1,e,j,k,x,H2){var I2=[];var J2=Object.create(null);var K2=false;for(var i=0;i<H2.length;i++){var L2=H2[i];K2=i2(I2,J2,k,x,L2)||K2;}if(K2){e.dynamicHideInfos={staticHiddenColumns:I2,columnKeyToHiddenPath:J2};j.push("smartTableWithDynamicColumnHide");}if(I2.length){D1.deactivateColumns(I2);}}function n2(e){return e instanceof O?e:e.getParent&&n2(e.getParent());}function o2(e,j,D1){j.push("smartTable");e.subSection=n2(D1);if(D1.getUseVariantManagement()){j.push("smartControlWithVariantManagement");V1(e.subSection).bWaitForStateApplied=true;e.afterVariantInitialisePromise=new Promise(function(K2){e.afterVariantInitialiseResolve=K2;});}D1=T.oCommonUtils.isMTable(D1)?D1.getParent():D1;var k=J.getOwnerComponent().getModel().getMetaModel();var x=k.getODataEntitySet(D1.getEntitySet());var H2=k.getODataEntityType(x.entityType);var I2=H2["com.sap.vocabularies.UI.v1.LineItem"];var J2=D1.getCustomData();for(var i=0;i<J2.length;i++){if(J2[i].getKey()==="lineItemQualifier"){I2=H2["com.sap.vocabularies.UI.v1.LineItem#"+J2[i].getValue()];break;}}m2(D1,e,j,k,H2,I2||[]);}function p2(D1){return T.oCommonUtils.getControlInformation(D1,o2);}function q2(e){var i;var j=e.getSource();if(T.oCommonUtils.isSmartTable(j)){i=p2(j);}else if(T.oCommonUtils.isSmartChart(j)){i=s2(j);}if(!d1&&!i.afterVariantInitalisedResolve&&!i.bApplyingVariantFromState){N.stateChanged();}}function r2(e,i,j){i.push("smartChart");if(j&&j.getUseVariantManagement()){i.push("smartControlWithVariantManagement");e.afterVariantInitialisePromise=new Promise(function(k){e.afterVariantInitialiseResolve=k;});}}function s2(e){return T.oCommonUtils.getControlInformation(e,r2);}function t2(e,i,j){i.push("searchField");var k=T.oCommonUtils.isMTable(j.getParent().getParent())?j.getParent().getParent().getParent():j.getParent().getParent();e.table=k;var x=p2(k);x.searchField=j;}function u2(e){return T.oCommonUtils.getControlInformation(e,t2);}function v2(e){u2(e);}function w2(e){var i=u2(e);i.searchString=e.getSource().getValue();i.table.rebindTable();}function x2(e,i){i.setValue("");if(e.searchString){e.searchString="";e.table.rebindTable();}}function y2(){T.oCommonUtils.executeForAllInformationObjects("searchField",x2);}function z2(e,i){var D1=T.oCommonUtils.getOwnerControl(i);D1=T.oCommonUtils.isMTable(D1)?D1.getParent():D1;var j=I(D1);if(!j){X=false;Y=true;}if(!i.data("CrossNavigation")&&j){T.oCommonEventHandlers.addEntry(i,true);return;}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.addEntry(i,false);},Function.prototype,N.state);}function A2(e){var i=n.getStableId({type:"ObjectPageAction",subType:"Create",sFacet:e});T.oCommonUtils.executeIfControlReady(z2.bind(null,undefined),i);}function B2(){return true;}function C2(D1){var e=D1.getId();var i="";var j={search:false,filter:false};var k=D1.fetchVariant();if(k&&k.filter&&k.filter.filterItems.length>0){j.filter=true;}var x=D1.getToolbar().getContent().filter(function(H2){return H2.sId===D1.getToolbar().getId()+'::SearchField';});if(x.length>0&&x[0].getValue().trim()!==""){j.search=true;}if(j.search||j.filter){i=T.oCommonUtils.getContextText("NOITEMS_SMARTTABLE_WITH_FILTER",e);}else{i=T.oCommonUtils.getContextText("NOITEMS_SMARTTABLE",e);}D1.setNoData(i);}function D2(e){var i=[];if(e.fetchVariant()&&e.fetchVariant().filter&&e.fetchVariant().filter.filterItems){i=e.fetchVariant().filter.filterItems;}var j=e.getId();var k="";var x={search:false,filter:false};if(i&&i.length){x.filter=true;}var H2=e.getToolbar().getContent().filter(function(I2){return I2.sId===e.getToolbar().getId()+'::SearchField';});if(H2.length>0&&H2[0].getValue().trim()!==""){x.search=true;}if(x.search||x.filter){k=T.oCommonUtils.getContextText("NOITEMS_SMARTCHART_WITH_FILTER",j);}else{k=T.oCommonUtils.getContextText("NOITEMS_SMARTCHART",j);}e.getChartAsync().then(function(I2){I2.setCustomMessages({NO_DATA:k});});}V.refreshFacets=function(e){var i=function(j){var k=V1(j);k.refresh(e,false);};P.getSections().forEach(function(j){j.getSubSections().forEach(i);});};V.onComponentActivate=N.onComponentActivate;V.getCurrentState=function(){var e=Object.create(null);if($){e.section={data:$,lifecycle:{permanent:true,pagination:true}};}if(b1){e.subSection={data:b1,lifecycle:{permanent:true,pagination:true}};}var i={};T.oCommonUtils.executeForAllInformationObjects("smartControlWithVariantManagement",function(I2,J2){i[J2.getId()]=J2.getCurrentVariantId();});if(!r(i)){e.smartControlVariants={data:i,lifecycle:{session:true,permanent:true,page:false,pagination:false}};}e.sideContent=Q.getCurrentState();e.multipleViews=W.getCurrentState();var j=Object.create(null);J.provideCustomStateExtension(j);for(var k in j){e["$custom$"+k]=j[k];}var x=true;var H2=function(I2,J2){if(!(I2 instanceof C)){throw new Error("State must always be set with respect to a ControllerExtension");}if(!x){throw new Error("State must always be provided synchronously");}var K2=I2.getMetadata().getNamespace();if(J2){for(var L2 in J2){e["$extension$"+K2+"$"+L2]=J2[L2];}}};J.templateBaseExtension.provideExtensionStateData(H2);x=false;return e;};function E2(){f1=true;L.info("Call of _triggerVisibleSubSectionsEvents","","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation (fnLayoutFinished)");P._triggerVisibleSubSectionsEvents();}function F2(){z(P);E2();}V.applyState=function(y,e){var k=T.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();k.then(function(){var H2=null;var I2=Object.create(null);var J2=Object.create(null);for(var K2 in y){if(K2.indexOf("$custom$")===0){I2[K2.substring(8)]=y[K2];}else if(K2.indexOf("$extension$")===0){var L2=K2.substring(11,K2.indexOf("$",11));var M2=J2[L2];if(!M2){M2=Object.create(null);J2[L2]=M2;}var N2=K2.substring(K2.indexOf("$",11)+1,K2.length);M2[N2]=y[K2];}}J.applyCustomStateExtension(I2,e);var O2=true;var P2=function(W2){if(!(W2 instanceof C)){throw new Error("State must always be retrieved with respect to a ControllerExtension");}if(!O2){throw new Error("State must always be restored synchronously");}var L2=W2.getMetadata().getNamespace();return J2[L2];};J.templateBaseExtension.restoreExtensionStateData(P2,e);O2=false;var Q2=J.getOwnerComponent();var R2=Q2.getAppComponent().getObjectPageHeaderType();var S2=Q2.getModel("_templPrivGlobal");Z=S2.getProperty("/generic/FCL/FCLActionButton");if(Z===1){var T2=P.getHeaderTitle();var U2=(R2==="Dynamic"?T2.getNavigationActions():T2.getActions());if(U2&&U2.length){for(var i=0;i<U2.length;i++){if(U2[i].getId&&U2[i].getId().indexOf("template::FCLActionButtons")>0){var V2=U2[i].getItems();for(var j=0;j<V2.length;j++){if((V2[j].getId().toUpperCase().indexOf("FULLSCREEN")>0)&&V2[j].getVisible&&V2[j].getVisible()){H2=V2[j];}}}}}setTimeout(function(){S2.setProperty("/generic/FCL/FCLActionButton",0);Z=S2.getProperty("/generic/FCL/FCLActionButton");if(H2){H2.focus();}},0);}});Q.applyState(y.sideContent,e);W.applyState(y.multipleViews,e);T.oCommonUtils.executeForAllInformationObjects("smartControlWithVariantManagement",function(i,j){var H2;if(y.smartControlVariants&&y.smartControlVariants[j.getId()]!==undefined){H2=y.smartControlVariants[j.getId()];}else{if(T.oCommonUtils.isSmartTable(j)){H2=T.oCommonUtils.getSmartTableDefaultVariant(j);}else if(T.oCommonUtils.isSmartChart(j)){H2=T.oCommonUtils.getSmartChartDefaultVariant(j);}}i.afterVariantInitialisePromise.then(function(){if(j.getCurrentVariantId()!==H2||!e){i.bApplyingVariantFromState=true;j.setCurrentVariantId(H2);i.bApplyingVariantFromState=false;}});});if(e){if($!==(y.section||"")){N.stateChanged();}if(d1){d1();d1=null;}E2();return;}y2();if(y.section){$=y.section;L.info("Restoring Selected Section: "+$,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");P.setSelectedSection($);if(y.subSection){var x;_.some(function(i){if(i.getId()===y.subSection){x=i;return true;}return false;});if(x){x.getParent().setSelectedSubSection(x);}b1=y.subSection;L.info("Restoring Selected Subsection: "+b1,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");}E2();}else{Promise.all([k,T.oComponentUtils.getNavigationFinishedPromise()]).then(F2);$="";}if(d1){d1();d1=null;}};V.beforeRebind=function(e){e1=e;if(!d1){c1=new Promise(function(i){d1=i;});}$1(false);};V.afterRebind=function(){L.info("Call of _triggerVisibleSubSectionsEvents","","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation (afterRebind)");f1=false;P._triggerVisibleSubSectionsEvents();};V.applyHeaderContextToSmartTablesDynamicColumnHide=function(e){var i=e.getModel();var j=function(k,x,D1){var H2=x.dynamicHideInfos.staticHiddenColumns.slice();var I2=k&&j.bind(null,false,x,D1);for(var J2 in x.dynamicHideInfos.columnKeyToHiddenPath){var K2=x.dynamicHideInfos.columnKeyToHiddenPath[J2];if(e.getProperty(K2)){H2.push(J2);}if(I2){var L2=i.bindProperty(K2,e);L2.attachChange(I2);}}D1.deactivateColumns(H2);};T.oCommonUtils.executeForAllInformationObjects("smartTableWithDynamicColumnHide",j.bind(null,true));};var z1=t.testable(z1,"editEntity");var B1=t.testable(B1,"isEntryDeletable");var h1=t.testable(h1,"onActivateImpl");var i1=t.testable(i1,"onSaveImpl");t.testable(function(){return c1;},"getStateAppliedPromise");var G2={onInit:function(){P=J.byId("objectPage");var e=J.getOwnerComponent();c1=new Promise(function(O2){d1=O2;});var i=P.getSections();for(var k=0;k<i.length;k++){var j=i[k];var _=j.getSubSections();_.forEach(W1);}var x=X1();Y1(x);var H2=n1();var I2=e.getAppComponent();var J2=I2.getObjectPageHeaderType()==="Dynamic";V.aBreadCrumbs=H2&&(J2?H2.getBreadcrumbs().getLinks():H2.getBreadCrumbsLinks());if(J2){I1();}N.onInit(null,$1.bind(null,true),P1,M1);J1();T.oCommonUtils.executeGlobalSideEffect();P.attachEvent("subSectionEnteredViewPort",function(O2){var P2=O2.getParameter("subSection");L.info("Viewport entered ","Subsection: "+P2.getId(),"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");Z1(true,null,P2);});W=new g(J,T,N.stateChanged);y.oMultipleViewsHandler=W;var K2=T.oComponentUtils.getTemplatePrivateModel();K2.setProperty("/objectPage/aPasteAttachedTables",[]);T.oComponentUtils.attach(J,"PageDataLoaded",function(O2){if(P&&!Z){var P2=j2(P);if(P2==="Create"&&Y!==true){X=true;}else if((T.oComponentUtils.isDraftEnabled()&&P2==="Create"&&Y===true)||(!T.oComponentUtils.isDraftEnabled()&&P2==="Display"&&Y===true)){Y=false;}l2(P);}});var L2=T.oComponentUtils.getParameterModelForTemplating().getObject("/templateSpecific/sections");for(var M2 in L2){switch(L2[M2].annotation){case"com.sap.vocabularies.UI.v1.LineItem":var D1=J.byId(n.getStableId({type:"ObjectPageTable",subType:"SmartTable",sFacet:L2[M2].facetId}));if(D1){p2(D1);}break;case"com.sap.vocabularies.UI.v1.Chart":var N2=J.byId(L2[M2].facetId+"::Chart");if(N2){s2(N2);}break;}}},handlers:{onEditAndActiveToggle:function(e,i){T.oServices.oApplication.performAfterSideEffectExecution(function(){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getBindingContext();var x=T.oServices.oApplication.getDraftSiblingPromise(k);j.setBusy(x.then(function(H2){if(i){L.info("Navigating to draft entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");x1(H2,true);}else{L.info("Navigating to active entity","sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");T.oServices.oApplication.navigateToSubContext(H2,true,1);}f(':focus').blur();}));});},onAfterVariantInitialise:function(e){var i=e.getSource();var j;if(T.oCommonUtils.isSmartTable(i)){j=p2(i);}else if(T.oCommonUtils.isSmartChart(i)){j=s2(i);}if(j.afterVariantInitialiseResolve){j.afterVariantInitialiseResolve();delete j.afterVariantInitialiseResolve;}},onAfterVariantSave:function(e){q2(e);},onAfterVariantApply:function(e){q2(e);},addEntry:A2,submitChangesForSmartMultiInput:function(){if(T.oComponentUtils.isDraftEnabled()){T.oCommonEventHandlers.submitChangesForSmartMultiInput();}},contextEditableChanged:function(e){var i=e.getSource();var j=i.getBindingInfo('editable');if(j&&j.binding&&j.binding.getValue&&!j.binding.getValue()){i.setEditable(false);}},deleteEntry:function(e){T.oCommonEventHandlers.deleteEntry(e);},deleteEntries:G1,onSelectionChange:function(e){T.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onMultiSelectionChange:function(e){T.oCommonEventHandlers.onMultiSelectionChange(e);},onCancel:function(e){var i=e.getSource();var j=N.state.onCancel(i);j.then(function(){v1();if(!T.oComponentUtils.isDraftEnabled()){l2(P);}});},onContactDetails:function(e){T.oCommonEventHandlers.onContactDetails(e);},onSmartFieldInitialise:function(e){var i=this.getView().getId();T.oCommonEventHandlers.onSmartFieldInitialise(e,i);},onPressDraftInfo:function(e){var i=J.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));T.oCommonUtils.showDraftPopover(i,j);},onPressDraftInfoObjectPageDynamicHeaderTitle:function(e){var i=J.getView().getBindingContext();var j=J.byId("template::ObjectPage::ObjectMarkerObjectPageDynamicHeaderTitle");T.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:function(e){T.oCommonUtils.executeIfControlReady(o1,"template::Share");},onRelatedApps:function(e){var x,H2,I2,J2,K2,L2,M2;var N2,O2,P2,Q2,R2;x=e.getSource();P2=sap.ushell&&sap.ushell.Container;H2=P2&&P2.getService("URLParsing");I2=H2.parseShellHash(document.location.hash);Q2=I2.semanticObject;R2=I2.action;J2=J.getView&&J.getView().getBindingContext();var S2=J.getOwnerComponent().getModel().getMetaModel();var T2=J2.getObject();var U2=T2.__metadata.type;var V2=S2.getODataEntityType(U2);var W2=V2["com.sap.vocabularies.Common.v1.SemanticKey"];var X2={};if(W2&&W2.length>0){for(var j=0;j<W2.length;j++){var Y2=W2[j].PropertyPath;if(!X2[Y2]){X2[Y2]=T2[Y2];}}}else{for(var k in V2.key.propertyRef){var Z2=V2.key.propertyRef[k].name;if(!X2[Z2]){X2[Z2]=T2[Z2];}}}K2=J.getOwnerComponent().getAppComponent();L2=P2&&P2.getService("CrossApplicationNavigation");M2=L2.getLinks({semanticObject:Q2,params:X2,ui5Component:K2});p1().then(function($2){N2=$2;O2=N2.getModel("buttons");O2.setProperty("/buttons",[]);N2.openBy(x);M2.done(function(_2){var a3=[];var b3=V2["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"];var c3=[];if(b3){for(var i=0;i<b3.length;i++){c3.push(b3[i].String);}}for(var i=0;i<V2.property.length;i++){if(V2.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){var d3=V2.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"].length;for(var j=0;j<d3;j++){c3.push(V2.property[i]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"][j].String);}}}_2.sort(function(h3,i3){if(h3.text<i3.text){return-1;}if(h3.text>i3.text){return 1;}return 0;});for(var i=0;i<_2.length;i++){var e3=_2[i];var f3=e3.intent;var g3=f3.split("-")[1].split("?")[0];if(g3!==R2&&c3.indexOf(g3)==-1){a3.push({enabled:true,text:e3.text,link:e3,param:X2});}}if(a3.length===0){a3.push({enabled:false,text:T.oCommonUtils.getText("NO_RELATED_APPS")});}O2.setProperty("/buttons",a3);});});},onSemanticObjectLinkPopoverLinkPressed:function(e){T.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,N.state);},onEdit:function(e){var j=J.byId("edit");var P=J.byId("objectPage");var k=P.getSelectedSection();var x=P.getSections()||[];for(var i=0;i<x.length;i++){if(x[i].getVisible()){if(x[i].getId()===k){X=true;}else{X=false;}break;}}if(j.data("CrossNavigation")){T.oCommonEventHandlers.onEditNavigateIntent(j);return;}T.oCommonUtils.executeIfControlReady(z1,"edit");},onSave:l1,onSaveAndContinueEdit:k1,onSmartFieldUrlPressed:function(e){T.oCommonEventHandlers.onSmartFieldUrlPressed(e,N.state);},onBreadCrumbUrlPressed:K1,onDelete:w1,onCallActionFromToolBar:function(e){T.oCommonEventHandlers.onCallActionFromToolBar(e,N.state);},onCallAction:function(e,i,j){T.oServices.oApplication.performAfterSideEffectExecution(function(){var k=J.getView().getBindingContext();if(k){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var x=J.getOwnerComponent();var H2=x.getEntitySet();var I2={functionImportPath:e,contexts:[k],sourceControl:"",label:i,operationGrouping:j};T.oServices.oCRUDManager.callAction(I2).then(function(J2){var K2=J2&&J2[0];if(K2&&K2.response&&K2.response.context&&(!K2.actionContext||K2.actionContext&&K2.response.context.getPath()!==K2.actionContext.getPath())){T.oServices.oViewDependencyHelper.setParentToDirty(x,H2,1);}});},Function.prototype,N.state,"Proceed");}},true);},onDataFieldForIntentBasedNavigation:function(e){e=m({},e);T.oServices.oApplication.performAfterSideEffectExecution(function(){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,N.state);});},true);},onDataFieldWithIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,N.state);},onDataFieldWithNavigationPath:function(e){T.oCommonEventHandlers.onDataFieldWithNavigationPath(e);},onChartInit:function(e){var i=e.getSource();s2(i);i.getChartAsync().then(function(j){var k=J._templateEventHandlers.onSelectionChange;j.attachSelectData(k).attachDeselectData(k);T.oCommonUtils.checkToolbarIntentsSupported(i);});},onDataRequested:function(i){L.info("Data requested","SmartTable: "+i,"sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation");W.onDataRequested(i);},onDataReceived:function(e){T.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){var D1=e.getSource();e.mParameters.bindingParams.events["dataReceived"]=C2.bind(null,D1);D1.setNoData(T.oCommonUtils.getText("WAITING_SMARTTABLE"));var i=g1(e);var j=p2(D1);var k=j.searchField;if(k){var x=T.oCommonUtils.getControlInformation(k);if(x.searchString){i.parameters.custom={search:x.searchString};}}T.oCommonEventHandlers.onBeforeRebindTable(e,{ensureExtensionFields:J.templateBaseExtension.ensureFieldsForSelect,addExtensionFilters:J.templateBaseExtension.addFilters,isFieldControlRequired:true});J.onBeforeRebindTableExtension(e);W.onRebindContentControl(D1.getId(),i);m1(e);if(T.oCommonUtils.isAnalyticalTable(D1.getTable())){i.parameters.entitySet=D1.getEntitySet();}},onListNavigate:function(e){T.oCommonEventHandlers.onListNavigate(e,N.state);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var j=A1();T.oCommonUtils.semanticObjectLinkNavigation(i,j,J);},Function.prototype,N.state,Function.prototype);},onBeforeSemanticObjectLinkNavigationCallback:function(){return new Promise(function(e){T.oServices.oDataLossHandler.performIfNoDataLoss(function(){e(true);},function(){e(false);});});},onSemanticObjectLinkNavigationPressed:function(e){var i=e.getParameters();var C1=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(C1,i);},onSemanticObjectLinkNavigationTargetObtained:function(e){var i=e.getParameters();var C1=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(C1,i,N.state);},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var i,C1;i=e.getParameters();C1=e.getSource();C1=C1.getParent().getParent().getParent().getParent();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(C1,i,N.state);},onHeaderImagePress:function(e){if(e.getSource().getSrc()===""){return;}var i=e.getSource().getId();var j=e.getSource().getSrc();H1().then(function(k){k.addAriaLabelledBy(i);var x=k.getModel("headerImage");x.setProperty("/src",j);if(sap.ui.Device.system.phone){k.setProperty("stretch",true);}k.open();});},sectionChange:h2,onSwitchTabs:f2,onInlineDataFieldForAction:function(e){T.oCommonEventHandlers.onInlineDataFieldForAction(e,N.state);},onInlineDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),N.state);},onDeterminingDataFieldForAction:function(e){T.oCommonEventHandlers.onDeterminingDataFieldForAction(e);},onBeforeRebindChart:function(e){g1(e);var i=e.getSource();D2(i);i.getChartAsync().then(function(k){i.oModels=k.oPropagatedProperties.oModels;});var j={ensureExtensionFields:Function.prototype,addExtensionFilters:J.templateBaseExtension.addFilters,isFieldControlRequired:true};T.oCommonUtils.onBeforeRebindTableOrChart(e,j);},onToggleDynamicSideContent:Q.onToggleDynamicSideContent,sideContentBreakpointChanged:Q.sideContentBreakpointChanged,onTableInit:function(e,i){var D1=e.getSource();var j=D1.getTable();p2(D1);T.oCommonUtils.checkToolbarIntentsSupported(D1);P.attachEvent("subSectionVisibilityChange",function(e){if(j.isA("sap.m.Table")||j.isA("sap.ui.table.Table")){e2(D1,j,i);}});if(I(D1)&&!D1.data("CrossNavigation")){j.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode===K.ENTER&&D1.getEditable()){T.oCommonEventHandlers.addEntry(D1,true);e.preventDefault();e.setMarked();}}});}var k=T.oComponentUtils.getTemplatePrivateModel();if(I(D1)){j.addEventDelegate({onAfterRendering:function(e){var x;if(D1.getEditable()&&!D1.hasListeners("paste")){D1.attachBeforePaste(t1);D1.attachPaste(u1);x=k.getProperty("/objectPage/aPasteAttachedTables");if(x){x.push(i);}}}});}},onPasteButtonPress:function(e){var i=T.oCommonUtils.getText("DATA_PASTE_ACTION_MESSAGE");M.information(i);},onSearchObjectPage:w2,onSearchLiveChange:v2,onSmartTablePaste:u1,onUITableExpand:b2,onSingleSectionOrSubsectionVisible:a2,dataStateFilter:B2},formatters:{sideContentActionButtonText:Q.formatSideContentActionButtonText,setNoDataTextForSmartTable:function(e){if(T.oCommonUtils&&e){var i=T.oCommonUtils.getContextText("WAITING_SMARTTABLE",e);if(i!=="WAITING_SMARTTABLE"){return i;}return"";}},setVMVisibilityForVendor:function(){var e=new U(window.location.href);if(e.mParams["sap-ui-layer"]){var j=e.mParams["sap-ui-layer"];for(var i=0;i<j.length;i++){if(j[i].toUpperCase()==="VENDOR"){return true;}}}return false;},formatItemTextForMultipleView:function(i){return i&&W?W.formatItemTextForMultipleView(i):"";}},extensionAPI:new E(T,J,N,y)};G2.handlers=q(N.handlers,G2.handlers);return G2;}};return H;});
