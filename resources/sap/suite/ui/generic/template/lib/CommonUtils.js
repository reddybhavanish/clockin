sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Context","sap/ui/model/Filter","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper","sap/base/Log","sap/ui/model/analytics/odata4analytics","sap/suite/ui/generic/template/lib/MetadataAnalyser","sap/base/util/extend","sap/base/util/deepExtend"],function(B,E,C,a,F,R,L,M,N,b,t,c,o,d,f,g){"use strict";var h=sap.ui.getCore();function l(e,P){var i=sap.ui.require(P);return typeof i==="function"&&(e instanceof i);}function m(e){return l(e,"sap/ui/comp/smarttable/SmartTable");}function n(e){return l(e,"sap/ui/comp/smartchart/SmartChart");}function p(e){return l(e,"sap/ui/table/Table");}function q(e){return l(e,"sap/ui/table/AnalyticalTable");}function r(e){return l(e,"sap/ui/table/TreeTable");}function s(e){return l(e,"sap/m/Table");}function u(e){var T=e&&sap.ui.getCore().byId(e);if(T){T.focus();}}var m=t.testableStatic(m,"CommonUtils_isSmartTable");function v(w,S,x){var y;var z=Object.create(null);var O=Object.create(null);function P(e){var i;if(m(e)){i=e.getCustomToolbar();}else if(n(e)){i=e.getToolbar();}if(i){var j=$(i);if(j&&j.annotatedActionIds){O[e.getId()]=JSON.parse(atob(j.annotatedActionIds));}if(j&&j.deleteButtonId){O[e.getId()].push({ID:j.deleteButtonId,RecordType:"CRUDActionDelete"});}}}function G(e){if(!O[e.getId()]){P(e);}return O[e.getId()];}function A(e){var i,j,k,S1;i=e.getEntitySet();j=w.getOwnerComponent().getModel().getMetaModel();k=j.getODataEntitySet(i);S1=j.getODataEntityType(k.entityType);return S1;}function D(e,i,j){var k=e instanceof E?e.getSource():e;var S1=k.getId();var T1=z[S1];if(!T1){if(j){return null;}T1={control:k,infoObject:Object.create(null),categories:[]};(i||Function.prototype)(T1.infoObject,T1.categories,k);z[S1]=T1;}return T1.infoObject;}function H(e,i){for(var j in z){var k=z[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function I(e){S.oApplication.attachControlToParent(e,w.getView());}function J(e){if(e.getVisible&&!e.getVisible()){return null;}return e.getParent()||e.oContainer;}function K(e){var i=w.getView();var j=false;for(var k=i.getVisible()&&h.byId(e);k&&!j;k=J(k)){j=k===i;}return j;}function Q(e,j){var k="";for(var i=0;i<e.length;i++){var S1=e[i];if(K(S1)){if(j){var T1=h.byId(S1);if(m(T1)||s(T1)||p(T1)){k=k||S1;continue;}}return S1;}}return k;}function T(e,i,j,k){return S.oApplication.getDialogFragmentForView(w.getView(),e,i,j,k);}function U(e,i,j,k){return S.oApplication.getDialogFragmentForViewAsync(w.getView(),e,i,j,k);}var V;function W(){var e=w.getOwnerComponent();V=V||e.getModel("i18n").getResourceBundle();return V.getText.apply(V,arguments);}function X(k,e,i,j){var S1,T1,U1,V1;var W1=w.getOwnerComponent();var X1=e.indexOf("::"+W1.getEntitySet()+"--")+2;S1=e.substring(X1,e.lastIndexOf("::"));S1=S1.replace(/--/g,"|").replace(/::/g,"|");T1=k+"|"+S1;U1=i||k;V1=W(T1,j);if(V1===T1){V1=W(U1,j);}return V1;}function Y(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function Z(e,j,k){var S1=[];if(m(e)){e=e.getTable();}else if(n(e)){e.getChartAsync().then(function(V1){e=V1;if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var W1=false;j=j||e.getSelectionBehavior();k=k||Y(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){W1=true;}var X1=k.dataPoints;var Y1=[];for(var i=0;i<X1.length;i++){if(W1){if(X1[i].context){S1.push(X1[i].context);}}else{Y1.push(X1[i].dimensions);}}if(!W1){S1[0]=Y1;}}}});}if(e instanceof L){S1=e.getSelectedContexts();}else if(p(e)){var T1=e.getPlugins().filter(function(V1){return V1.isA("sap.ui.table.plugins.SelectionPlugin");})[0];var U1=T1?T1.getSelectedIndices():e.getSelectedIndices();if(U1){for(var i=0;i<U1.length;i++){S1.push(e.getContextByIndex(U1[i]));}}}return S1;}function $(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function _(e){var j,k,S1;var T1=l1(e);if(!m(T1)&&!n(T1)){T1=T1.getParent();}var U1=Z(T1);var V1=T1.getModel();k=i1(T1);g1(k,U1,V1,T1);j=G(T1);for(var i=0;i<j.length;i++){S1=j[i];a1(S1,V1,U1,T1);}}function a1(e,i,j,k){var S1;if(e.RecordType==="CRUDActionDelete"){S1=e1(i,j,k);k.getModel("_templPriv").setProperty("/listReport/deleteEnabled",S1);}else if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var T1=i.getMetaModel();S1=d1(i,T1,j,e.RecordType,e.Action,k);}var U1=w.getView().byId(e.ID);if(U1&&/generic\/controlProperties/.test(U1.getBindingPath("enabled"))&&S1!==undefined){c1(e.ID,"enabled",S1);}}function b1(e){var i;var j=l1(e);var k=Z(j);var S1=e.getModel();i=j1();g1(i,k,S1,j);}function c1(i,e,j){var k=w.getView().getModel("_templPriv");var S1=k.getProperty("/generic/controlProperties/"+i);if(!S1){S1={};S1[e]=j;k.setProperty("/generic/controlProperties/"+i,S1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function d1(e,i,k,S1,T1,U1){var V1,W1,X1,Y1;var Z1=false;if(S1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){V1=i.getODataFunctionImport(T1);X1=V1&&V1["sap:action-for"];if(X1&&X1!==""&&X1!==" "){if(k.length>0){Y1=V1["sap:applicable-path"];if(Y1&&Y1!==""&&Y1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}W1=e.getObject(k[j].getPath());if(W1&&W1[Y1]){Z1=true;break;}}}else{Z1=true;}}}else{Z1=true;}}else if(S1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0||(n(U1)&&U1.getDrillStackFilters().length>0)){Z1=true;}}return Z1;}function e1(e,i,j){if(i.length===0){return false;}var k=f1(j);var S1=k&&k.Deletable&&k.Deletable.Path;return i.some(function(T1){var U1=e.getObject(T1.getPath()+"/DraftAdministrativeData");var V1=!(U1&&U1.InProcessByUser&&!U1.DraftIsProcessedByMe);return V1&&!(S1&&!e.getProperty(S1,T1));});}function f1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function g1(e,i,j,k){var S1=k1(k);var T1=w.getView().getModel("_templPriv");var U1=T1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(S1){var V1=w.byId("template::IconTabBar");var W1="";if(V1){W1=V1.getSelectedKey();}h1(U1,S1,e,i,j,W1,k);}T1.setProperty("/generic/listCommons/breakoutActionsEnabled",U1);}function h1(e,i,j,k,S1,T1,U1){var V1;for(var W1 in i){V1=true;var X1=i[W1].id+((T1&&!i[W1].determining)?"-"+T1:"");if(U1&&U1.getId().indexOf("AnalyticalListPage")>-1){V1=!!e[X1].enabled;}if(i[W1].requiresSelection){if(k.length>0){if(U1&&n(U1)){if(i[W1].filter==="chart"){V1=true;}}else if(U1&&m(U1)){if(i[W1].filter!=="chart"){V1=true;}}if(i[W1].applicablePath!==undefined&&i[W1].applicablePath!==""){V1=false;for(var Y1=0;Y1<k.length;Y1++){var Z1="";var $1=i[W1].applicablePath.split("/");if($1.length>1){for(var _1=0;_1<$1.length-1;_1++){Z1+="/"+$1[_1];}}var a2=S1.getObject(k[Y1].getPath()+Z1);var b2=$1[$1.length-1];if(a2[b2]===true){V1=true;break;}}}}else if(n(U1)){if((U1.getId().indexOf("AnalyticalListPage")>-1?i[W1].filter==="chart":true)){if(U1.getDrillStackFilters().length>0){V1=true;}else{V1=false;}}}else{if(i[W1].filter!=="chart"){V1=false;}}}e[X1]={enabled:V1};}}function i1(e){var i=[];var j=k1(e);for(var k in j){i.push(j[k].id);}return i;}function j1(){var e=[];var i=k1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function k1(e){var i=w.getOwnerComponent();var j=i.getAppComponent().getManifestEntry("sap.ui5");var k=j.extends&&j.extends.extensions&&j.extends.extensions["sap.ui.controllerExtensions"];k=k&&k[i.getTemplateName()];k=k&&k["sap.ui.generic.app"];var S1=i.getEntitySet();var T1=$(e).sectionId;if(!T1){return k&&k[S1]&&k[S1]["Actions"];}else{var U1=k&&k[S1]&&k[S1]["Sections"];return U1&&U1[T1]&&U1[T1].Actions;}}function l1(e){var i=e;while(i){if(i instanceof R||p(i)||m(i)||n(i)){return i;}i=i.getParent&&i.getParent();}return null;}function m1(e){if(m(e)){e=e.getTable();}if(p(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function n1(e,i,j){var k=m1(e);if(k&&k.binding){if(i){k.binding.refresh(i);}else{k.binding.refresh();}if(!j&&w.getView().getModel("ui").getProperty("/editable")){x.messagesRefresh();}}else if(e&&e.rebindTable){e.rebindTable();}}function o1(e){var i=w.getOwnerComponent();var j=i.getModel();var k,S1;var T1=!S.oApplication.checkEtags();if(T1){S1=m1(e);if(S1){k=S1.path;var U1=e.getEntitySet();var V1=j.getMetaModel();var W1=V1.getODataEntitySet(U1);if(w.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&p1(j,W1)){j.invalidateEntityType(W1.entityType);}else{j.invalidate(q1.bind(null,k));}var X1=i.getId();var Y1=Object.create(null);Y1[X1]=true;S.oApplication.refreshAllComponents(Y1);}}}function p1(e,i){var j=new o.Model(o.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var S1=k&&k.getParameterization();return!!S1;}function q1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function r1(e,i){var j;if(x.isDraftEnabled()){j=S.oDraftController.isActiveEntity(e)?1:6;}else{var k=w.getOwnerComponent();j=k.getModel("ui").getProperty("/editable")?6:1;}x.navigateAccordingToContext(e,j,i);}function s1(e,i){if(e instanceof a){S.oNavigationController.navigateToContext(e,i&&i.navigationProperty,i&&i.replaceInHistory);return;}var j=i&&i.routeName;if(j){x.navigateRoute(j,e,null,i&&i.replaceInHistory);return;}c.warning("navigateToContext called without context or route");}function t1(e){if(e instanceof b){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(W("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:W("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:W("ST_GENERIC_ERROR_TITLE")});}}}function u1(e,i){H1(function(){y=N1();var j={semanticObject:e.semanticObject,action:e.action};var k=y.mixAttributesAndSelectionVariant(e.parameters);if(typeof w.adaptNavigationParameterExtension==="function"){w.adaptNavigationParameterExtension(k,j);}y.navigate(e.semanticObject,e.action,k.toJSONString(),null,t1);},Function.prototype,i,"LeavePage");}function v1(e){var S1=[],T1,U1,V1;var W1=w.getOwnerComponent();var X1=W1.getModel().getMetaModel();if(!e){return{};}var Y1=W1.getAppComponent().getConfig().pages[0];if(!Y1){return{};}var Z1=function(i){V1=X1.getODataEntitySet(i.entitySet).entityType;U1=X1.getODataEntityType(V1);T1={};T1={entitySet:i.entitySet,aKeys:X1.getODataEntityType(V1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,_1=T1.aKeys.length;j<_1;j++){var k=0,a2=U1.property.length;for(k;k<a2;k++){if(T1.aKeys[j].name===U1.property[k].name){T1.aKeys[j].type=U1.property[k].type;break;}}}};var $1=function(e,Y1){if(!Y1.pages){return S1;}for(var i=0,j=Y1.pages.length;i<j;i++){if(!Y1.pages[i]){break;}if(e===Y1.pages[i].entitySet){Z1(Y1.pages[i]);S1.splice(0,0,T1);break;}S1=$1(e,Y1.pages[i]);if(S1.length>0){Z1(Y1.pages[i]);S1.splice(0,0,T1);}}return S1;};return $1(e,Y1);}function w1(k,e){var S1,T1,i,U1;for(i=0,U1=k.length;i<U1;i++){if(k[i].navigationProperty){T1+="/"+k[i].navigationProperty;}else{T1="/"+k[i].entitySet;}for(var j=0,V1=k[i].aKeys.length;j<V1;j++){if(j===0){T1+="(";S1="";}else{S1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){T1+=S1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{T1+=S1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){T1+=S1+k[i].aKeys[j].name+"="+false;}else{T1+=S1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){T1+=S1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{T1+=S1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(V1-1)){T1+=")";}}}return T1;}function x1(e,k,w){var S1,T1,U1,V1,W1,X1,Y1;var Z1={semanticObject:"",action:""};y=N1();S1=y.mixAttributesAndSelectionVariant({},k);for(V1 in e.semanticAttributesOfSemanticObjects){for(U1 in e.semanticAttributesOfSemanticObjects[V1]){if(!S1.getSelectOption(U1)){S1.addParameter(U1,"");}}W1=S1.getPropertyNames();Z1.semanticObject=V1;w.adaptNavigationParameterExtension(S1,Z1);X1=S1.getSelectOptionsPropertyNames();Y1=S1.getParameterNames();for(var i=0,$1=W1.length;i<$1;i++){if(X1.indexOf(W1[i])<0&&Y1.indexOf(W1[i])<0){delete e.semanticAttributesOfSemanticObjects[V1][W1[i]];S1.removeSelectOption(W1[i]);}}if(V1===e.semanticObject){var _1=e.semanticAttributesOfSemanticObjects[""];for(var j=0,$1=Y1.length;j<$1;j++){S1.removeParameter(Y1[j]);if(!(Y1[j]in _1)){var a2=e.semanticAttributesOfSemanticObjects[e.semanticObject][Y1[j]];a2=(typeof a2==="undefined"||a2===null)?"":String(a2);S1.addParameter(Y1[j],a2);}}S1=y.mixAttributesAndSelectionVariant(e.semanticAttributesOfSemanticObjects[V1],S1.toJSONString());T1=S1.toJSONString();}}delete e.semanticAttributes;y.processBeforeSmartLinkPopoverOpens(e,T1);}function y1(e,j){var k=function(W1){for(var i=0;i<W1.length;i++){j(W1[i].name);}};var S1=w.getView().getModel().getMetaModel();var T1=S1.getODataEntitySet(e,false);var U1=S1.getODataEntityType(T1.entityType,false);k(U1.key.propertyRef);var V1=S.oDraftController.getDraftContext();if(V1.isDraftEnabled(e)){k(V1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function z1(i,j,k,S1,T1){if(S1&&k&&k.getAnalyticBindingPath&&k.getConsiderAnalyticalParameters()){try{var U1=k.getAnalyticBindingPath();var V1=i.getEntitySet();var W1=i.getModel();var X1=W1.getMetaModel();var Y1=X1.getODataEntitySet(V1);var Z1=w.getOwnerComponent();var $1=Z1.getAppComponent();var _1=d.getParametersByEntitySet($1.getModel(),V1);if(j){U1=j(Y1,_1);}if(U1){S1(U1);}}catch(e){c.warning("Mandatory parameters have no values","",T1);}}}function A1(e,j,k){for(var i=0;i<j.length;i++){var S1=j[i];var T1=S1.lastIndexOf("/");var U1;if(T1<0){if(S.oApplication.getNavigationProperty(e,S1)){U1=S1;}else{continue;}}else{U1=S1.substring(0,T1);}if(k.indexOf(U1)===-1){k.push(U1);}}}function B1(e,i,j){var k=e.getParameter("bindingParams"),S1=e.getSource().getId();k.parameters=k.parameters||{};var T1=function($1,_1,S1){if(i&&i[$1]){var a2=true;var b2=function(){var c2=arguments[0];if(!(c2 instanceof C)){throw new Error("Please provide a valid ControllerExtension in order to execute extension "+$1);}if(!a2){throw new Error("Extension "+$1+" must be executed synchronously");}var d2=Array.prototype.slice.call(arguments,1);_1.apply(null,d2);};i[$1](b2,S1);a2=false;}};var U1=function($1){if(!S1||w.byId(S1)===e.getSource()){k.filters.push($1);}};if(i.addTemplateSpecificFilters){i.addTemplateSpecificFilters(k.filters);}T1("addExtensionFilters",U1,S1);var V1=e.getSource();if(w.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){z1(V1,i.resolveParamaterizedEntitySet,j,i.setBindingPath,i.isAnalyticalListPage?"AnalyticalListPage":"ListReport");}var W1=V1.getEntitySet();var X1=k.parameters.select&&k.parameters.select.split(",")||[];var Y1=k.parameters.expand&&k.parameters.expand.split(",")||[];var Z1=function($1,S1){if($1&&(!S1||w.byId(S1)===e.getSource())){var _1=$1.split(',');_1.forEach(function(a2){if(a2&&X1.indexOf(a2)===-1){X1.push(a2);}});}};if(!i.isAnalyticalListPage){y1(W1,Z1);}T1("ensureExtensionFields",Z1,S1);(i.addNecessaryFields||Function.prototype)(X1,Z1,W1);A1(W1,X1,Y1);if(Y1.length>0){k.parameters.expand=Y1.join(",");}if(X1.length>0){k.parameters.select=X1.join(",");}}function C1(e,i,j){if(!e){return W("DRAFT_OBJECT");}else if(i){return W(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function D1(){return new Promise(function(e){var i;U("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var j=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(j.length>0&&(j[0]===null||j[0]===undefined||j[0]==="")){if(j.length>3&&(j[3]===null||j[3]===undefined||j[3]==="")){return(j.length>2&&(j[1]===null||j[1]===undefined||j[1]===""))?"":j[2];}else{return W(k,j[3]);}}else{return W(k,j[0]);}},closeDraftAdminPopover:function(){i.close();},formatDraftLockText:C1},"admin").then(function(j){i=j;e(i);});});}function E1(e){var i={};if(e){i.discardPromise=e;}var j=w.getView();var k=j.getModel();if(k.hasPendingChanges()){j.setBindingContext(null);k.resetChanges();j.setBindingContext();}x.fire(w,"AfterCancel",i);}function F1(e,i,j,k,S1){var T1=S.oApplication.getBusyHelper();if(!S1&&T1.isBusy()){return;}if(!x.isDraftEnabled()){var U1=false;if(j&&j.aUnsavedDataCheckFunctions){U1=j.aUnsavedDataCheckFunctions.some(function(X1){return X1();});}var V1=w.getView();var W1=V1.getModel();if(U1||W1.hasPendingChanges()){return new Promise(function(X1,Y1){K1(function(){E1();X1(e());},function(){Y1(i());},k,false);});}}return e();}function G1(e,i,j,k){var S1=false;if(j&&j.aUnsavedDataCheckFunctions){S1=j.aUnsavedDataCheckFunctions.some(function(U1){return U1();});}if(S1||w.getView().getModel().hasPendingChanges()){var T1;K1(function(){w.getView().getModel().resetChanges();x.fire(w,"AfterCancel",{});T1=e();},function(){T1=i();},k,true);return T1;}return e();}function H1(e,i,j,k,S1){var T1=w.getOwnerComponent();var U1=T1.getAppComponent();var V1=U1.suppressDataLossPopup();if(V1){return S1?e():S.oApplication.performAfterSideEffectExecution(e);}else if(S1){return F1(e,i,j,k,true);}return S.oApplication.performAfterSideEffectExecution(F1.bind(null,e,i,j,k,false));}var I1;var J1;function K1(e,i,j,k){var S1;I1=e;J1=i;var T1=k?"sap.suite.ui.generic.template.fragments.DataLossTechnicalError":"sap.suite.ui.generic.template.fragments.DataLoss";var U1;U(T1,{onDataLossOK:function(){U1.close();I1();},onDataLossCancel:function(){U1.close();J1();}},"dataLoss").then(function name(V1){U1=V1;j=j||"LeavePage";S1=U1.getModel("dataLoss");S1.setProperty("/mode",j);U1.open();});}function L1(e,i,j,k,S1,T1){if(i.busy.check&&k.isBusy()){T1();return;}var U1=i.busy.set?function(){k.setBusy(Promise.resolve(),false,{actionLabel:i.sActionLabel});return e();}:e;var V1=i.mConsiderObjectsAsDeleted?function(X1){S.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return U1();}:U1;var W1=(i.dataloss.popup?H1(V1,T1,j,(i.dataloss.navigation?"LeavePage":"Proceed"),true):V1());if(W1 instanceof Promise){W1.then(S1,T1);}else{S1();}}function M1(e,i,j){i=g({busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var k=S.oApplication.getBusyHelper();var S1=new Promise(function(T1,U1){S.oApplication.performAfterSideEffectExecution(L1.bind(null,e,i,j,k,T1,U1));});if(i.busy.set){k.setBusy(S1,false,{actionLabel:i.sActionLabel});}return S1;}function N1(){y=y||new N(w);return y;}function O1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function P1(e){var i=e.getId()+"-variant";var j=sap.ui.getCore().byId(i);var k=j.getDefaultVariantKey();return k===j.STANDARDVARIANTKEY?"":k;}function Q1(e){var j;var k=x.getTemplatePrivateModel();var S1=w.getOwnerComponent();var T1,U1,V1,W1,X1,Y1=[],Z1=[],i,$1,_1,a2,b2,c2,d2;var e2,f2;T1=S1.getAppComponent();U1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");V1=k.getProperty("/generic/supportedIntents/");if(n(e)){j=e.getToolbar();}else if(m(e)){j=e.getCustomToolbar();}W1=j.getContent();X1=W1.length;for(i=0;i<X1;i++){$1=$(W1[i]);if($1.hasOwnProperty("SemanticObject")&&$1.hasOwnProperty("Action")){_1=$1.SemanticObject;a2=$1.Action;b2={semanticObject:_1,action:a2,ui5Component:T1};Y1.push([b2]);c2=f({},b2);c2.bLinkIsSupported=false;Z1.push(c2);}}if(Y1.length>0&&U1){d2=U1.getLinks(Y1);d2.done(function(g2){V1=k.getProperty("/generic/supportedIntents/");e2=g2.length;for(i=0;i<e2;i++){if(g2[i][0].length>0){Z1[i].bLinkIsSupported=true;}_1=Z1[i].semanticObject;a2=Z1[i].action;f2=k.getProperty("/generic/supportedIntents/"+_1);if(!f2){V1[_1]={};V1[_1][a2]={"visible":Z1[i].bLinkIsSupported};}else if(!f2[a2]){f2[a2]={"visible":Z1[i].bLinkIsSupported};}else{f2[a2]["visible"]=Z1[i].bLinkIsSupported;}}k.updateBindings();});}}function R1(e,i){var j=i&&w.byId(i);var k=(i&&!j)?Promise.reject():new Promise(function(S1,T1){S.oApplication.performAfterSideEffectExecution(function(){var U1=S.oApplication.getBusyHelper();if(U1.isBusy()){T1();return;}if(j&&(!j.getVisible()||(j.getEnabled&&!j.getEnabled()))){T1();return;}var k=j?e(j):e();if(k instanceof Promise){k.then(S1,T1);U1.setBusy(k);}else{S1(k);}});});k.catch(Function.prototype);return k;}var N1=t.testable(N1,"getNavigationHandler");var g1=t.testable(g1,"fillEnabledMapForBreakoutActions");var i1=t.testable(i1,"getBreakoutActionIds");var l1=t.testable(l1,"getOwnerControl");var Z=t.testable(Z,"getSelectedContexts");var G=t.testable(G,"fnGetToolbarCutomData");return{isSmartTable:m,isSmartChart:n,isUiTable:p,isAnalyticalTable:q,isTreeTable:r,isMTable:s,getPositionableControlId:Q,getMetaModelEntityType:A,getText:W,getContextText:X,getNavigationHandler:N1,getNavigationKeyProperties:v1,mergeNavigationKeyPropertiesWithValues:w1,executeGlobalSideEffect:function(){if(x.isDraftEnabled()){var e=w.getView();var i=w.getOwnerComponent();var j=i.getAppComponent();var k=j.getForceGlobalRefresh();var S1=i.getModel("ui");e.attachBrowserEvent("keydown",function(T1){var U1=T1.target.type==="search";var V1=T1.target.type==="textarea";var W1=T1.target.id.indexOf("rowAction")>-1;var X1=T1.target.id.indexOf("ColumnListItem")>-1;if(T1.keyCode===13&&T1.ctrlKey!==true&&S1.getProperty("/editable")&&!U1&&!V1&&!W1&&!X1){S.oApplication.addSideEffectPromise(new Promise(function(Y1){setTimeout(function(){var Z1=S.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,k);Z1.then(function(){Y1();setTimeout(function(){var $1=document.getElementById(T1.target.id);if($1){$1.focus();}});});});}));}});}},setEnabledToolbarButtons:_,setEnabledFooterButtons:b1,fillEnabledMapForBreakoutActions:g1,getBreakoutActions:k1,getSelectedContexts:Z,getSelectionPoints:Y,getDeleteRestrictions:f1,getSmartTableDefaultVariant:O1,getSmartChartDefaultVariant:P1,setPrivateModelControlProperty:c1,navigateFromListItem:r1,navigateToContext:s1,navigateExternal:u1,semanticObjectLinkNavigation:x1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},getCustomDataText:function(e){return new Promise(function(j,k){e.getCustomData().forEach(function(S1){var T1=S1.getKey();if(T1==="text"){var U1=S1.getBinding("value");var V1=!U1&&S1.getBindingInfo("value");if(!U1&&!V1){j(S1.getValue());return;}var W1=function(X1){j(X1.getSource().getExternalValue());return;};if(U1){U1.attachChangeOnce(W1);}else{V1.events={change:W1};for(var i=0;i<V1.parts.length;i++){V1.parts[i].targetType="string";}}}});});},onBeforeRebindTableOrChart:B1,formatDraftLockText:C1,resetChangesAndFireCancelEvent:E1,showDraftPopover:function(e,i){D1().then(function(j){var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}});},getContentDensityClass:function(){return S.oApplication.getContentDensityClass();},attachControlToView:I,getDialogFragment:T,getDialogFragmentAsync:U,processDataLossConfirmationIfNonDraft:H1,processDataLossTechnicalErrorConfirmation:G1,securedExecution:M1,getOwnerControl:l1,getTableBindingInfo:m1,refreshSmartTable:n1,refreshModel:o1,getElementCustomData:$,triggerAction:function(e,i,j,k,S1){H1(function(){S.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:""}).then(function(T1){if(T1&&T1.length>0){var U1=T1[0];if(U1.response&&U1.response.context&&(!U1.actionContext||U1.actionContext&&U1.response.context.getPath()!==U1.actionContext.getPath())){S.oApplication.getBusyHelper().getUnbusy().then(S.oViewDependencyHelper.setMeToDirty.bind(null,w.getOwnerComponent(),i));}}});},Function.prototype,S1,"Proceed");},checkToolbarIntentsSupported:Q1,executeIfControlReady:R1,getControlInformation:D,executeForAllInformationObjects:H,focusControl:u};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,S,i){f(this,v(e,S,i));}});});
