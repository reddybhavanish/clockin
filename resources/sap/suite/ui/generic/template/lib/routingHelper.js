sap.ui.define(["sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/generic/app/util/ModelUtil","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/FlexibleColumnLayoutHandler","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/js/StableIdHelper","sap/m/MessageBox","sap/base/Log","sap/ui/model/analytics/odata4analytics","sap/base/util/extend","sap/base/util/isEmptyObject","sap/base/util/each"],function(F,a,M,C,b,t,S,c,L,o,e,d,f){"use strict";var g=(sap&&sap.ushell&&sap.ushell.Container)?sap.ushell.Container.getService("CrossApplicationNavigation"):(function(){var i=0;var j={done:function(Z){Z(Object.create(null));},fail:function(){}};return{createEmptyAppState:function(){return{getKey:function(){i++;return""+i;},setData:Function.prototype,save:function(){return Promise.resolve();}};},getAppState:function(){return j;},isInitialNavigation:function(){return true;}};})();var p="---";function h(i,j,Z,$,_){var a1={};a1={viewName:Z,controlId:j,controlAggregation:_};var b1=i.getTargets();b1.addTarget($,a1);}function k(i,j){if(i.oTemplateContract.oFlexibleColumnLayoutHandler){i.oTemplateContract.oFlexibleColumnLayoutHandler.createMessagePageTargets(h.bind(null,i.oRouter,j,"sap.suite.ui.generic.template.fragments.MessagePage"));}else{h(i.oRouter,j,"sap.suite.ui.generic.template.fragments.MessagePage","messagePage","pages");}}function E(i,j,Z){var $=i[j];if(!$){$={draftSpec:"OData",level:0,children:[]};for(var _ in i){var a1=i[_];if(a1.level===1){$.children.push(_);break;}}i[j]=$;}if($.hasOwnProperty("isDraft")){return;}if($.draftSpec==="parent"){if($.parent){E(i,$.parent,Z);var b1=i[$.parent];$.isDraft=b1.isDraft;}else if($.level===1){for(var c1 in i){var d1=i[c1];if(d1.level===0){$.isDraft=d1.isDraft;return;}}}return;}if($.draftSpec==="OData"){$.isDraft=Z.isDraftEnabled(j);return;}$.isDraft=$.draftSpec;}function l(i,j){var Z=i.oAppComponent.getModel();var $=Z.getMetaModel();$.loaded().then(function(){var _=i.oTemplateContract.mEntityTree;var a1=i.oAppComponent.getTransactionController().getDraftController();var b1=a1.getDraftContext();var c1=i.oTemplateContract.mRoutingTree.root;c1.isDraft=b1.isDraftEnabled(j);E(_,j,b1);for(var d1 in _){E(_,d1,b1);}});}function m(i){var j=i.oTemplateContract.oNavigationHost.getId();var Z=i.oAppComponent.getConfig();if(!Z.pages||!Z.pages.length){throw new Error("Route Configuration missing");}if(Z.pages.length>1){throw new Error("Currently only one Top route supported");}var $=Z.pages[0];i.oTemplateContract.mEntityTree=Object.create(null);i.oTemplateContract.mRoutingTree=Object.create(null);var _={sRouteName:"root",entitySet:$.entitySet,page:$,getPath:function(){return"";},level:0,fCLLevel:0,children:[],headerTitle:i.oAppComponent.getManifestEntry("sap.app").title,text:""};var a1=x([],$,"root",_,null,i,j);i.oRouter.addRoute(a1);i.oTemplateContract.mRoutingTree.root=_;u(a1,i);n("root",$,0,_,i,j,_.children);k(i,j);l(i,$.entitySet);return $.entitySet;}function n(j,Z,$,_,a1,b1,c1,d1,e1){var i,f1;if(Z.pages){f1=Z.pages.length;for(i=0;i<f1;i++){s(j,Z.pages[i],$+1,_,a1,b1,c1,d1,e1||0);}}}function H(i,j,Z,$,_,a1,b1,c1,d1){var e1=$.target;var f1={pages:j.pages};var g1={entitySet:$.entitySet,sRouteName:$.sRouteName,embeddedComponent:i,getPath:function(h1){if(h1===1){return $.getPath(1)+"/"+i;}return $.getPath(h1);},patternDelimiter:p};n(e1,f1,Z,g1,_,a1,b1,c1,d1);}function q(i,j,Z,$,_,a1,b1,c1,d1,e1){var f1={};var g1={key:a1,definition:b1,componentName:b1.componentName,componentUsage:b1.componentUsage,hiddenByDefault:b1.hiddenByDefault,containerId:c1,sectionId:d1,subSectionId:e1,pages:b1.pages||[],children:[],communicationObject:f1};i.embeddedComponents[a1]=g1;if(b1.pages){H(a1,b1,j,i,Z,$,g1.children,f1,_);}}function r(j,Z,$,_,a1,b1){j.embeddedComponents=Object.create(null);j.leadingComponents=Object.create(null);j.facetsWithEmbeddedComponents=Object.create(null);if(Z.implementingComponent){q(j,$,_,a1,b1,"implementation",Z.implementingComponent,"template::ImplementingComponent");}else if(Z.embeddedComponents){var c1=Object.create(null);var d1=Object.create(null);var e1;var f1;var g1;for(e1 in Z.embeddedComponents){f1=Z.embeddedComponents[e1];if(!f1.leadingSectionIdOrPath||f1.leadingSectionIdOrPath===e1){c1[e1]=[e1];}else if(Z.embeddedComponents[f1.leadingSectionIdOrPath]){d1[e1]=f1.leadingSectionIdOrPath;}else{g1=j.facetsWithEmbeddedComponents[f1.leadingSectionIdOrPath];if(g1){g1.push(e1);}else{j.facetsWithEmbeddedComponents[f1.leadingSectionIdOrPath]=[e1];}}}var h1=[];for(e1 in d1){var i1=d1[e1];g1=c1[i1];if(g1){g1.push(e1);}else{h1.push(e1);delete d1[e1];}}for(var i=0;i<h1.length;i++){c1[h1[i]]=[h1[i]];}for(e1 in Z.embeddedComponents){f1=Z.embeddedComponents[e1];var j1=c1[e1]&&S.getStableId({type:"ObjectPageSection",subType:"ReuseComponentSection",sReuseComponentName:f1.componentName,sReuseComponentUsage:f1.componentUsage,sReuseComponentId:e1});var k1=S.getStableId({type:"ObjectPageSection",subType:"ReuseComponentSubSection",sReuseComponentName:f1.componentName,sReuseComponentUsage:f1.componentUsage,sReuseComponentId:e1});var l1=S.getStableId({type:"ObjectPageSection",subType:"ReuseComponentContainer",sReuseComponentName:f1.componentName,sReuseComponentUsage:f1.componentUsage,sReuseComponentId:e1});q(j,$,_,a1,b1,e1,f1,l1,j1,k1);}Object.keys(c1).forEach(function(i1){var m1=j.embeddedComponents[i1];j.leadingComponents[i1]={sectionId:m1.sectionId,title:m1.definition.groupTitle||m1.definition.title,followingComponents:c1[i1].map(function(n1){var o1=j.embeddedComponents[n1];o1.sectionId=m1.sectionId;return o1;})};});}}function s(i,j,Z,$,_,a1,b1,c1,d1){if(j.component){var e1=_.oTemplateContract.oFlexibleColumnLayoutHandler?_.oTemplateContract.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():1;var f1=(e1===1)||(j.defaultLayoutType==="OneColumn")?0:d1+1;var g1={parent:$&&$.entitySet,parentRoute:$?$.sRouteName:"root",parentEmbeddedComponent:$&&$.embeddedComponent,entitySet:j.entitySet,navigationProperty:j.navigationProperty,level:Z,fCLLevel:f1>=e1?3:f1,children:[],communicationObject:c1,page:j,defaultLayoutType:j.defaultLayoutType,defaultLayoutTypeIfExternalNavigation:j.defaultLayoutTypeIfExternalNavigation,noKey:j.routingSpec&&j.routingSpec.noKey,noOData:j.routingSpec&&j.routingSpec.noOData,draftSpec:j.routingSpec?j.routingSpec.draftSpec||"parent":"OData",text:""};w(g1,$,_.oTemplateContract.bCreateRequestsCanonical);var h1=x(i,j,j.component.list?"aggregation":"detail",g1,$,_,a1);g1.sRouteName=h1.name;if(b1){b1.push(h1.entitySet);}_.oTemplateContract.mRoutingTree[h1.name]=g1;var i1=_.oTemplateContract.mEntityTree[h1.entitySet];if(!i1||i1.level>g1.level){_.oTemplateContract.mEntityTree[h1.entitySet]=g1;}_.oRouter.addRoute(h1);u(h1,_);v(_,g1,j);n(h1.target,j,Z,g1,_,a1,g1.children,c1,f1);r(g1,j,Z,_,a1,f1);}}function u(i,j){var Z=e({},i);Z.name=i.name+"query";Z.pattern=i.pattern+"{?query}";j.oRouter.addRoute(Z);}function v(i,j,Z){if(j.noOData){j.headerTitle=Z.routingSpec.headerTitle;j.titleIconUrl=Z.routingSpec.titleIconUrl;}else{var $=i.oAppComponent.getModel();var _=$.getMetaModel();_.loaded().then(function(){var a1=_.getODataEntitySet(j.entitySet);var b1=_.getODataEntityType(a1.entityType);var c1=b1["com.sap.vocabularies.UI.v1.HeaderInfo"];var d1=(c1&&c1.TypeName&&c1.TypeName.String)||"";if(d1.substr(0,7)==="{@i18n>"){var e1=d1.substring(1,d1.length-1);var f1=e1.split(">");d1=i.oAppComponent.getModel(f1[0]).getResourceBundle().getText(f1[1]);}j.headerTitle=d1;var g1=(c1&&c1.Title&&c1.Title.IconUrl&&c1.Title.IconUrl.String)||"";j.titleIconUrl=g1;});}}function w(j,Z,$){var _=(j.level===1)?j.page.entitySet:j.page.navigationProperty;var a1=j.noKey?"":"({keys"+j.level+"})";var b1=_+a1;var c1=Z&&Z.getPath(1);if(c1){b1=c1+(Z.patternDelimiter||"/")+b1;}var d1;var e1;if(j.noOData){var f1=j.page.routingSpec.binding?("/"+j.page.routingSpec.binding):"";d1=Z.getPath(3)+f1;e1=Z.getPath(2)+f1;}else{d1="/"+j.entitySet+a1;e1=$?d1:"/"+b1;}j.getPath=function(g1,h1){var i1;switch(g1){case 1:i1=b1;break;case 2:i1=e1;break;case 3:i1=d1;break;default:}if(h1){for(var i=1;i<=j.level;i++){i1=i1.replace("{keys"+i+"}",h1[i]);}}return i1;};}function x(i,j,Z,$,_,a1,b1){var c1=$.level;var d1=Array.isArray(i)?i:[i];var e1,f1;e1=(c1===1)?j.entitySet:j.navigationProperty;f1=e({},j);f1.path="/"+j.entitySet;f1.operation=Z;f1.viewLevel=c1;f1.template=j.component?(j.component.name||j.component):j.template;switch(Z){case"root":f1.name="root";break;case"aggregation":f1.name=e1+"~aggregation";break;default:f1.name=e1;break;}if(c1>1){f1.name=_.sRouteName+"/"+(_.embeddedComponent?_.embeddedComponent+"/":"")+f1.name;}var g1;var h1=f1.name;if(a1.oTemplateContract.oFlexibleColumnLayoutHandler){g1=a1.oTemplateContract.oFlexibleColumnLayoutHandler.adaptRoutingInfo(f1,h1,d1,$);}else{g1="pages";f1.target=h1;}h(a1.oRouter,b1,f1.name,h1,g1);var i1=new Promise(function(j1){a1.mRouteToComponentResolve[f1.name]=j1;});a1.oTemplateContract.mRouteToTemplateComponentPromise[f1.name]=i1;f1.pattern=$.getPath(1);return f1;}function I(i,j){var Z;if(!i.oHashChanger.getHash()){Z="";if(j&&j.route&&j.route.length===1){Z=j.route[0];i.navigate(Z,true);}}i.oRouter.initialize();i.fnInitializationResolve();}function B(j,Z,$,_){var i,a1,b1,c1,d1=[],e1;a1=$.length;for(i=0;i<a1;i++){b1=$[i].PropertyPath;c1=_[b1][0];d1.push(new F(b1,a.EQ,c1));}if(j.oAppComponent.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(Z)){var f1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});d1.push(f1);}e1=new F(d1,true);return e1;}function R(j,Z,$){var _="/"+Z;try{var a1=new o.Model(o.Model.ReferenceByModel(j));var b1=a1.findQueryResultByName(Z);var c1=new o.QueryResultRequest(b1);var d1=b1&&b1.getParameterization();var e1=false;if(d1){c1.setParameterizationRequest(new o.ParameterizationRequest(d1));var f1=d1.getAllParameterNames();f(f1,function(){if($.hasOwnProperty(this)){e1=true;c1.getParameterizationRequest().setParameterValue(this,$[this][0]);}});for(var i=0;i<f1.length;i++){if(f1[i].startsWith("P_")){var g1=f1[i].substr(2);if($.hasOwnProperty(g1)){e1=true;c1.getParameterizationRequest().setParameterValue(f1[i],$[g1][0]);}}}if(e1){_=c1.getURIToQueryResultEntitySet();}}}catch(h1){L.info(h1.name+":"+h1.message);}return _;}function y(i,j,Z,$,_){return new Promise(function(a1,b1){var c1=R(Z,i,$);Z.read(c1,{filters:[j],success:function(d1){var e1=A(d1,Z,$);if(e1){var f1=Z.getKey(e1);if(f1){a1({"status":"success","value":f1,"iLevel":_});}}a1({"status":"noData"});},error:function(){a1({"status":"error"});}});});}function z(j,Z,$,_,a1,b1,c1){var d1=[],e1,f1,g1;var h1=new Promise(function(i1){i1({"status":"success","value":c1,"iLevel":0});});if($&&_&&a1){if(b1.aNavigablePages){for(var i=0;i<b1.aNavigablePages.length;i++){if(b1.aNavigablePages&&b1.aNavigablePages[i]&&b1.aNavigablePages[i].bNavigationWithTechnicalKeyPossible){d1.push(h1);continue;}e1=b1.aNavigablePages[i];f1=B(j,e1.sEntitySet,e1.aSemanticKey,_);g1=y(e1.sEntitySet,f1,a1,_,e1.iLevel);d1.push(g1);}}return Promise.all(d1).then(function(i1){if(i1[0]&&i1[0].status&&i1[0].status==="success"){var i,j1="",k1;for(i=0;i<i1.length;i++){if(i1[i]&&i1[i].status&&i1[i].status==="success"){k1=i1[i].value;if(i>0){k1=k1.replace(b1.aNavigablePages[i].sEntitySet,b1.aNavigablePages[i].sNavigationProperty);k1='/'+k1;}j1=j1.concat(k1);continue;}else{break;}}j.navigate(j1,true);}I(j,_);});}}function A(Z,$,_){var a1,i,b1,c1;if(Z&&Z.results){b1=Z.results.length;if(b1===0){c1=null;}else if(b1===1){c1=Z.results[0];}else if(b1>=1){var d1=[];var e1=[];for(i=0;i<b1;i++){a1=Z.results[i];if(a1&&a1.IsActiveEntity){e1.push(a1);}else if(a1&&a1.IsActiveEntity===false){d1.push(a1);}}if(e1.length===0&&d1.length>=2){var f1;for(var j=0;j<d1.length;j++){f1=d1[j];if(f1.DraftUUID===(_.DraftUUID&&_.DraftUUID[0])){c1=f1;break;}}if(!c1){c1=d1[0];}}else if(e1.length===1&&d1.length>=1){c1=e1[0];}}}return c1;}function D(i,j){if((i&&j)||(j==="display")){return{mode:"unsupported"};}var Z={mode:"display",force:"false"};Z.mode=j||i||Z.mode;Z.force=!!j;return Z;}function G(j,Z,$,_,a1){var b1=e({},_);U(j.getMetaModel(),$,b1);var c1=N(j,Z,$,b1,a1);if(c1.aNavigablePages&&c1.aNavigablePages[0]&&c1.aNavigablePages[0].aSemanticKey&&c1.aNavigablePages[0].iLevel===0){z(Z,$,c1.aNavigablePages[0].aSemanticKey,b1,j,c1);return;}else if(c1.aNavigablePages&&c1.aNavigablePages[0]&&c1.aNavigablePages[0].bNavigationWithTechnicalKeyPossible){if(_.IsActiveEntity&&_.IsActiveEntity[0]==="false"&&_.DraftUUID&&_.DraftUUID[0]!==""){var d1=[];for(var i=0;i<c1.aNavigablePages[0].aTechnicalKey.length;i++){var e1=c1.aNavigablePages[0].aTechnicalKey[i]&&c1.aNavigablePages[0].aTechnicalKey[i].name;if(e1==="DraftUUID"||e1==="IsActiveEntity"){continue;}if(b1.hasOwnProperty(e1)){d1.push({PropertyPath:e1});}}var f1=j.createKey($,b1);z(Z,$,d1,b1,j,c1,f1);return;}var f1=j.createKey($,b1);if(f1){if(c1){var d1=[];for(var i=0;i<c1.aNavigablePages[0].aTechnicalKey.length;i++){var e1=c1.aNavigablePages[0].aTechnicalKey[i]&&c1.aNavigablePages[0].aTechnicalKey[i].name;if(e1==="DraftUUID"||e1==="IsActiveEntity"){continue;}if(b1.hasOwnProperty(e1)){d1.push({PropertyPath:e1});}}z(Z,$,d1,b1,j,c1,f1);return;}Z.navigate(f1,true);}}I(Z,_);}function J(j,Z){var i,$,_=false,a1,b1;if(Z&&j){$=j.length;for(i=0;i<$;i++){_=true;a1=j[i];b1=a1.name||a1.PropertyPath;if(!Z[b1]||Z[b1].length>1){_=false;break;}}}return _;}function K(j,Z,$,_,a1,b1){var c1,d1,e1,f1,g1,h1,i1;for(var i=0;i<_.length;i++){h1=_[i];if(h1&&h1.navigation&&h1.navigation[$.mode]){continue;}d1=j.getMetaModel().getODataEntitySet(h1.entitySet);e1=h1.component&&h1.component.settings&&h1.component.settings.allowDeepLinking;if(!d1||!(a1===0||e1)){continue;}f1=j.getMetaModel().getODataEntityType(d1.entityType);g1=f1["com.sap.vocabularies.Common.v1.SemanticKey"];c1={};i1={};if(g1&&J(g1,Z)){c1["sEntitySet"]=h1.entitySet;c1["aSemanticKey"]=g1;c1["sNavigationProperty"]=h1.navigationProperty;c1["iLevel"]=a1;b1.push(c1);}else{if(f1.key.propertyRef&&(a1===0)&&J(f1.key.propertyRef,Z)){i1.bNavigationWithTechnicalKeyPossible=J(f1.key.propertyRef,Z);i1.aTechnicalKey=f1.key.propertyRef;b1.push(i1);}}if(h1.pages){K(j,Z,$,h1.pages,++a1,b1);}else{break;}}return b1;}function N(i,j,Z,$,_){var a1={},b1=[],c1=[];var d1=j.oAppComponent.getConfig();b1=d1.pages&&d1.pages[0]&&d1.pages[0].pages;if(!b1){return{};}c1=K(i,$,_,b1,0,c1);a1.aNavigablePages=c1;return a1;}function P(i){var j=i.oAppComponent.getModel("_templPrivGlobal");j.setProperty("/generic/forceFullscreenCreate",true);}function T(Z,$,_){var a1,b1,c1,d1,e1,f1,i,g1,j,h1,i1;if(d(_)){return;}a1=Z&&Z.getMetaModel();b1=a1&&a1.getODataEntitySet($);c1=b1&&b1.entityType;d1=a1&&a1.getODataEntityType(c1);e1=d1&&d1.property;f1=[];i1=e1&&e1.length;for(i=0;i<i1;i++){g1=e1[i];if(g1["type"]==="Edm.Guid"){f1.push(g1["name"]);}}for(j=0;j<f1.length;j++){if(!_[f1[j]]){continue;}h1=_[f1[j]][0];h1=h1.toLowerCase().replace(/(guid')([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(')/,"$2");if(!h1.match(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/)){h1=h1.replace(/([0-9a-f]{8})([0-9a-f]{4})([0-9a-f]{4})([0-9a-f]{4})([0-9a-f]{12})/,"$1-$2-$3-$4-$5");}_[f1[j]][0]=h1;}}function O(i){var j=i.oAppComponent.getInboundParameters();return j?Object.keys(j).filter(function(Z){return j[Z].useForCreate;}):[];}function Q(j,Z){var $;var _=O(j);for(var i=0;i<_.length;i++){var a1=_[i];var b1=Z[a1];if(b1&&b1.length===1){$=$||Object.create(null);$[a1]=b1[0];}}return $;}function U(i,j,Z){var $=i.getODataEntityType(i.getODataEntitySet(j).entityType);$.property.forEach(function(_){if(_["com.sap.vocabularies.Common.v1.EditableFieldFor"]){var a1=_["com.sap.vocabularies.Common.v1.EditableFieldFor"].String;var b1=_.name;if(Z[a1]&&!Z[b1]){Z[b1]=Z[a1];}if(Z[b1]&&!Z[a1]){Z[a1]=Z[b1];}}});}function V(j,Z,$){var _=j.oAppComponent.getConfig();var a1;a1=j.oAppComponent.getModel();a1.attachMetadataFailed(j.fnInitializationResolve);a1.getMetaModel().loaded().then(function(){var b1;T(a1,Z,$);var c1=$.preferredMode&&$.preferredMode[0];var d1=$.mode&&$.mode[0];var e1=D(c1,d1);switch(e1.mode){case"create":P(j);var f1=(_.pages[0]&&_.pages[0].component&&_.pages[0].component.settings&&_.pages[0].component.settings.creationEntitySet);Z=f1||Z;var g1=Q(j,$);var h1=j.oAppComponent.getTransactionController().getDraftController();var i1=h1.getDraftContext().isDraftEnabled(Z);var j1=I.bind(null,j,$);if(i1){var k1=C.create(h1,Z,"/"+Z,a1,j.oTemplateContract.oApplicationProxy,g1);k1.then(function(i){j.navigateToContext(i,"",true,4).then(j1);},function(i){j1();j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:i.messageText,description:"",icon:"sap-icon://message-error"});});j.oTemplateContract.oBusyHelper.setBusy(k1,true);}else{j.navigateForNonDraftCreate(Z,g1).then(j1);}break;case"createWithContext":P(j);var l1=new Promise(function(q1,r1){var s1=function(y1){r1();I(j,$);j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_ERROR"),text:(y1&&y1.messageText)||j.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),icon:"sap-icon://message-error",description:""});};b1=a1.getMetaModel().getODataEntitySet(Z);var t1=b1["com.sap.vocabularies.Common.v1.DraftRoot"];if(t1&&t1.NewAction){var u1=a1.getMetaModel().getODataFunctionImport(t1.NewAction.String.split("/")[1]);var v1={};if(u1){var w1=u1.parameter?u1.parameter.length:0;for(var i=0;i<w1;i++){var x1=u1.parameter[i];if(x1.mode==="In"&&$[x1.name]&&$[x1.name][0]){v1[x1.name]=$[x1.name][0];}}a1.callFunction("/"+u1.name,{success:function(y1,z1){var A1=new M(a1);var B1=A1.getContextFromResponse(y1);if(B1){q1();j.navigateToContext(B1,null,true,4).then(I.bind(null,j,$));}else{s1();}},error:s1,method:"POST",urlParameters:v1});}else{s1();}}else{s1();}});j.oTemplateContract.oBusyHelper.setBusy(l1,true);break;case"edit":var m1=e({},$);U(a1.getMetaModel(),Z,m1);var n1=N(a1,j,Z,m1,e1);if(n1.aNavigablePages&&n1.aNavigablePages[0]&&(n1.aNavigablePages[0].bNavigationWithTechnicalKeyPossible||(n1.aNavigablePages[0].aSemanticKey&&n1.aNavigablePages[0].iLevel===0))){var o1="";var p1;if(n1.aNavigablePages[0].bNavigationWithTechnicalKeyPossible){o1=a1.createKey(Z,m1);p1=C.edit(j.oAppComponent.getTransactionController(),Z,"/"+o1,a1,j.oTemplateContract,j.fnInitializationResolve);}else if(n1.aNavigablePages&&n1.aNavigablePages[0]&&n1.aNavigablePages[0].aSemanticKey&&n1.aNavigablePages[0].iLevel===0){o1="";p1=C.edit(j.oAppComponent.getTransactionController(),Z,o1,a1,j.oTemplateContract,j.fnInitializationResolve,n1.aNavigablePages[0].aSemanticKey,m1);}p1.then(function(i){j.navigate(i.context.getPath(),true);I(j);},function(i){if(i.lockedByUser){if(!e1.force){G(a1,j,Z,$,e1);}else{j.fnInitializationResolve();j.navigateToMessagePage({title:j.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),text:j.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),description:j.oTemplateContract.getText("ST_GENERIC_LOCKED_OBJECT_POPOVER_TEXT",[i.lockedByUser]),icon:"sap-icon://message-error",replaceURL:true});}}else if(i.draftAdminReadResponse){I(j,$);}else{var q1=j.oTemplateContract.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_EDIT");c.warning(q1,{onClose:function(r1){G(a1,j,Z,$,{mode:"display",force:false});}});}});}else{I(j,$);}break;case"display":G(a1,j,Z,$,e1);break;default:j.fnInitializationResolve();j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),description:j.oTemplateContract.getText("PARAMETER_COMBINATION_NOT_SUPPORTED",[d1,c1]),icon:"sap-icon://message-error",replaceURL:true});}});}function W(i){var j=i.oAppComponent.getFlexibleColumnLayout();if(j){i.oTemplateContract.oFlexibleColumnLayoutHandler=new b(i.oTemplateContract.oNavigationHost,i);}var Z=m(i);var $=i.oAppComponent.getComponentData();var _=$&&$.startupParameters;if(Z&&_&&!i.oHashChanger.getHash()){V(i,Z,_);}else{I(i);}}function X(i,j){var Z,$,_;Z=i.getPath().substring(1);$=Z.split("(");_=$[0];var a1=$[1].substring(0,$[1].length-1);if(j){Z=Z.replace(_,j);if(Z.indexOf("/")===0){Z=Z.substring(1);}}return{entitySet:_,path:Z,key:a1};}function Y(){return g;}var m=t.testableStatic(m,"routingHelpergenerateRoutingMetadataAndGetRootEntitySet");var I=t.testableStatic(I,"routingHelper_initialiseRouting");var z=t.testableStatic(z,"routingHelper_readObject");var V=t.testableStatic(V,"routingHelper_processStartupParameters");var T=t.testableStatic(T,"routingHelper_transformStartupGuidParameters");return{startupRouter:W,determineNavigationPath:X,readObjectProcessResults:A,getCrossAppNavService:Y};});
