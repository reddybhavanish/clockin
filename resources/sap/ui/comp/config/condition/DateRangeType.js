/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery",'sap/ui/comp/config/condition/Type','sap/ui/Device','sap/ui/core/library','sap/m/library','sap/m/Input','sap/m/DatePicker','sap/m/Text','sap/m/Select','sap/ui/core/ListItem','sap/m/Label','sap/ui/core/date/UniversalDate','sap/ui/core/format/DateFormat','sap/ui/core/Locale','sap/ui/core/LocaleData','sap/ui/model/type/Integer','sap/ui/model/Sorter','sap/ui/model/Filter',"sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/ui/dom/jquery/cursorPos"],function(q,T,D,c,l,I,a,b,S,L,d,U,e,f,g,h,m,j,k,o){"use strict";var V=c.ValueState;var P=l.PlacementType;var R;var p;var B;var N=h.extend("sap.ui.model.type.NullableInteger",{parseValue:function(v,i){if(this.getPrimitiveType(i)=="string"){if(v===""){return null;}}return h.prototype.parseValue.apply(this,arguments);}});var r=T.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(F,i,n){T.apply(this,[F,i,n]);this.oDateFormat=i&&i._oDateFormatSettings?i._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=10000;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;}});r.prototype.applySettings=function(s){T.prototype.applySettings.apply(this,arguments);if(s&&s.ignoreTime){this._bIgnoreTime=s.ignoreTime;}};r.setStartTime=function(i){i=r.toUniversalDate(i);return o.resetStartTime(i);};r.setEndTime=function(i,n){i=r.toUniversalDate(i);if(!n){return o.resetEndTime(i);}else{return o.resetStartTime(i);}};r.toUniversalDate=function(i){if(i instanceof Date){return new U(i);}if(!i){return new U();}if(!(i instanceof U)){return r.toUniversalDate(new Date(i));}return i;};r.getWeekStartDate=function(u){return o.getWeekStartDate(u);};r.getMonthStartDate=function(u){return o.getMonthStartDate(u);};r.getQuarterStartDate=function(u){return o.getQuarterStartDate(u);};r.getYearStartDate=function(u){return o.getYearStartDate(u);};r.getDateRange=function(v,t,u,C,i){if(u===true){C=true;u=null;}if(!u){u=new U();}else{u=new U(u);}if(C){switch(t){case"DAY":break;case"WEEK":u=o.getWeekStartDate(u);break;case"MONTH":u=o.getMonthStartDate(u);break;case"QUARTER":u=o.getQuarterStartDate(u);break;case"YEAR":u=o.getYearStartDate(u);break;}}if(!i&&v>0){if(v!==0&&!isNaN(v)){var n=-1;switch(t){case"DAY":u.setDate(u.getDate()+n);break;case"WEEK":u.setDate(u.getDate()+(n*7));break;case"MONTH":u.setMonth(u.getMonth()+n);break;case"QUARTER":u.setMonth(u.getMonth()+(n*3));break;case"YEAR":u.setFullYear(u.getFullYear()+n);break;}}}return o.getRange(v,t,u,false);};r.getTextField=function(n,E){var s=T._createStableId(n,"text");if(n._oOperationSelect){var t=n._oOperationSelect.getAriaLabelledBy();var F=false;for(var i=0;i<t.length;i++){if(s===t[i]){F=true;break;}}if(!F){n._oOperationSelect.addAriaLabelledBy(s);}}if(E){return new b(s,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:n.oDateFormat.style,pattern:n.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:n.oDateFormat.style,pattern:n.oDateFormat.pattern})+"}"});}else{return new b(s,{text:{path:'$smartEntityFilter>value1',type:'sap.ui.model.type.Date',formatOptions:{style:n.oDateFormat.style,pattern:n.oDateFormat.pattern}}});}};r.getIntField=function(i){return new I(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new N({},{minimum:0,maximum:i._maxIntValue})},textAlign:"End",width:"100%"});};r.getIntFromToField=function(i,n,O){var s=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});s.addStyleClass("sapUiCompFilterBarCTPaddingTop");n.push(s);var C=i._createIntFromToControl(i,"fieldFrom","value1");s.setLabelFor(C);n.push(C);s=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});s.addStyleClass("sapUiCompFilterBarCTPaddingTop");n.push(s);var t=i._createIntFromToControl(i,"fieldTo","value2");s.setLabelFor(t);n.push(t);i._setIntControlBinding(C,O,"value1");i._setIntControlBinding(t,O,"value2");};r.ControlFactory=function(i,n,O){if(O.type==="range"){var C=r.getTextField(i,O.display!=="start");C.addStyleClass("sapUiCompFilterBarCTPaddingTop");n.push(C);return;}if(O.type==="int"){var C=r.getIntField(i);n.push(C);if(O.descriptionTextKeys){C.setFieldWidth("auto");C.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var t=O.descriptionTextKeys[0];var s=O.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return T.getTranslatedText(t);}else{return T.getTranslatedText(s||t);}}});}}if(O.type==="[int,int]"){r.getIntFromToField(i,n,O);}};r._defaultOnChangeHandler=function(v,i){if(v.toLowerCase()===this.languageText.toLowerCase()){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("inputstate","NONE",i.getContext());if(this.category.indexOf("FIXED")!==0){i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}return false;};r._IntOnChangeHandler=function(v,i){if(this.basicLanguageText.indexOf("{0}")>=0){var n=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$",'i');if(v.match(n)){var v=v.match(n)[1];if(v){var s=parseInt(v);if(!isNaN(s)&&s<=i._maxIntValue){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",s);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}}}return false;};r._IntFromToOnChangeHandler=function(v,i){if(this.basicLanguageText.indexOf("- {0}")>=0&&this.basicLanguageText.indexOf("+ {1}")>=0){var n=new RegExp(this.basicLanguageText.replace("/","\\/").replace("- {0}","(\\- (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)").replace("+ {1}","(\\+ (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)")+"$",'i');var s=v.match(n);if(s){var t=s[3];var u=s[9];if(t&&u){var w=parseInt(t);var x=parseInt(u);if(i._isValidFromToPeriod(w,x)){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",w);i.oModel.setProperty("/condition/value2",x);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}}}return false;};r._DateOnChangeHandler=function(v,i){if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var s=v.slice(this.languageText.length);if(s.length>0&&s[0]===" "){s=s.trim();if(s[0]==="("&&s[s.length-1]===")"){s=s.slice(1,s.length-1);}var n=i._getDateFormatter(true);var t=n.parse(s);if(t){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",t);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}}return false;};r._DateRangeOnChangeHandler=function(v,i){if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var s=v.slice(this.languageText.length).trim();if(s[0]==="("&&s[s.length-1]===")"){s=s.slice(1,s.length-1);}var n=s.split("-")[0];var t=s.split("-")[1];var u=i._getDateFormatter(true);var w=u.parse(n);var x=u.parse(t);if(w&&x){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",w);i.oModel.setProperty("/condition/value2",x);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}return false;};r._MonthOnChangeHandler=function(v,i){var M;var n=false;if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){M=v.slice(this.languageText.length).trim();if(M.indexOf("(")==0){M=M.slice(1);M=M.slice(0,M.length-1);}n=true;}else{M=v;}var s=this.getValueList();var t=-1;s.some(function(u,w){var n=u.text.toLowerCase()===M.toLowerCase();if(n){t=w;}return n;});if(t>-1){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",t);i.oModel.setProperty("inputstate","NONE",i.getContext());return true;}else{if(n){i.oModel.setProperty("inputstate","ERROR",i.getContext());}return n;}};r._DefaultFilterSuggestItem=function(v,n,s){var M=false;if(this.languageText.toLowerCase().startsWith(v.toLowerCase())){M=true;}else{var w=this.languageText.split(" ");for(var i=0;i<w.length;i++){var W=w[i];if(W.toLowerCase().startsWith(v.toLowerCase())){M=true;}}}n.setAdditionalText(this.textValue);n.setText(this.languageText);return M;};r._HideFilterSuggestItem=function(v,i,n){return false;};r._IntFilterSuggestItem=function(v,i,n){var x=this.basicLanguageText.indexOf("{0}");var s;var t;if(x>=0){s=this.basicLanguageText.slice(0,x).trim();t=this.basicLanguageText.slice(x+3).trim();}var u=v.split(" ");if(u.length<1||u.length>3){return false;}var M=false;var w;var y=function(v){return!!v.match(/(?!(0))(^[0-9]+$)/)&&parseInt(v)>0;};if(s.toLowerCase().startsWith(u[0].toLowerCase())){if(u[1]){if(y(u[1])){w=u[1];if(u[2]){if(t.toLowerCase().startsWith(u[2].toLowerCase())){M=true;}}else{M=true;}}}else{M=true;}}else if(y(u[0])&&u.length<3){w=u[0];if(u[1]){if(t.toLowerCase().startsWith(u[1].toLowerCase())){M=true;}}else{M=true;}}else if(t.toLowerCase().startsWith(u[0].toLowerCase())&&u.length==1){M=true;}if(M&&w){var z;switch(this.category){case"DYNAMIC.DATE.INT":z="DAY";break;case"DYNAMIC.WEEK.INT":z="WEEK";break;case"DYNAMIC.MONTH.INT":z="MONTH";break;case"DYNAMIC.QUARTER.INT":z="QUARTER";break;case"DYNAMIC.YEAR.INT":z="YEAR";break;default:z="DAY";break;}var A=parseInt(w),F=true;if(A>n._maxIntValue){M=false;}if(this.key.startsWith("LAST")){A=A*-1;F=false;}var C;if(this.getDateRange){var E=this.getDateRange({operation:this.key,value1:A});C=[E.value1,E.value2];}else{C=r.getDateRange(A,z,true,F,F);}var G=n._getDateFormatter(true);if(Math.abs(A)===1&&this.singulareBasicLanguageText){i.setText(this.singulareBasicLanguageText);if(z!=="DAY"){i.setAdditionalText(G.format(C[0])+" - "+G.format(C[1]));}else{i.setAdditionalText(G.format(C[0]));}}else{i.setText(n._fillNumberToText(this.basicLanguageText,w));i.setAdditionalText(G.format(C[0])+" - "+G.format(C[1]));}i._value1=parseInt(w);}else{i.setAdditionalText(null);i.setText(this.languageText);i._value1=null;}return M;};r._IntFromToFilterSuggestItem=function(v,i,n){var s=new RegExp("(\\- ([0-9]+))",'i'),t=new RegExp("(\\+ ([0-9]+))",'i'),u=new RegExp("(\\- ((\\(-)?([0-9]+)(\\)))?)",'i'),w=new RegExp("(\\+ ((\\(-)?([0-9]+)(\\)))?)",'i'),F=v.match(s),x=v.match(t),y=v.match(u),z=v.match(w);if((!F&&!y)||(!x&&!z)){i.setAdditionalText(null);i.setText(this.languageText);i._value1=null;i._value2=null;return false;}var A=function(K,M){if(K&&!isNaN(K[2])){return parseInt(K[2]);}else if(M&&M[2]){var v=M[2].replace("(","").replace(")","");if(!isNaN(v)){return parseInt(v);}}return null;},C,E;C=A(F,y);E=A(x,z);if(!n._isValidFromToPeriod(C,E)){i.setAdditionalText(null);i.setText(this.languageText);i._value1=null;i._value2=null;return false;}var G=n._getDateFormatter(true),H,J;H=n._getTodayFromToValueFrom(C);J=n._getTodayFromToValueTo(E);i.setText(n._fillNumberToText(this.basicLanguageText,C,E));i.setAdditionalText(G.format(H)+" - "+G.format(J));i._value1=C;i._value2=E;return true;};r._DateFilterSuggestItem=function(v,i,n){var s=n._getDateFormatter(true);var t=s.parse(v);if(t){i.setText(this.languageText+" ("+s.format(t)+")");i._value1=t;return true;}else{i.setText(this.languageText);i._value1=null;return false;}};r._DateRangeFilterSuggestItem=function(v,i,n){var s=n._getDateFormatter(true);var t,u;var w="-";var x=false;var y=v.split(w);if(y.length===2){if(y[0].slice(y[0].length-1,y[0].length)==" "){y[0]=y[0].slice(0,y[0].length-1);}if(y[1].slice(0,1)==" "){y[1]=y[1].slice(1);}}else{y=v.split(" "+w+" ");}if(y.length<2){var z=v.split(" ");if(z.length===2){y=z;}}if(y.length>=1&&y.length<=2){t=s.parse(y[0]);if(t){i._value1=t;if(y.length==2&&y[1]===""){y.splice(1,1);}if(y.length==2){u=s.parse(y[1]);if(u){i._value2=u;x=true;i.setText(this.languageText+" ("+s.format(t)+" "+w+" "+s.format(u)+")");}}else{x=true;i.setText(this.languageText+" ("+s.format(t)+" "+w+")");}}}if(!x){i.setText(this.languageText);i._value1=null;i._value2=null;}return x;};r._MonthFilterSuggestItem=function(v,n,s){var M=false;n._value1=null;var t=this.getValueList();for(var i=0;i<t.length;i++){var u=t[i];M=u.text.toLowerCase().startsWith(v.toLowerCase());if(M){n.setText(this.languageText+" ("+u.text+")");n._value1=i;break;}}return M;};r._DefaultOnItemSelected=function(v,i,n){n.oModel.setProperty("/condition/operation",this.key);if("value1"in this){n.oModel.setProperty("/condition/value1",i._value1);}if("value2"in this){n.oModel.setProperty("/condition/value2",i._value2);}n.oModel.setProperty("inputstate","NONE",n.getContext());n._bSuggestItemSelected=true;};r._IntOnItemSelected=function(v,i,n){var s=i._value1;n.oModel.setProperty("/condition/operation",this.key);n.oModel.setProperty("/condition/value1",s);n.oModel.setProperty("inputstate","NONE",n.getContext());n._bSuggestItemSelected=true;};r._IntOnItemsSelected=function(v,i,n){var s=i._value1;var t=i._value2;n.oModel.setProperty("/condition/operation",this.key);n.oModel.setProperty("/condition/value1",s);n.oModel.setProperty("/condition/value2",t);n.oModel.setProperty("inputstate","NONE",n.getContext());n._bSuggestItemSelected=true;};r.getFixedRangeOperation=function(K,t,C,i,F,O){return{key:K,textKey:t,category:C,order:O||100,defaultValues:i||null,type:"range",display:"range",filterSuggestItem:F||r._DefaultFilterSuggestItem,onItemSelected:r._DefaultOnItemSelected,getControls:r.ControlFactory};};r.createSingleIntRangeOperation=function(K,t,s,C,i,n,O){return{key:K,textKey:t,singularTextKey:s,category:C,order:O,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:n,onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory,_getInitialValues:function(u){return[u.value1,u.value2];}};};r.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:r._DateRangeOnChangeHandler,filterSuggestItem:r._DateRangeFilterSuggestItem,onItemSelected:r._DefaultOnItemSelected,getControls:function(i,n){var s=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});s.addStyleClass("sapUiCompFilterBarCTPaddingTop");n.push(s);var C=new a(T._createStableId(i,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");C.setValueState(v?V.None:V.Error);}});s.setLabelFor(C);n.push(C);s=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});s.addStyleClass("sapUiCompFilterBarCTPaddingTop");n.push(s);var t=new a(T._createStableId(i,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");t.setValueState(v?V.None:V.Error);}});s.setLabelFor(t);n.push(t);}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:r._DateOnChangeHandler,filterSuggestItem:r._DateFilterSuggestItem,onItemSelected:r._DefaultOnItemSelected,getControls:function(i,n){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});n.push(C);}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:r._DateOnChangeHandler,filterSuggestItem:r._DateFilterSuggestItem,onItemSelected:r._DefaultOnItemSelected,getControls:function(i,n){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});n.push(C);}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:r._DateOnChangeHandler,filterSuggestItem:r._DateFilterSuggestItem,onItemSelected:r._DefaultOnItemSelected,getControls:function(i,n,O){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});n.push(C);}},LASTDAYS:r.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4),LASTWEEKS:r.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:r._IntOnChangeHandler,filterSuggestItem:r._IntFilterSuggestItem,onItemSelected:r._IntOnItemSelected,getControls:r.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var i=new U();return[i.getMonth()];},value1:null,onChange:r._MonthOnChangeHandler,onItemSelected:r._DefaultOnItemSelected,filterSuggestItem:r._MonthFilterSuggestItem,getControls:function(i,n,O){var s=new S(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});s.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new L({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});n.push(s);},getValueList:function(){var n=new U(),M=[],F=e.getDateInstance({pattern:"LLLL"});n.setDate(15);n.setMonth(0);for(var i=0;i<12;i++){M.push({text:F.format(n),key:i});n.setMonth(n.getMonth()+1);}return M;}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return o.ranges.yesterday();},type:"range",display:"start",onChange:r._defaultOnChangeHandler,onItemSelected:r._DefaultOnItemSelected,getControls:r.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return o.ranges.today();},type:"range",display:"start",onChange:r._defaultOnChangeHandler,onItemSelected:r._DefaultOnItemSelected,getControls:r.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var i=o.ranges.tomorrow();return i;},type:"range",display:"start",onChange:r._defaultOnChangeHandler,onItemSelected:r._DefaultOnItemSelected,getControls:r.ControlFactory},THISWEEK:r.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return o.ranges.currentWeek();},r._DefaultFilterSuggestItem,6),LASTWEEK:r.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return o.ranges.lastWeek();},r._DefaultFilterSuggestItem,7),LAST2WEEKS:r.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return o.ranges.lastWeeks(-2);},r._HideFilterSuggestItem,-1),LAST3WEEKS:r.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return o.ranges.lastWeeks(-3);},r._HideFilterSuggestItem,-1),LAST4WEEKS:r.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return o.ranges.lastWeeks(-4);},r._HideFilterSuggestItem,-1),LAST5WEEKS:r.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return o.ranges.lastWeeks(-5);},r._HideFilterSuggestItem,-1),NEXTWEEK:r.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return o.ranges.nextWeek();},r._DefaultFilterSuggestItem,9),NEXT2WEEKS:r.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return o.ranges.nextWeeks(2);},r._HideFilterSuggestItem,-1),NEXT3WEEKS:r.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return o.ranges.nextWeeks(3);},r._HideFilterSuggestItem,-1),NEXT4WEEKS:r.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return o.ranges.nextWeeks(4);},r._HideFilterSuggestItem,-1),NEXT5WEEKS:r.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return o.ranges.nextWeeks(5);},r._HideFilterSuggestItem,-1),THISMONTH:r.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return o.ranges.currentMonth();},r._DefaultFilterSuggestItem,12),LASTMONTH:r.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return o.ranges.lastMonth();},r._DefaultFilterSuggestItem,13),NEXTMONTH:r.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return o.ranges.nextMonth();},r._DefaultFilterSuggestItem,15),THISQUARTER:r.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return o.ranges.currentQuarter();},r._DefaultFilterSuggestItem,17),LASTQUARTER:r.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return o.ranges.lastQuarter();},r._DefaultFilterSuggestItem,18),NEXTQUARTER:r.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return o.ranges.nextQuarter();},r._DefaultFilterSuggestItem,20),YEARTODATE:r.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return o.ranges.yearToDate();},r._DefaultFilterSuggestItem,31),THISYEAR:r.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return o.ranges.currentYear();},r._DefaultFilterSuggestItem,26),LASTYEAR:r.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return o.ranges.lastYear();},r._DefaultFilterSuggestItem,27),NEXTYEAR:r.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return o.ranges.nextYear();},r._DefaultFilterSuggestItem,29),QUARTER1:r.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){return o.ranges.quarter(1);},r._DefaultFilterSuggestItem,22),QUARTER2:r.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){return o.ranges.quarter(2);},r._DefaultFilterSuggestItem,23),QUARTER3:r.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){return o.ranges.quarter(3);},r._DefaultFilterSuggestItem,24),QUARTER4:r.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){return o.ranges.quarter(4);},r._DefaultFilterSuggestItem,25),TODAYFROMTO:{key:"TODAYFROMTO",textKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",singularTextKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null,descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:r._IntFromToOnChangeHandler,filterSuggestItem:r._IntFromToFilterSuggestItem,onItemSelected:r._IntOnItemsSelected,getControls:r.ControlFactory}};r.prototype.getControls=function(O){var C=[];if(!O){return;}O.getControls(this,C,O);return C;};r.prototype.setIgnoreTime=function(i){this._bIgnoreTime=i;};T.prototype.getIgnoreTime=function(i){return this._bIgnoreTime;};r.prototype.getDefaultValues=function(O){if(!O){return[];}var i=O.defaultValues||[];if(typeof i==="function"){i=O.defaultValues();}var C=this.getCondition(),v=i[0]||null,n=i[1]||null;if(O.key==="DATERANGE"&&C&&C.value1&&C.value2){v=C.value1.oDate||C.value1;n=C.value2.oDate||C.value2;}else{if(v instanceof Date){v=new U(v);}if(n instanceof Date){n=new U(n);}}return[v,n];};r.prototype.getOperations=function(){var O=[];for(var n in r.Operations){var i=r.Operations[n];if(this._filterOperation(i)){O.push(i);}}return O;};r.prototype._updateOperation=function(O){T.prototype._updateOperation.apply(this,[O]);if(O.languageText&&!O.basicLanguageText){O.basicLanguageText=O.languageText;if(!O.singulareBasicLanguageText&&O.singularTextKey){O.singulareBasicLanguageText=this.getTranslatedText(O.singularTextKey);}O.languageText=this._fillNumberToText(O.languageText);}if(O.display){var i=this.getDefaultValues(O);var n=this._getDateFormatter(false);if(O.display==="start"){O.textValue=n.format(i[0].oDate);}else if(O.display==="range"&&i&&i[0]&&i[1]){O.textValue=n.format(i[0].oDate)+" - "+n.format(i[1].oDate);}}O.suggestText=O.languageText;};r.prototype.updateOperations=function(){var O=this.getOperations();for(var i=0;i<O.length;i++){this._updateOperation(O[i]);}return this.oModel.setProperty("operations",O,this.getContext(),true);};r.prototype.isValidCondition=function(){var C=this.getCondition(),O=this.getOperation(C.operation);if(O&&C&&C.key&&C.operation){if("value1"in O&&"value2"in O){return"value1"in C&&C.value1!==null&&"value2"in C&&C.value2!==null;}else if("value1"in O){return"value1"in C&&C.value1!==null;}else if("value2"in O){return"value2"in C&&C.value2!==null;}else if(!("value1"in O)&&!("value2"in O)){return true;}}return false;};r.prototype.providerDataUpdated=function(u,i){};r.prototype.initialize=function(J){T.prototype.initialize.apply(this,[J]);this.oModel.suspend();var O=Object.assign({},J,true);var C=(new U()).getCalendarType();if(!J.conditionTypeInfo){if(J.ranges&&J.ranges.length==1){var s="DATERANGE";if(J.ranges[0].operation==="GE"){s="FROM";}if(J.ranges[0].operation==="LE"){s="TO";}J.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:s,value1:J.ranges[0].value1,value2:J.ranges[0].value2,calendarType:C}};}else{var i=this.getDefaultOperation(),K=i?i.key:"";J.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:K,calendarType:C}};}}if(J.conditionTypeInfo){J=J.conditionTypeInfo;}if(J.name&&J.data){if(J.name!==this.getName()){k.debug("ConditionType "+this.getName()+" tries to deserialize data from "+J.name);}J=J.data;}if(!J.operation){return;}if(this.getOperation(J.operation)&&this.getOperation(J.operation).order<0){var n=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(J.operation);if(n>=0){J.operation="LASTWEEKS";J.value1=n+2;}n=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(J.operation);if(n>=0){J.operation="NEXTWEEKS";J.value1=n+2;}}var t=this.getOperation(J.operation);if(!t){if(this.getAsync()){this.setPending(true);var u=this,H=function(E){if(E.getParameter("pending")===false){u.oFilterProvider.detachPendingChange(H);u.initialize(O);}};this.oFilterProvider.attachPendingChange(H);this.oModel.resume();return;}}var v;if(C!==J.calendarType&&(J.calendarType==="Islamic"||C==="Islamic")&&J.operation==="SPECIFICMONTH"){J.operation="DATERANGE";var w=parseInt(J.value1),x=U.getInstance(new Date(),J.calendarType);x.setMonth(w);x=o.getMonthStartDate(x);v=o.getRange(0,"MONTH",x);J.value1=v[0].oDate.toISOString();J.value2=v[1].oDate.toISOString();}var y=this.getConditionContext().getObject();y.operation=J.operation;y.key=J.key;y.value1=null;y.value2=null;if(J.operation==="DATERANGE"){if(typeof J.value1==="string"){J.value1=J.value1===""?null:(new U(J.value1)).oDate;}if(typeof J.value2==="string"){J.value2=J.value2===""?null:(new U(J.value2)).oDate;}y.value1=J.value1;y.value2=J.value2;}else if(["DATE","FROM","TO"].indexOf(J.operation)!==-1){if(typeof J.value1==="string"){J.value1=J.value1===""?null:(new U(J.value1)).oDate;}y.value1=J.value1;}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(J.operation)>-1){y.value1=J.value1;}else if(J.operation==="SPECIFICMONTH"){y.value1=J.value1+"";}else if(J.operation==="TODAYFROMTO"){y.value1=J.value1;y.value2=J.value2;}else{t=this.getOperation(J.operation);v=t&&t._getInitialValues?t._getInitialValues(J):null;if(!v){v=this.getDefaultValues(t);}y.value1=v[0];y.value2=v[1];}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);};r.prototype.serialize=function(u,F){var J={},C=this.getCondition();if(!C.operation){return null;}var O=this.getOperation(C.operation);if(!O||!("value1"in O)){C.value1=null;}if(!O||!("value2"in O)){C.value2=null;}C.calendarType=(new U()).getCalendarType();J.conditionTypeInfo={name:this.getName(),data:C};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer;}if(u){this._updateProvider(J,true,F);}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,J,false,F),1);}return J;};r.prototype._updateProvider=function(J,s,F){J.ranges=this.getFilterRanges();J.items=[];var i=false;var C=0;var n=0;var t=0;if(this.oModel.getData().currentoperation.languageText){var u=this.oModel.getData();var v=u.currentoperation.languageText;if(u.currentoperation.basicLanguageText.indexOf("{0}")>=0&&u.currentoperation.basicLanguageText.indexOf("{1}")>=0){if(J.conditionTypeInfo.data.value1!=null&&J.conditionTypeInfo.data.value1!==""&&J.conditionTypeInfo.data.value2!=null&&J.conditionTypeInfo.data.value2!==""){v=this._fillNumberToText(u.currentoperation.basicLanguageText,J.conditionTypeInfo.data.value1,J.conditionTypeInfo.data.value2);}this.oModel.setProperty("inputstate","NONE",this.getContext());if(!this._isValidFromToPeriod(J.conditionTypeInfo.data.value1,J.conditionTypeInfo.data.value2)){this.oModel.setProperty("inputstate","ERROR",this.getContext());}}else if(u.currentoperation.basicLanguageText.indexOf("{0}")>=0){if(J.conditionTypeInfo.data.value1!=null&&J.conditionTypeInfo.data.value1!=""){if(J.conditionTypeInfo.data.value1===1&&u.currentoperation.singulareBasicLanguageText){v=u.currentoperation.singulareBasicLanguageText;}else{v=this._fillNumberToText(u.currentoperation.basicLanguageText,J.conditionTypeInfo.data.value1);}this.oModel.setProperty("inputstate","NONE",this.getContext());}else if(this._bSuggestItemSelected){v=this._fillNumberToText(u.currentoperation.basicLanguageText);var x=u.currentoperation.basicLanguageText.indexOf("{0}");C=x+1;n=x;t=x+1;i=true;}else{v="";this.oModel.setProperty("inputstate","NONE",this.getContext());}}else if(u.currentoperation.textValue){v=u.currentoperation.languageText+" ("+u.currentoperation.textValue+")";this.oModel.setProperty("inputstate","NONE",this.getContext());}else{if(J.conditionTypeInfo.data.value1!==null&&J.conditionTypeInfo.data.value1!==""){var w=J.conditionTypeInfo.data.value1;var y=J.conditionTypeInfo.data.value2;var z;if(typeof w==="number"&&u.currentoperation.valueList){z=u.currentoperation.valueList[w].text;}else if(w instanceof Date){var A=this._getDateFormatter(false);if(J.conditionTypeInfo.data.operation!=="DATERANGE"&&(w&&!y)){z=A.format(w);}else if(J.conditionTypeInfo.data.operation==="DATERANGE"&&w&&y){z=A.format(w)+" - "+A.format(y);}else if(J.conditionTypeInfo.data.operation==="DATERANGE"&&w&&!y&&!(this._oPopup&&this._oPopup.isOpen())){z=A.format(w)+" - ";i=true;}else{z="";}}else{z=J.conditionTypeInfo.data.value1;}if(z){v=u.currentoperation.languageText+" ("+z+")";C=v.length-1;this.oModel.setProperty("inputstate","NONE",this.getContext());}else{v="";}}else{v="";}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",v);if(i&&!(this._oPopup&&this._oPopup.isOpen())){this._oInput.$("inner").cursorPos(C);if(n<t){this._oInput.selectText(n,t);}this._oInput._lastValue="";}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,J);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(F&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange();}}};r.prototype.getFilterRanges=function(){var C=this.getCondition(),v=[],i;if(C.operation==="LASTDAYS"){v=o.ranges.lastDays(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTWEEKS"){v=o.ranges.lastWeeks(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTMONTHS"){v=o.ranges.lastMonths(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTQUARTERS"){v=o.ranges.lastQuarters(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTYEARS"){v=o.ranges.lastYears(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTDAYS"){v=o.ranges.nextDays(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTWEEKS"){v=o.ranges.nextWeeks(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTMONTHS"){v=o.ranges.nextMonths(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTQUARTERS"){v=o.ranges.nextQuarters(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTYEARS"){v=o.ranges.nextYears(C.value1);C.value1=v[0];C.value2=v[1];}else if(C.operation==="SPECIFICMONTH"){var n=parseInt(C.value1),s=new U();s.setMonth(n);s=o.getMonthStartDate(s);v=o.getRange(0,"MONTH",s);C.value1=v[0];C.value2=v[1];}else if(C.operation==="TODAYFROMTO"){C.value1=this._getTodayFromToValueFrom(parseInt(C.value1));C.value2=this._getTodayFromToValueTo(parseInt(C.value2));}else{var O=this.getOperation(C.operation);if(O&&O.getDateRange){i=O.getDateRange(C);if(!i){return[];}C.value1=i&&i.value1?i.value1:null;C.value2=i&&i.value2?i.value2:null;}}if(C.value1 instanceof U){C.value1=C.value1.oDate;}if(C.value2 instanceof U){C.value2=C.value2.oDate;}if(C.operation==="DATE"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="BT";C.value2=C.value1;C.value1=r.setStartTime(C.value1).oDate;C.value2=r.setEndTime(C.value2,this._bIgnoreTime,this._Precision).oDate;}else if(C.operation==="FROM"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="GE";delete C.value2;}else if(C.operation==="TO"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="LE";delete C.value2;C.value1=r.setEndTime(C.value1,this._bIgnoreTime).oDate;}else{if(i){C.operation=i.operation;C.value1=C.value1?r.setStartTime(C.value1).oDate:null;C.value2=C.value2?r.setEndTime(C.value2,this._bIgnoreTime).oDate:null;}else{if(!(this.isValidCondition()&&C.value1&&C.value2)){return[];}C.operation="BT";C.value1=r.setStartTime(C.value1).oDate;C.value2=r.setEndTime(C.value2,this._bIgnoreTime).oDate;}}C.exclude=false;C.keyField=C.key;delete C.key;return[C];};r.prototype.getTokenText=function(){return"";};r.prototype.getName=function(){return this.getMetadata().getName();};r.prototype.getType=function(){return"Edm.Date";};r.prototype._bindValueState=function(C){C.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return V.Error;}else{return V.None;}}});};r.prototype.initializeFilterItem=function(){this._oInput=new I(T._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var i,n,s=this._oList.$().find('.sapMDLILabel, .sapMSLITitleOnly');for(i=0;i<s.length;i++){n=s[i];n.innerHTML=this._createHighlightedText(n);}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new m("order",false,false),filters:new j("order",function(v){return v!==undefined&&v>-1;}),template:new L({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(v,i){if(this._oPopup&&this._oPopup.isOpen()){return false;}var O=this.getOperation(i.getKey());v=v.trim();if(v==="?"){r._DefaultFilterSuggestItem.call(O,v,i,this);return O.category!=="DYNAMIC.DATERANGE"&&O.category!=="DYNAMIC.DATE";}if(O.filterSuggestItem){return O.filterSuggestItem(v,i,this);}else{return r._DefaultFilterSuggestItem.call(O,v,i,this);}}.bind(this));this._oInput.attachSuggestionItemSelected(function(E){var i=E.getParameter("selectedItem");if(!i){return;}var O=i.getKey();var n=this.getOperation(O);var v=E.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(v,i,this);return;}else{r._DefaultOnItemSelected.call(n,v,i,this);}}.bind(this));this._oInput.attachChange(function(E){var v=E.getParameter("value");if(v){var O=this.getOperations();var H=O.some(function(i){if(i.onChange){return i.onChange(v,this);}else{return r._defaultOnChangeHandler.call(i,v,this);}},this);if(!H){this.oModel.setProperty("inputstate","ERROR",this.getContext());}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext());}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(E){if(q(E.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close();}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput;};r.prototype._toggleOpen=function(E){if(!this._oPopup){if((!R||!p||(D.system.phone&&!B))&&!this._bPopoverRequested){R=sap.ui.require("sap/m/ResponsivePopover");p=sap.ui.require("sap/m/VBox");if(D.system.phone){B=sap.ui.require("sap/m/Button");if(!R||!p||!B){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],_.bind(this));this._bPopoverRequested=true;}}else if(!R||!p){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],_.bind(this));this._bPopoverRequested=true;}}if(!R||!p||(D.system.phone&&!B)){return;}this._oPopupLayout=new p();this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new R({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:P.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem",afterClose:function(){if(this.oFilterProvider._oSmartFilter.getLiveMode()){var i=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(i.LIVE_MODE_INTERVAL);}}.bind(this)});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(D.system.phone){this._oPopup.setBeginButton(new B({text:T.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(E){this._oPopup.close();}.bind(this)}));}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setAutoCloseAreas([this._oInput.getDomRef()]);}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon());}else{this._oPopup.close();}};function _(i,v,n){R=i;p=v;B=n;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen();}}r.prototype._getDateFormatter=function(s){var F={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:s};if(JSON.stringify(F)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(F);this._oDateFormatter=e.getInstance(F);}return this._oDateFormatter;};r.prototype._fillNumberToText=function(t,n,i){var s="X",u="Y";if(n){s=String(n);}if(i||i===0){u=String(i);if(n<0){s="("+s+")";}if(n===0){s=String(n);}if(i<0){u="("+u+")";}}t=t.replace("{0}",s);t=t.replace("{1}",u);return t;};r.prototype._setIntControlBinding=function(C,O,v){C.setFieldWidth("auto");C.bindProperty("description",{path:"$smartEntityFilter>"+v,type:"sap.ui.model.type.Integer",formatter:function(){var t=O.descriptionTextKeys[0];var s=O.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return T.getTranslatedText(t);}else{return T.getTranslatedText(s||t);}}});};r.prototype._createIntFromToControl=function(i,s,v){return new I(T._createStableId(i,s),{value:{path:"$smartEntityFilter>"+v,type:new N({},{minimum:-i._maxIntValue,maximum:i._maxIntValue})},ariaLabelledBy:i._oOperationSelect||null,textAlign:"End",width:"100%"});};r.prototype._isValidFromToPeriod=function(v,i){if((!v&&v!==0)||isNaN(v)){return false;}if((!i&&i!==0)||isNaN(i)){return false;}if(v<-this._maxIntValue||v>this._maxIntValue){return false;}if(i<-this._maxIntValue||i>this._maxIntValue){return false;}if((v<0&&Math.abs(v)>Math.abs(i))||(v===0&&i<0)||(i<0&&Math.abs(i)>Math.abs(v))||(i===0&&v<0)||(v<0&&i<0)){return false;}return true;};r.prototype._getTodayFromToValueFrom=function(v){if(v<0){var i=new o.getRange((-1*v),"DAY")[1];i.setHours(0,0,0);return i;}return new o.getRange(-v,"DAY")[0];};r.prototype._getTodayFromToValueTo=function(v){if(v<0){var i=new o.getRange(v,"DAY")[0];i.setHours(23,59,59);return i;}return new o.getRange(v,"DAY")[1];};r.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer;}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy();}T.prototype.destroy.apply(this,arguments);};return r;});
