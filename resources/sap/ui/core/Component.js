/*
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/thirdparty/jquery','./Manifest','./ComponentMetadata','./Element','sap/base/util/merge','sap/ui/base/ManagedObject','sap/ui/base/ManagedObjectRegistry','sap/ui/thirdparty/URI','sap/ui/performance/trace/Interaction','sap/base/assert','sap/base/Log','sap/base/util/ObjectPath','sap/base/util/UriParameters','sap/base/util/isPlainObject','sap/base/util/LoaderExtensions','sap/ui/VersionInfo'],function(q,M,C,E,a,b,c,U,I,d,L,O,f,g,h,V){"use strict";var j={JSON:"JSON",XML:"XML",HTML:"HTML",JS:"JS",Template:"Template"};var S={lazy:"lazy",eager:"eager",waitFor:"waitFor"};function k(e){['sap-client','sap-server'].forEach(function(N){if(!e.hasSearch(N)){var v=sap.ui.getCore().getConfiguration().getSAPParam(N);if(v){e.addSearch(N,v);}}});}function l(D,m,e,i){if(e){for(var N in D){if(!m[N]&&e[N]&&e[N].uri){m[N]=i;}}}}function n(m,e,K,i){var D=e.getEntry(K);if(D!==undefined&&!g(D)){return D;}var P,v;if(i&&(P=m.getParent())instanceof C){v=P.getManifestEntry(K,i);}if(v||D){D=q.extend(true,{},v,D);}return D;}function o(e,i){var v=Object.create(Object.getPrototypeOf(e));v._oMetadata=e;v._oManifest=i;for(var m in e){if(!/^(getManifest|getManifestObject|getManifestEntry|getMetadataVersion)$/.test(m)&&typeof e[m]==="function"){v[m]=e[m].bind(e);}}v.getManifest=function(){return i&&i.getJson();};v.getManifestObject=function(){return i;};v.getManifestEntry=function(K,A){return n(e,i,K,A);};v.getMetadataVersion=function(){return 2;};return v;}function r(e,i,T){d(typeof e==="function","fn must be a function");var m=b._sOwnerId;try{b._sOwnerId=i;return e.call(T);}finally{b._sOwnerId=m;}}var p=b.extend("sap.ui.core.Component",{constructor:function(i,m){var e=Array.prototype.slice.call(arguments);if(typeof i!=="string"){m=i;i=undefined;}if(m&&typeof m._metadataProxy==="object"){this._oMetadataProxy=m._metadataProxy;this._oManifest=m._metadataProxy._oManifest;delete m._metadataProxy;this.getMetadata=function(){return this._oMetadataProxy;};}if(m&&typeof m._cacheTokens==="object"){this._mCacheTokens=m._cacheTokens;delete m._cacheTokens;}if(m&&Array.isArray(m._activeTerminologies)){this._aActiveTerminologies=m._activeTerminologies;delete m._activeTerminologies;}if(m&&typeof m._manifestModels==="object"){this._mManifestModels=m._manifestModels;delete m._manifestModels;}else{this._mManifestModels={};}this._mServices={};b.apply(this,e);},metadata:{stereotype:"component","abstract":true,specialSettings:{componentData:'any'},version:"0.0",includes:[],dependencies:{libs:[],components:[],ui5version:""},config:{},customizing:{},library:"sap.ui.core"}},C);c.apply(p,{onDeregister:function(e){E.registry.forEach(function(i){if(i._sapui_candidateForDestroy&&i._sOwnerId===e&&!i.getParent()){L.debug("destroying dangling template "+i+" when destroying the owner component");i.destroy();}});}});p.prototype.getManifest=function(){if(!this._oManifest){return this.getMetadata().getManifest();}else{return this._oManifest.getJson();}};p.prototype.getManifestEntry=function(K){return this._getManifestEntry(K);};p.prototype._getManifestEntry=function(K,m){if(!this._oManifest){return this.getMetadata().getManifestEntry(K,m);}else{return n(this.getMetadata(),this._oManifest,K,m);}};p.prototype.getManifestObject=function(){if(!this._oManifest){return this.getMetadata().getManifestObject();}else{return this._oManifest;}};p.prototype._isVariant=function(){if(this._oManifest){var e=this.getManifestEntry("/sap.ui5/componentName");return e&&e!==this.getManifestEntry("/sap.app/id");}else{return false;}};p.activateCustomizing=function(e){};p.deactivateCustomizing=function(e){};p.getOwnerIdFor=function(e){d(e instanceof b,"oObject must be given and must be a ManagedObject");var i=(e instanceof b)&&e._sOwnerId;return i||undefined;};p.getOwnerComponentFor=function(e){return p.get(p.getOwnerIdFor(e));};p.prototype.runAsOwner=function(e){return r(e,this.getId());};p.prototype.getInterface=function(){return this;};p.prototype._initCompositeSupport=function(m){this.oComponentData=m&&m.componentData;if(!this._isVariant()){this.getMetadata().init();}else{this._oManifest.init(this);var A=this._oManifest.getEntry("/sap.app/id");if(A){w(A,this._oManifest.resolveUri("./","manifest"));}}this.initComponentModels();if(this.onWindowError){this._fnWindowErrorHandler=q.proxy(function(e){var i=e.originalEvent;this.onWindowError(i.message,i.filename,i.lineno);},this);q(window).on("error",this._fnWindowErrorHandler);}if(this.onWindowBeforeUnload){this._fnWindowBeforeUnloadHandler=q.proxy(this.onWindowBeforeUnload,this);q(window).on("beforeunload",this._fnWindowBeforeUnloadHandler);}if(this.onWindowUnload){this._fnWindowUnloadHandler=q.proxy(this.onWindowUnload,this);q(window).on("unload",this._fnWindowUnloadHandler);}};p.prototype.destroy=function(){for(var e in this._mServices){if(this._mServices[e].instance){this._mServices[e].instance.destroy();}}delete this._mServices;for(var m in this._mManifestModels){this._mManifestModels[m].destroy();}delete this._mManifestModels;if(this._fnWindowErrorHandler){q(window).off("error",this._fnWindowErrorHandler);delete this._fnWindowErrorHandler;}if(this._fnWindowBeforeUnloadHandler){q(window).off("beforeunload",this._fnWindowBeforeUnloadHandler);delete this._fnWindowBeforeUnloadHandler;}if(this._fnWindowUnloadHandler){q(window).off("unload",this._fnWindowUnloadHandler);delete this._fnWindowUnloadHandler;}if(this._oEventBus){this._oEventBus.destroy();delete this._oEventBus;}b.prototype.destroy.apply(this,arguments);sap.ui.getCore().getMessageManager().unregisterObject(this);if(!this._isVariant()){this.getMetadata().exit();}else{this._oManifest.exit(this);delete this._oManifest;}};p.prototype.getComponentData=function(){return this.oComponentData;};p.prototype.getEventBus=function(){if(!this._oEventBus){var e=this.getMetadata().getName();L.warning("Synchronous loading of EventBus, due to #getEventBus() call on Component '"+e+"'.","SyncXHR",null,function(){return{type:"SyncXHR",name:e};});var i=sap.ui.requireSync("sap/ui/core/EventBus");this._oEventBus=new i();}return this._oEventBus;};p.prototype.initComponentModels=function(){var m=this.getMetadata();if(m.isBaseClass()){return;}var e=this._getManifestEntry("/sap.app/dataSources",true)||{};var i=this._getManifestEntry("/sap.ui5/models",true)||{};this._initComponentModels(i,e,this._mCacheTokens);};p.prototype._initComponentModels=function(m,D,e){var A=p._createManifestModelConfigurations({models:m,dataSources:D,component:this,mergeParent:true,cacheTokens:e,activeTerminologies:this.getActiveTerminologies()});if(!A){return;}var i={};for(var v in A){if(!this._mManifestModels[v]){i[v]=A[v];}}var B=p._createManifestModels(i,this.toString());for(var v in B){this._mManifestModels[v]=B[v];}for(var v in this._mManifestModels){var F=this._mManifestModels[v];this.setModel(F,v||undefined);}};p.prototype.getService=function(e){if(!this._mServices[e]){this._mServices[e]={};this._mServices[e].promise=new Promise(function(R,i){sap.ui.require(["sap/ui/core/service/ServiceFactoryRegistry"],function(m){var v=this._getManifestEntry("/sap.ui5/services/"+e,true);var A=v&&v.factoryName;if(!A){i(new Error("Service "+e+" not declared!"));return;}var B=m.get(A);if(B){B.createInstance({scopeObject:this,scopeType:"component",settings:v.settings||{}}).then(function(G){if(!this.bIsDestroyed){this._mServices[e].instance=G;this._mServices[e].interface=G.getInterface();R(this._mServices[e].interface);}else{i(new Error("Service "+e+" could not be loaded as its Component was destroyed."));}}.bind(this)).catch(i);}else{var D="The ServiceFactory "+A+" for Service "+e+" not found in ServiceFactoryRegistry!";var F=this._getManifestEntry("/sap.ui5/services/"+e+"/optional",true);if(!F){L.error(D);}i(new Error(D));}}.bind(this),i);}.bind(this));}return this._mServices[e].promise;};function s(e,A){var i=e._getManifestEntry("/sap.ui5/services",true);var m=A?[]:null;if(!i){return m;}var v=Object.keys(i);if(!A&&v.some(function(B){return i[B].startup===S.waitFor;})){throw new Error("The specified component \""+e.getMetadata().getName()+"\" cannot be loaded in sync mode since it has some services declared with \"startup\" set to \"waitFor\"");}return v.reduce(function(P,B){if(i[B].lazy===false||i[B].startup===S.waitFor||i[B].startup===S.eager){var D=e.getService(B);if(i[B].startup===S.waitFor){P.push(D);}}return P;},m);}p.prototype.createComponent=function(v){d((typeof v==='string'&&v)||(typeof v==='object'&&typeof v.usage==='string'&&v.usage),"vUsage either must be a non-empty string or an object with a non-empty usage id");var m={async:true};if(v){var e;if(typeof v==="object"){e=v.usage;["id","async","settings","componentData"].forEach(function(N){if(v[N]!==undefined){m[N]=v[N];}});}else if(typeof v==="string"){e=v;}m=this._enhanceWithUsageConfig(e,m);}return p._createComponent(m,this);};p.prototype._enhanceWithUsageConfig=function(e,m){var i=this.getManifestEntry("/sap.ui5/componentUsages/"+e);if(!i){throw new Error("Component usage \""+e+"\" not declared in Component \""+this.getManifestObject().getComponentName()+"\"!");}if(i.activeTerminologies){throw new Error("Terminologies vector can't be used in component usages");}return q.extend(true,i,m);};p.prototype.getActiveTerminologies=function(){return this._aActiveTerminologies?this._aActiveTerminologies.slice():undefined;};p._createComponent=function(m,e){function i(){if(m.async===true){return p.create(m);}else{return sap.ui.component(m);}}if(e){return e.runAsOwner(i);}else{return i();}};p._createManifestModelConfigurations=function(m){var e=m.component;var v=m.manifest||e.getManifestObject();var A=m.mergeParent;var B=m.cacheTokens||{};var D=e?e.toString():v.getComponentName();var F=sap.ui.getCore().getConfiguration();var G=m.activeTerminologies;if(!m.models){return null;}var H={models:m.models,dataSources:m.dataSources||{},origin:{dataSources:{},models:{}}};if(e&&A){var J=e.getMetadata();while(J instanceof C){var K=J.getManifestObject();var N=J.getManifestEntry("/sap.app/dataSources");l(H.dataSources,H.origin.dataSources,N,K);var P=J.getManifestEntry("/sap.ui5/models");l(H.models,H.origin.models,P,K);J=J.getParent();}}var Q={};for(var R in H.models){var T=H.models[R];var W=false;var X=null;if(typeof T==='string'){T={dataSource:T};}if(T.dataSource){var Y=H.dataSources&&H.dataSources[T.dataSource];if(typeof Y==='object'){if(Y.type===undefined){Y.type='OData';}var Z;if(!T.type){switch(Y.type){case'OData':Z=Y.settings&&Y.settings.odataVersion;if(Z==="4.0"){T.type='sap.ui.model.odata.v4.ODataModel';}else if(!Z||Z==="2.0"){T.type='sap.ui.model.odata.v2.ODataModel';}else{L.error('Component Manifest: Provided OData version "'+Z+'" in '+'dataSource "'+T.dataSource+'" for model "'+R+'" is unknown. '+'Falling back to default model type "sap.ui.model.odata.v2.ODataModel".','["sap.app"]["dataSources"]["'+T.dataSource+'"]',D);T.type='sap.ui.model.odata.v2.ODataModel';}break;case'JSON':T.type='sap.ui.model.json.JSONModel';break;case'XML':T.type='sap.ui.model.xml.XMLModel';break;default:}}if(T.type==='sap.ui.model.odata.v4.ODataModel'&&Y.settings&&Y.settings.odataVersion){T.settings=T.settings||{};T.settings.odataVersion=Y.settings.odataVersion;}if(!T.uri){T.uri=Y.uri;W=true;}if(Y.type==='OData'&&Y.settings&&typeof Y.settings.maxAge==="number"){T.settings=T.settings||{};T.settings.headers=T.settings.headers||{};T.settings.headers["Cache-Control"]="max-age="+Y.settings.maxAge;}if(Y.type==='OData'&&Y.settings&&Y.settings.annotations){var $=Y.settings.annotations;for(var i=0;i<$.length;i++){var _=H.dataSources[$[i]];if(!_){L.error("Component Manifest: ODataAnnotation \""+$[i]+"\" for dataSource \""+T.dataSource+"\" could not be found in manifest","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);continue;}if(_.type!=='ODataAnnotation'){L.error("Component Manifest: dataSource \""+$[i]+"\" was expected to have type \"ODataAnnotation\" but was \""+_.type+"\"","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);continue;}if(!_.uri){L.error("Component Manifest: Missing \"uri\" for ODataAnnotation \""+$[i]+"\"","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);continue;}var a1=new U(_.uri);if(T.type==='sap.ui.model.odata.v2.ODataModel'){["sap-language","sap-client"].forEach(function(o1){if(!a1.hasQuery(o1)&&F.getSAPParam(o1)){a1.setQuery(o1,F.getSAPParam(o1));}});var b1=B.dataSources&&B.dataSources[_.uri];if(b1){var c1=function(){if(!a1.hasQuery("sap-language")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for ODataAnnotation \""+$[i]+"\" ("+a1.toString()+"). "+"Missing \"sap-language\" URI parameter","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);return;}if(!a1.hasQuery("sap-client")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for ODataAnnotation \""+$[i]+"\" ("+a1.toString()+"). "+"Missing \"sap-client\" URI parameter","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);return;}if(!a1.hasQuery("sap-client",F.getSAPParam("sap-client"))){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for ODataAnnotation \""+$[i]+"\" ("+a1.toString()+"). "+"URI parameter \"sap-client="+a1.query(true)["sap-client"]+"\" must be identical with configuration \"sap-client="+F.getSAPParam("sap-client")+"\"","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);return;}if(a1.hasQuery("sap-context-token")&&!a1.hasQuery("sap-context-token",b1)){var o1=a1.query(true)["sap-context-token"];L.warning("Component Manifest: Overriding existing \"sap-context-token="+o1+"\" with provided value \""+b1+"\" for ODataAnnotation \""+$[i]+"\" ("+a1.toString()+").","[\"sap.app\"][\"dataSources\"][\""+$[i]+"\"]",D);}a1.setQuery("sap-context-token",b1);};c1();}}var d1=H.origin.dataSources[$[i]]||v;var e1=d1._resolveUri(a1).toString();T.settings=T.settings||{};T.settings.annotationURI=T.settings.annotationURI||[];T.settings.annotationURI.push(e1);}}}else{L.error("Component Manifest: dataSource \""+T.dataSource+"\" for model \""+R+"\" not found or invalid","[\"sap.app\"][\"dataSources\"][\""+T.dataSource+"\"]",D);continue;}}if(!T.type){L.error("Component Manifest: Missing \"type\" for model \""+R+"\"","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);continue;}if(T.type==='sap.ui.model.odata.ODataModel'&&(!T.settings||T.settings.json===undefined)){T.settings=T.settings||{};T.settings.json=true;}if(T.type==="sap.ui.model.resource.ResourceModel"){if(T.uri&&T.settings&&T.settings.bundleUrl){L.warning("Defining both model uri and bundleUrl is not supported. Only model uri will be resolved.");}if(!T.uri&&T.settings&&T.settings.terminologies){if(T.bundleUrl||T.settings.bundleUrl){T.uri=T.bundleUrl||T.settings.bundleUrl;delete T.settings.bundleUrl;}}}if(T.uri){var f1=new U(T.uri);var g1=(W?H.origin.dataSources[T.dataSource]:H.origin.models[R])||v;f1=g1._resolveUri(f1);if(T.dataSource){k(f1);if(T.type==='sap.ui.model.odata.v2.ODataModel'){X=T.settings&&T.settings.metadataUrlParams;if((!X||typeof X['sap-language']==='undefined')&&!f1.hasQuery('sap-language')&&F.getSAPParam('sap-language')){T.settings=T.settings||{};X=T.settings.metadataUrlParams=T.settings.metadataUrlParams||{};X['sap-language']=F.getSAPParam('sap-language');}if(B.dataSources){var b1=B.dataSources[Y.uri];if(b1){var h1=function(){if(f1.hasQuery("sap-context-token")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for model \""+R+"\" ("+f1.toString()+"). "+"Model URI already contains parameter \"sap-context-token="+f1.query(true)["sap-context-token"]+"\"","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);return;}if((!X||typeof X["sap-language"]==="undefined")&&!f1.hasQuery("sap-language")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for model \""+R+"\" ("+f1.toString()+"). "+"Missing \"sap-language\" parameter","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);return;}if(!f1.hasQuery("sap-client")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for model \""+R+"\" ("+f1.toString()+"). "+"Missing \"sap-client\" parameter","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);return;}if(!f1.hasQuery("sap-client",F.getSAPParam("sap-client"))){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for model \""+R+"\" ("+f1.toString()+"). "+"URI parameter \"sap-client="+f1.query(true)["sap-client"]+"\" must be identical with configuration \"sap-client="+F.getSAPParam("sap-client")+"\"","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);return;}if(X&&typeof X["sap-client"]!=="undefined"){if(X["sap-client"]!==F.getSAPParam("sap-client")){L.warning("Component Manifest: Ignoring provided \"sap-context-token="+b1+"\" for model \""+R+"\" ("+f1.toString()+"). "+"Parameter metadataUrlParams[\"sap-client\"] = \""+X["sap-client"]+"\" must be identical with configuration \"sap-client="+F.getSAPParam("sap-client")+"\"","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);return;}}if(X&&X["sap-context-token"]&&X["sap-context-token"]!==b1){L.warning("Component Manifest: Overriding existing \"sap-context-token="+X["sap-context-token"]+"\" with provided value \""+b1+"\" for model \""+R+"\" ("+f1.toString()+").","[\"sap.ui5\"][\"models\"][\""+R+"\"]",D);}if(!X){T.settings=T.settings||{};X=T.settings.metadataUrlParams=T.settings.metadataUrlParams||{};}X["sap-context-token"]=b1;};h1();}}}}T.uri=f1.toString();}if(T.uriSettingName===undefined){switch(T.type){case'sap.ui.model.odata.ODataModel':case'sap.ui.model.odata.v2.ODataModel':case'sap.ui.model.odata.v4.ODataModel':T.uriSettingName='serviceUrl';break;case'sap.ui.model.resource.ResourceModel':T.uriSettingName='bundleUrl';break;default:}}var i1;var j1;if(e){j1=e.getComponentData();}else{j1=m.componentData;}i1=j1&&j1.startupParameters&&j1.startupParameters["sap-system"];if(!i1){i1=F.getSAPParam("sap-system");}var k1=false;var l1;if(i1&&["sap.ui.model.odata.ODataModel","sap.ui.model.odata.v2.ODataModel"].indexOf(T.type)!=-1){k1=true;l1=sap.ui.requireSync("sap/ui/model/odata/ODataUtils");}if(T.uri){if(k1){T.preOriginBaseUri=T.uri.split("?")[0];T.uri=l1.setOrigin(T.uri,{alias:i1});T.postOriginBaseUri=T.uri.split("?")[0];}if(T.uriSettingName!==undefined){T.settings=T.settings||{};if(!T.settings[T.uriSettingName]){T.settings[T.uriSettingName]=T.uri;}}else if(T.settings){T.settings=[T.uri,T.settings];}else{T.settings=[T.uri];}}else{if(k1&&T.uriSettingName!==undefined&&T.settings&&T.settings[T.uriSettingName]){T.preOriginBaseUri=T.settings[T.uriSettingName].split("?")[0];T.settings[T.uriSettingName]=l1.setOrigin(T.settings[T.uriSettingName],{alias:i1});T.postOriginUri=T.settings[T.uriSettingName].split("?")[0];}}if(k1&&T.settings&&T.settings.annotationURI){var m1=[].concat(T.settings.annotationURI);var n1=[];for(var i=0;i<m1.length;i++){n1.push(l1.setAnnotationOrigin(m1[i],{alias:i1,preOriginBaseUri:T.preOriginBaseUri,postOriginBaseUri:T.postOriginBaseUri}));}T.settings.annotationURI=n1;}if(T.type==='sap.ui.model.resource.ResourceModel'&&T.settings){if(G){T.settings.activeTerminologies=G;}v._processResourceConfiguration(T.settings,undefined,true);}if(T.settings&&!Array.isArray(T.settings)){T.settings=[T.settings];}Q[R]=T;}if(v.getEntry("/sap.ui5/commands")||(e&&e._getManifestEntry("/sap.ui5/commands",true))){Q["$cmd"]={type:'sap.ui.model.json.JSONModel'};}return Q;};p._createManifestModels=function(m,e){var i={};for(var v in m){var A=m[v];try{sap.ui.requireSync(A.type.replace(/\./g,"/"));}catch(B){L.error("Component Manifest: Class \""+A.type+"\" for model \""+v+"\" could not be loaded. "+B,"[\"sap.ui5\"][\"models\"][\""+v+"\"]",e);continue;}var D=O.get(A.type);if(!D){L.error("Component Manifest: Class \""+A.type+"\" for model \""+v+"\" could not be found","[\"sap.ui5\"][\"models\"][\""+v+"\"]",e);continue;}var F=[null].concat(A.settings||[]);var G=D.bind.apply(D,F);var H=new G();i[v]=H;}return i;};function t(m,e,i,A){var v={afterManifest:{},afterPreload:{}};var B=q.extend(true,{},m.getEntry("/sap.app/dataSources"));var D=q.extend(true,{},m.getEntry("/sap.ui5/models"));var F=p._createManifestModelConfigurations({models:D,dataSources:B,manifest:m,componentData:e,cacheTokens:i,activeTerminologies:A});var P=f.fromQuery(window.location.search).get("sap-ui-xx-preload-component-models-"+m.getComponentName());var G=P&&P.split(",");for(var H in F){var J=F[H];if(!J.preload&&G&&G.indexOf(H)>-1){J.preload=true;L.warning("FOR TESTING ONLY!!! Activating preload for model \""+H+"\" ("+J.type+")",m.getComponentName(),"sap.ui.core.Component");}if(J.type==="sap.ui.model.resource.ResourceModel"&&Array.isArray(J.settings)&&J.settings.length>0&&J.settings[0].async!==true){v.afterPreload[H]=J;}else if(J.preload){if(sap.ui.loader._.getModuleState(J.type.replace(/\./g,"/")+".js")){v.afterManifest[H]=J;}else{L.warning("Can not preload model \""+H+"\" as required class has not been loaded: \""+J.type+"\"",m.getComponentName(),"sap.ui.core.Component");}}}return v;}function u(e){return sap.ui.require.toUrl(e.replace(/\./g,"/")+"/manifest.json");}function w(m,v){h.registerResourcePath(m.replace(/\./g,"/"),v);}function x(R){var m=[];var e=[];function v(i){if(!i._oManifest){var N=i.getComponentName();var D=u(N);var A=h.loadResource({url:D,dataType:"json",async:true}).catch(function(B){L.error("Failed to load component manifest from \""+D+"\" (component "+N+")! Reason: "+B);return{};});m.push(A);e.push(i);}var P=i.getParent();if(P&&(P instanceof C)&&!P.isBaseClass()){v(P);}}v(R);return Promise.all(m).then(function(A){for(var i=0;i<A.length;i++){if(A[i]){e[i]._applyManifest(A[i]);}}});}p._fnLoadComponentCallback=null;p._fnOnInstanceCreated=null;p._fnPreprocessManifest=null;p.create=function(m){if(m==null||typeof m!=="object"){throw new TypeError("Component.create() must be called with a configuration object.");}var P=a({},m);P.async=true;if(P.manifest===undefined){P.manifest=true;}return y(P);};sap.ui.component=function(v){if(!v){throw new Error("sap.ui.component cannot be called without parameter!");}var e=function(i){return{type:"sap.ui.component",name:i};};if(typeof v==='string'){L.warning("Do not use deprecated function 'sap.ui.component' ("+v+") + for Component instance lookup. "+"Use 'Component.get' instead","sap.ui.component",null,e.bind(null,v));return sap.ui.getCore().getComponent(v);}if(v.async){L.info("Do not use deprecated factory function 'sap.ui.component' ("+v["name"]+"). "+"Use 'Component.create' instead","sap.ui.component",null,e.bind(null,v["name"]));}else{L.warning("Do not use synchronous component creation ("+v["name"]+")! "+"Use the new asynchronous factory 'Component.create' instead","sap.ui.component",null,e.bind(null,v["name"]));}return y(v);};function y(v){var e=p.get(b._sOwnerId);var A=v.activeTerminologies||(e&&e.getActiveTerminologies())||sap.ui.getCore().getConfiguration().getActiveTerminologies();if(!v.asyncHints||!v.asyncHints.cacheTokens){var m=e&&e._mCacheTokens;if(typeof m==="object"){v.asyncHints=v.asyncHints||{};v.asyncHints.cacheTokens=m;}}function i(G,v){if(typeof p._fnOnInstanceCreated==="function"){var P=p._fnOnInstanceCreated(G,v);if(v.async&&P instanceof Promise){return P;}}if(v.async){return Promise.resolve(G);}return G;}function B(G){var N=v.name,H=v.id,J=v.componentData,K=N+'.Component',P=v.settings;var Q=new G(q.extend({},P,{id:H,componentData:J,_cacheTokens:v.asyncHints&&v.asyncHints.cacheTokens,_activeTerminologies:A}));d(Q instanceof p,"The specified component \""+K+"\" must be an instance of sap.ui.core.Component!");L.info("Component instance Id = "+Q.getId());var R=Q.getMetadata().handleValidation()!==undefined||v.handleValidation;if(R){if(Q.getMetadata().handleValidation()!==undefined){R=Q.getMetadata().handleValidation();}else{R=v.handleValidation;}sap.ui.getCore().getMessageManager().registerObject(Q,R);}var T=s(Q,v.async);if(v.async){return i(Q,v).then(function(){return Promise.all(T);}).then(function(){return Q;});}else{i(Q,v);return Q;}}var D=z(v,{failOnError:true,createModels:true,waitFor:v.asyncHints&&v.asyncHints.waitFor,activeTerminologies:A});if(v.async){var F=b._sOwnerId;return D.then(function(G){return r(function(){return B(G);},F);});}else{return B(D);}}p.load=function(m){var P=a({},m);P.async=true;if(P.manifest===undefined){P.manifest=true;}return z(P,{preloadOnly:P.asyncHints&&P.asyncHints.preloadOnly});};p.get=function(i){return sap.ui.getCore().getComponent(i);};sap.ui.component.load=function(e,F){L.warning("Do not use deprecated function 'sap.ui.component.load'! Use 'Component.load' instead");return z(e,{failOnError:F,preloadOnly:e.asyncHints&&e.asyncHints.preloadOnly});};function z(m,A){var B=A.activeTerminologies,N=m.name,D=m.url,F=sap.ui.getCore().getConfiguration(),G=/^(sync|async)$/.test(F.getComponentPreload()),H=m.manifest,J,K,P,Q,R,T;function W(e,A){var i=JSON.parse(JSON.stringify(e));if(m.async){return X(i).then(function(v){return new M(v,A);});}else{return new M(i,A);}}function X(e){if(typeof p._fnPreprocessManifest==="function"&&e!=null){try{var i=q.extend(true,{},m);return p._fnPreprocessManifest(e,i);}catch(v){L.error("Failed to execute flexibility hook for manifest preprocessing.",v);return Promise.reject(v);}}else{return Promise.resolve(e);}}d(!D||typeof D==='string',"sUrl must be a string or undefined");if(N&&typeof D==='string'){w(N,D);}I.setStepComponent(N);if(H===undefined){J=m.manifestFirst===undefined?F.getManifestFirst():!!m.manifestFirst;K=m.manifestUrl;}else{if(m.async===undefined){m.async=true;}J=!!H;K=H&&typeof H==='string'?H:undefined;P=H&&typeof H==='object'?W(H,{url:m&&m.altManifestUrl,activeTerminologies:B}):undefined;}if(!P&&K){P=M.load({activeTerminologies:B,manifestUrl:K,componentName:N,processJson:X,async:m.async,failOnError:true});}if(P&&!m.async){N=P.getComponentName();if(N&&typeof D==='string'){w(N,D);}}if(!(P&&m.async)){if(!N){throw new Error("The name of the component is undefined.");}d(typeof N==='string',"sName must be a string");}if(J&&!P){P=M.load({activeTerminologies:B,manifestUrl:u(N),componentName:N,async:m.async,processJson:X,failOnError:false});}function Y(){return(N+".Component").replace(/\./g,"/");}function Z(e){var i=N+'.Component';if(!e){var v="The specified component controller '"+i+"' could not be found!";if(A.failOnError){throw new Error(v);}else{L.warning(v);}}if(P){var $=o(e.getMetadata(),P);var j1=function(){var k1=Array.prototype.slice.call(arguments);var l1;if(k1.length===0||typeof k1[0]==="object"){l1=k1[0]=k1[0]||{};}else if(typeof k1[0]==="string"){l1=k1[1]=k1[1]||{};}l1._metadataProxy=$;if(Q){l1._manifestModels=Q;}var m1=Object.create(e.prototype);e.apply(m1,k1);return m1;};j1.getMetadata=function(){return $;};j1.extend=function(){throw new Error("Extending Components created by Manifest is not supported!");};return j1;}else{return e;}}function _(v,i){d((typeof v==='string'&&v)||(typeof v==='object'&&typeof v.name==='string'&&v.name),"reference either must be a non-empty string or an object with a non-empty 'name' and an optional 'url' property");if(typeof v==='object'){if(v.url){w(v.name,v.url);}return(v.lazy&&i!==true)?undefined:v.name;}return v;}function a1(i,v){var $=i+'.Component',j1=sap.ui.getCore().getConfiguration().getDepCache(),k1,l1,m1;if(G&&i!=null&&!sap.ui.loader._.getModuleState($.replace(/\./g,"/")+".js")){if(v){l1=V._getTransitiveDependencyForComponent(i);if(l1){m1=[l1.library];Array.prototype.push.apply(m1,l1.dependencies);return sap.ui.getCore().loadLibraries(m1,{preloadOnly:true});}else{k1=$.replace(/\./g,"/")+(j1?'-h2-preload.js':'-preload.js');return sap.ui.loader._.loadJSResourceAsync(k1,true);}}try{k1=$+'-preload';sap.ui.requireSync(k1.replace(/\./g,"/"));}catch(e){L.warning("couldn't preload component from "+k1+": "+((e&&e.message)||e));}}else if(v){return Promise.resolve();}}function b1(e,P,i){var v=[];var $=i?function(r1){v.push(r1);}:function(){};P.defineResourceRoots();var j1=P.getEntry("/sap.ui5/dependencies/libs");if(j1){var k1=[];for(var l1 in j1){if(!j1[l1].lazy){k1.push(l1);}}if(k1.length>0){L.info("Component \""+e+"\" is loading libraries: \""+k1.join(", ")+"\"");$(sap.ui.getCore().loadLibraries(k1,{async:i}));}}var m1=P.getEntry("/sap.ui5/extends/component");if(m1){$(a1(m1,i));}var n1=[];var o1=P.getEntry("/sap.ui5/dependencies/components");if(o1){for(var e in o1){if(!o1[e].lazy){n1.push(e);}}}var p1=P.getEntry("/sap.ui5/componentUsages");if(p1){for(var q1 in p1){if(p1[q1].lazy===false&&n1.indexOf(p1[q1].name)===-1){n1.push(p1[q1].name);}}}if(n1.length>0){n1.forEach(function(e){$(a1(e,i));});}return i?Promise.all(v):undefined;}if(m.async){var c1=m.asyncHints||{},d1=[],e1=function(e){e=e.then(function(v){return{result:v,rejected:false};},function(v){return{result:v,rejected:true};});return e;},f1=function(e){if(e){d1.push(e1(e));}},g1=function($){return $;},h1,i1;if(P&&A.createModels){f1(P.then(function(P){R=t(P,m.componentData,c1.cacheTokens,B);return P;}).then(function(P){if(Object.keys(R.afterManifest).length>0){Q=p._createManifestModels(R.afterManifest,P.getComponentName());}return P;}));}h1=[];if(Array.isArray(c1.preloadBundles)){c1.preloadBundles.forEach(function(v){h1.push(sap.ui.loader._.loadJSResourceAsync(_(v,true),true));});}if(Array.isArray(c1.libs)){i1=c1.libs.map(_).filter(g1);h1.push(sap.ui.getCore().loadLibraries(i1,{preloadOnly:true}));}h1=Promise.all(h1);if(i1&&!A.preloadOnly){h1=h1.then(function(){return sap.ui.getCore().loadLibraries(i1);});}f1(h1);if(!P){f1(a1(N,true));}else{f1(P.then(function(P){var e=P.getComponentName();if(typeof D==='string'){w(e,D);}return a1(e,true).then(function(){return P._processI18n(true);}).then(function(){if(!A.createModels){return null;}var i=Object.keys(R.afterPreload);if(i.length===0){return null;}return new Promise(function(v,$){sap.ui.require(["sap/ui/model/resource/ResourceModel"],function(j1){v(j1);},$);}).then(function(v){function $(j1){var k1=R.afterPreload[j1];if(Array.isArray(k1.settings)&&k1.settings.length>0){var l1=k1.settings[0];l1.activeTerminologies=A.activeTerminologies;return v.loadResourceBundle(l1,true).then(function(m1){l1.bundle=m1;delete l1.terminologies;delete l1.activeTerminologies;delete l1.enhanceWith;},function(m1){L.error("Component Manifest: Could not preload ResourceBundle for ResourceModel. "+"The model will be skipped here and tried to be created on Component initialization.","[\"sap.ui5\"][\"models\"][\""+j1+"\"]",e);L.error(m1);delete R.afterPreload[j1];});}else{return Promise.resolve();}}return Promise.all(i.map($)).then(function(){if(Object.keys(R.afterPreload).length>0){var j1=p._createManifestModels(R.afterPreload,P.getComponentName());if(!Q){Q={};}for(var k1 in j1){Q[k1]=j1[k1];}}});});});}));T=function(e){if(typeof p._fnLoadComponentCallback==="function"){var i=q.extend(true,{},m);var v=q.extend(true,{},e);try{p._fnLoadComponentCallback(i,v);}catch($){L.error("Callback for loading the component \""+e.getComponentName()+"\" run into an error. The callback was skipped and the component loading resumed.",$,"sap.ui.core.Component");}}};}if(c1.components){q.each(c1.components,function(i,v){f1(a1(_(v),true));});}return Promise.all(d1).then(function(v){var e=[],i=false,$;i=v.some(function(j1){if(j1&&j1.rejected){$=j1.result;return true;}e.push(j1.result);});if(i){return Promise.reject($);}return e;}).then(function(v){if(P&&T){P.then(T);}return v;}).then(function(v){L.debug("Component.load: all promises fulfilled, then "+v);if(P){return P.then(function(e){P=e;N=P.getComponentName();return b1(N,P,true);});}else{return v;}}).then(function(){if(A.preloadOnly){return true;}return new Promise(function(e,i){sap.ui.require([Y()],function(v){e(v);},i);}).then(function(e){var i=e.getMetadata();var N=i.getComponentName();var v=u(N);var $;if(P&&typeof H!=="object"&&(typeof K==="undefined"||K===v)){i._applyManifest(JSON.parse(JSON.stringify(P.getRawJson())));}$=x(i);return $.then(function(){var j1=Promise.resolve();if(!P&&A.activeTerminologies){P=new M(i.getManifestObject().getRawJson(),{process:false,activeTerminologies:B});j1=P._processI18n(true);}return j1.then(Z.bind(undefined,e));});});}).then(function(e){if(!P){return e;}var i=[];var v;var $=P.getEntry("/sap.ui5/rootView");if(typeof $==="string"){v="XML";}else if($&&typeof $==="object"&&$.type){v=$.type;}if(v&&j[v]){var j1="sap/ui/core/mvc/"+j[v]+"View";i.push(j1);}var k1=P.getEntry("/sap.ui5/routing");if(k1&&k1.routes){var l1=P.getEntry("/sap.ui5/routing/config/routerClass")||"sap.ui.core.routing.Router";var m1=l1.replace(/\./g,"/");i.push(m1);}var n1=q.extend(true,{},P.getEntry("/sap.ui5/models"));var o1=q.extend(true,{},P.getEntry("/sap.app/dataSources"));var p1=p._createManifestModelConfigurations({models:n1,dataSources:o1,manifest:P,cacheTokens:c1.cacheTokens,activeTerminologies:B});for(var q1 in p1){if(!p1.hasOwnProperty(q1)){continue;}var r1=p1[q1];if(!r1.type){continue;}var s1=r1.type.replace(/\./g,"/");if(i.indexOf(s1)===-1){i.push(s1);}}if(i.length>0){return Promise.all(i.map(function(s1){return new Promise(function(t1,u1){var v1=false;function w1(x1){if(v1){return;}L.warning("Can not preload module \""+s1+"\". "+"This will most probably cause an error once the module is used later on.",P.getComponentName(),"sap.ui.core.Component");L.warning(x1);v1=true;t1();}sap.ui.require([s1],t1,w1);});})).then(function(){return e;});}else{return e;}}).then(function(e){var i=A.waitFor;if(i){var v=Array.isArray(i)?i:[i];return Promise.all(v).then(function(){return e;});}return e;}).catch(function(e){if(Q){for(var N in Q){var i=Q[N];if(i&&typeof i.destroy==="function"){i.destroy();}}}throw e;});}if(P){b1(N,P);}a1(N);return Z(sap.ui.requireSync(Y()));}if(Math.sqrt(2)<1){sap.ui.require(["sap/ui/core/Core"],function(){});}p.prototype.getCommand=function(e){var i,m=this._getManifestEntry("/sap.ui5/commands",true);if(m&&e){i=m[e];}return e?i:m;};return p;});
