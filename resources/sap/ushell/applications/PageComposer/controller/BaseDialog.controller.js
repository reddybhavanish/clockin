// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/library","sap/base/util/merge","./BaseController","sap/ui/core/Fragment"],function(c,m,B,F){"use strict";var V=c.ValueState;return B.extend("sap.ushell.applications.PageComposer.controller.BaseDialog.controller",{destroy:function(){if(this._oView.byId(this.sViewId)){this._oView.byId(this.sViewId).destroy();}},onCancel:function(){this._oView.byId(this.sViewId).close();if(this._fnCancel){this._fnCancel();}},attachConfirm:function(a){this._fnConfirm=a;},onConfirm:function(e){if(this._fnConfirm){this._fnConfirm(e);}},getModel:function(){return this._oModel;},validate:function(v){for(var i in v){if(!v[i]){return false;}}return true;},attachCancel:function(a){this._fnCancel=a;},transportExtensionPoint:function(a){this._oView.byId("transportContainer").setComponent(a);},load:function(){var f={id:this._oView.getId(),name:this.sId,controller:this};return F.load(f).then(function(a){a.setModel(this._oModel);}.bind(this));},open:function(){var d=this._oView.byId(this.sViewId);this._oView.addDependent(d);d.open();},handlePackageNamespaceChange:function(p,f){var t=this._oView.byId("transportContainer").getComponentInstance(),P=t&&t.getRootControl().byId("packageInput");if(P&&!P.getValue().length){var s=p.split("/");s.pop();s=s.join("/");if(s){if(f){P.fireLiveChange({value:s});}else{P.setValue(s);P.fireChange({value:s});}}}},onDescriptionLiveChange:function(e){var i=e.getSource(),M=this.getModel(),I=this.isValidTitleOrDescription(i.getValue().trim()),v=m({},M.getProperty("/validation"),{description:I}),s=I?V.None:V.Error;M.setProperty("/validation",v);i.setValueState(s);},onTitleLiveChange:function(e){var i=e.getSource(),M=this.getModel(),I=this.isValidTitleOrDescription(i.getValue().trim()),v=m({},M.getProperty("/validation"),{title:I}),s=I?V.None:V.Error;M.setProperty("/validation",v);i.setValueState(s);},onPageIDLiveChange:function(e){var i=e.getSource(),M=this.getModel(),I=i.getValue(),b=this.isValidID(I),v=m({},M.getProperty("/validation"),{id:b}),s=b?V.None:V.Error;M.setProperty("/validation",v);i.setValueState(s);if(I.length>0){i.setValueStateText(this._oResourceBundle.getText("Message.InvalidPageID"));}else{i.setValueStateText(this._oResourceBundle.getText("Message.EmptyPageID"));}this.handlePackageNamespaceChange(I,true);},handleNameSpaceChange:function(i){var t=this._oView.byId("transportContainer").getComponentInstance();if(!t){return;}t.showTransport({id:i});},onPageIDChange:function(e){var n=e.getParameters().value;this.handlePackageNamespaceChange(n,false);this.handleNameSpaceChange(n);},isValidID:function(i){return/^[a-z_/]{1}[a-z0-9_/]{0,34}$/gi.test(i);},isValidTitleOrDescription:function(t){return!!t.length;}});});
