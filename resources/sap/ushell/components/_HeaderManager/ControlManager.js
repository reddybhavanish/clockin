// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/library","sap/ui/core/CustomData","sap/ui/core/IconPool","sap/ui/Device","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/footerbar/EndUserFeedback","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/ui/shell/ShellNavigationMenu"],function(u,C,I,D,a,E,r,b,c,A,S,d){"use strict";var e=u.AppTitleState;var F=S.prototype.FloatingNumberType;var f=[];var g=[];function i(w,H,x){f.push(k(w));f.push(m(H));f.push(p(H,x));f.push(n(x));if(a.last("/core/shell/model/enableNotifications")){f.push(o(x));}if(w.moveEditHomePageActionToShellHeader){f.push(l());}if(w.moveAppFinderActionToShellHeader&&a.last("/core/catalog/enabled")){f.push(q(w,H));}if(w.moveUserSettingsActionToShellHeader){f.push(j(H));}if(w.moveContactSupportActionToShellHeader){f.push(s());}if(w.moveGiveFeedbackActionToShellHeader){f.push(t());}if(a.last("/core/productSwitch/enabled")){f.push(v());}g.push(E.once("CoreResourcesComplementLoaded").do(function(){_(w,x,H);}));}function h(){f.forEach(function(w){var x=sap.ui.getCore().byId(w);if(x){if(x.destroyContent){x.destroyContent();}x.destroy();}});g.forEach(function(w){w.off();});f=[];g=[];}function _(w,x,y){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile"],function(z,N){var M="shellNavigationMenu";var H=function(K,L){var O=L.getProperty("icon")||"sap-icon://circle-task-2",T=L.getProperty("title"),P=L.getProperty("subtitle"),Q=L.getProperty("intent");var U=(new z({type:"Active",title:T,description:P,icon:O,wrapping:true,customData:[new C({key:"intent",value:Q})],press:[y.handleNavigationMenuItemPress,y]})).addStyleClass("sapUshellNavigationMenuListItems");return U;};var R=function(K,L){var O=L.getProperty("icon"),T=L.getProperty("title"),P=L.getProperty("subtitle"),Q=L.getProperty("intent");return new N({title:T,subtitle:P,icon:O,intent:Q,press:function(){var U=this.getIntent();if(U&&U[0]==="#"){y.navigateFromShellApplicationNavigationMenu(U);}}});};var B=new d(M,{title:"{/application/title}",icon:"{/application/icon}",showTitle:"{/application/showNavMenuTitle}",showRelatedApps:w.appState!=="lean",items:{path:"/application/hierarchy",factory:H.bind(this)},miniTiles:{path:"/application/relatedApps",factory:R.bind(this)},visible:{path:"/ShellAppTitleState",formatter:function(K){return K===e.ShellNavMenu;}}});var G=sap.ui.getCore().byId("shell-header");B.setModel(G.getModel());var J=sap.ui.getCore().byId("shellAppTitle");if(J){J.setNavigationMenu(B);}f.push(M);return M;}.bind(this));}function j(w){var U=new S({id:"userSettingsBtn",icon:"sap-icon://action-settings",tooltip:r.i18n.getText("userSettings"),text:r.i18n.getText("userSettings"),ariaHaspopup:"dialog",press:w.handleUserSettingsPress});return U.getId();}function k(w){var H=new S({id:"homeBtn",tooltip:r.i18n.getText("homeBtn_tooltip"),ariaLabel:r.i18n.getText("homeBtn_tooltip"),icon:I.getIconURI("home"),target:w.rootIntent?"#"+w.rootIntent:"#"});if(a.last("/core/extension/enableHelp")){H.addStyleClass("help-id-homeBtn",true);}H.addCustomData(new A({key:"aria-disabled",value:"false",writeToDom:true}));if(D.system.desktop){H.addEventDelegate({onsapskipback:function(x){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){x.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}},onsapskipforward:function(x){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){x.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});}return H.getId();}function l(){var T=new S({id:"ActionModeBtn",icon:"sap-icon://edit"});if(a.last("/core/extension/enableHelp")){T.addStyleClass("help-id-ActionModeBtn");}return T.getId();}function m(w){var B=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back";var x=new S({id:"backBtn",tooltip:r.i18n.getText("backBtn_tooltip"),ariaLabel:r.i18n.getText("backBtn_tooltip"),icon:I.getIconURI(B),press:w.pressNavBackButton.bind(w)});return x.getId();}function n(w){var x="meAreaHeaderButton";var M=new S({id:x,icon:"{/userImage/personPlaceHolder}",ariaLabel:r.i18n.getText("MeAreaToggleButtonAria"),ariaHaspopup:"dialog",tooltip:sap.ushell.Container.getUser().getFullName(),press:function(){E.emit("showMeArea",Date.now());}});if(D.system.desktop){M.addEventDelegate({onsapskipforward:function(y){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;y.preventDefault();window.document.getElementById("sapUshellHeaderAccessibilityHelper").focus();}});}M.setModel(w);return x;}function o(w){var x="NotificationsCountButton";var N=new S({id:x,tooltip:{path:"/notificationsCount",formatter:function(y){return this.tooltipFormatter(y);}},icon:I.getIconURI("bell"),text:r.i18n.getText("notificationsBtn_title"),enabled:false,ariaHaspopup:"dialog",floatingNumber:"{/notificationsCount}",floatingNumberType:F.Notifications,press:function(){E.emit("showNotifications",Date.now());}});N.setModel(w);N.setModel(r.i18nModel,"i18n");return x;}function p(w,x){var y=new S({id:"endItemsOverflowBtn",tooltip:{path:"/notificationsCount",formatter:function(z){return this.tooltipFormatter(z);}},ariaLabel:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaHaspopup:"dialog",icon:"sap-icon://overflow",floatingNumber:"{/notificationsCount}",floatingNumberType:F.OverflowButton,press:[w.pressEndItemsOverflow,w]});y.setModel(x);return y.getId();}function q(w,x){var O=new S({id:"openCatalogBtn",text:r.i18n.getText("open_appFinderBtn"),tooltip:r.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!w.disableAppFinder,press:x.handleAppFinderPress});if(a.last("/core/extension/enableHelp")){O.addStyleClass("help-id-openCatalogActionItem");}return O.getId();}function s(){var B="ContactSupportBtn",w=sap.ui.getCore().byId(B);if(!w){var T=new b("tempContactSupportBtn",{visible:true});var x=T.getIcon();var y=T.getText();w=new S({id:B,icon:x,tooltip:y,text:y,ariaHaspopup:"dialog",press:function(){T.firePress();}});}return B;}function t(){var B="EndUserFeedbackBtn",w=sap.ui.getCore().byId(B);if(!w){var T=new c("EndUserFeedbackHandlerBtn",{});var x=T.getIcon();var y=T.getText();w=new S({id:B,icon:x,tooltip:y,ariaLabel:y,ariaHaspopup:"dialog",text:y,visible:false});}return w.getId();}function v(){var P=new S({id:"productSwitchBtn",icon:"sap-icon://grid",visible:false,tooltip:r.i18n.getText("productSwitch_tooltip"),text:r.i18n.getText("productSwitch"),ariaHaspopup:"dialog",press:function(){E.emit("showProductSwitch",Date.now());}});return P.getId();}return{init:i,destroy:h,_createOverflowButton:p};});
