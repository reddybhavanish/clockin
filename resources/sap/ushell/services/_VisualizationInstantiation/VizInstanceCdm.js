// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/_VisualizationInstantiation/VizInstance","sap/m/library","sap/ui/core/Component","sap/base/util/ObjectPath","sap/ui/core/ComponentContainer"],function(V,m,C,O,a){"use strict";var L=m.LoadState;var b=V.extend("sap.ushell.ui.launchpad.VizInstanceCdm",{metadata:{library:"sap.ushell"},constructor:function(v){this._oVizData=v;V.prototype.constructor.call(this,v);},fragment:"sap.ushell.services._VisualizationInstantiation.VizInstanceCdm"});b.prototype.load=function(){var c=this._getComponentConfiguration(this._oVizData);this._setSize(this._oVizData);return C.create(c).then(function(o){this._oComponent=o;var d=new a({component:o,height:"100%"});this._setContent(d);}.bind(this)).catch(function(e){this.setState(L.Failed);return Promise.reject(e);}.bind(this));};b.prototype._getComponentConfiguration=function(v){var o=O.get(["instantiationData","vizType"],v);var c={name:O.get(["sap.ui5","componentName"],o),componentData:{properties:this._getComponentProperties(v)},url:O.get(["sap.platform.runtime","componentProperties","url"],o),manifest:O.get(["sap.platform.runtime","componentProperties","manifest"],o)};if(O.get(["sap.platform.runtime","includeManifest"],o)){c.manifest=o;}return c;};b.prototype._getComponentProperties=function(v){return{title:v.title,subtitle:v.subtitle,icon:v.icon,info:v.info,indicatorDataSource:v.indicatorDataSource,targetURL:v.targetURL};};b.prototype._setSize=function(v){var s=O.get(["instantiationData","vizType","sap.flp","tileSize"],v);if(s){var S=s.split("x");var h=parseInt(S[0],10);var w=parseInt(S[1],10);if(w&&h){w=w*2;h=h*2;this.setWidth(w);this.setHeight(h);}}};b.prototype.setActive=function(c,r){if(this._oComponent&&typeof this._oComponent.tileSetVisible==="function"){this._oComponent.tileSetVisible(c);}if(r){this.refresh();}return this.setProperty("active",c,false);};b.prototype.refresh=function(){if(this._oComponent&&typeof this._oComponent.tileRefresh==="function"){this._oComponent.tileRefresh();}};return b;});
