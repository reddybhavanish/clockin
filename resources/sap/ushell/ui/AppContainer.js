// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/ui/Device","sap/base/Log","./AppContainerRenderer"],function(q,C,D,L){"use strict";var A=C.extend("sap.ushell.ui.AppContainer",{metadata:{library:"sap.ushell",properties:{visible:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{pages:{type:"sap.ui.core.Control",multiple:true,singularName:"pages"}},events:{beforeNavigate:{parameters:{fromId:{type:"string"},from:{type:"sap.ui.core.Control"},toId:{type:"string"},to:{type:"sap.ui.core.Control"}}},afterNavigate:{parameters:{fromId:{type:"string"},from:{type:"sap.ui.core.Control"},toId:{type:"string"},to:{type:"sap.ui.core.Control"}}}}}});A.prototype.addPages=function(c){if(this.getPages().indexOf(c)>-1){return;}c.toggleStyleClass("hidden",true);this.addAggregation("pages",c,true);var r,d=this.getDomRef();if(d){r=sap.ui.getCore().createRenderManager();r.render(c,d);r.destroy();}};A.prototype.addCenterViewPort=A.prototype.addPages;A.prototype.removeCenterViewPort=function(i){this.removeAggregation("pages",i,true);};A.prototype.getCurrentCenterPage=function(){return this.getPages().reduce(function(c,p){return(p&&!p.hasStyleClass("hidden"))?p.getId():c;},null);};A.prototype.navTo=function(v,p){var t=sap.ui.getCore().byId(p),c=this.getCurrentCenterPage(),o=sap.ui.getCore().byId(c)||null,h=sap.ushell.Container.getRenderer("fiori2").byId("Shell-home-component-container"),H=h&&h.getId(),N=c&&(H===c),b=H===p;if(v!=="centerViewPort"){L.error("Navigation to "+v+" is not allowed in Fiori3");return;}if(this.getPages().indexOf(t)===-1){L.error("AppContainer: invalid navigation target");return;}if(D.system.desktop&&N){this._saveFocus();}if(c!==p){this.fireBeforeNavigate({toId:p,to:t,fromId:c,from:o});}this.getPages().forEach(function(P){if(P){P.toggleStyleClass("hidden",P.getId()!==p);}});if(D.system.desktop&&b){this._restoreFocus();}if(c!==p){this.fireAfterNavigate({toId:p,to:t,fromId:c,from:o});}};A.prototype._restoreFocus=function(){var c;if(this.sLastFocusId){sap.ushell.renderers.fiori2.AccessKeysHandler.registerAppKeysHandler(this.fnLastAppKeyHandler);c=sap.ui.getCore().byId(this.sLastFocusId);if(c){c.focus();}}};A.prototype._saveFocus=function(){var a=q(document.activeElement).control(0);this.sLastFocusId=a?a.getId():null;this.fnLastAppKeyHandler=sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler();};A.prototype.getViewPortControl=function(v,c){return this.getPages().reduce(function(o,p){return(v==="centerViewPort"&&p&&p.getId()===c)?p:o;},null);};var n=function(){};A.prototype.switchState=n;A.prototype._handleSizeChange=n;A.prototype.shiftCenterTransitionEnabled=n;A.prototype.shiftCenterTransition=n;A.prototype.addLeftViewPort=n;A.prototype.addRightViewPort=n;A.prototype.attachAfterSwitchState=n;A.prototype.detachAfterSwitchState=n;A.prototype.attachAfterSwitchStateAnimationFinished=n;A.prototype.detachAfterSwitchStateAnimationFinished=n;A.prototype.getCurrentState=function(){return"Center";};return A;});
